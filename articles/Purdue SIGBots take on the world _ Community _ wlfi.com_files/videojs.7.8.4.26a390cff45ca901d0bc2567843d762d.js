/**
 * @license
 * Video.js 7.8.4 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/master/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
 */(function(S,N){typeof exports=="object"&&typeof module<"u"?module.exports=N(require("global/window"),require("global/document")):typeof define=="function"&&define.amd?define(["global/window","global/document"],N):(S=S||self,S.videojs=N(S.window,S.document))})(this,function(S,N){"use strict";S=S&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S,N=N&&Object.prototype.hasOwnProperty.call(N,"default")?N.default:N;var Js="7.8.4",Me=[],_f=function(r,i){return function(e,t,n){var s=i.levels[t],o=new RegExp("^("+s+")$");if(e!=="log"&&n.unshift(e.toUpperCase()+":"),n.unshift(r+":"),Me){Me.push([].concat(n));var u=Me.length-1e3;Me.splice(0,u>0?u:0)}if(S.console){var l=S.console[e];!l&&e==="debug"&&(l=S.console.info||S.console.log),!(!l||!s||!o.test(e))&&l[Array.isArray(n)?"apply":"call"](S.console,n)}}};function Zs(a){var r="info",i,e=function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];i("log",r,s)};return i=_f(a,e),e.createLogger=function(t){return Zs(a+": "+t)},e.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:r},e.level=function(t){if(typeof t=="string"){if(!e.levels.hasOwnProperty(t))throw new Error('"'+t+'" in not a valid log level');r=t}return r},e.history=function(){return Me?[].concat(Me):[]},e.history.filter=function(t){return(Me||[]).filter(function(n){return new RegExp(".*"+t+".*").test(n[0])})},e.history.clear=function(){Me&&(Me.length=0)},e.history.disable=function(){Me!==null&&(Me.length=0,Me=null)},e.history.enable=function(){Me===null&&(Me=[])},e.error=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return i("error",r,n)},e.warn=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return i("warn",r,n)},e.debug=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return i("debug",r,n)},e}var re=Zs("VIDEOJS"),eo=re.createLogger;function pt(a,r){return r={exports:{}},a(r,r.exports),r.exports}var Ci=pt(function(a){function r(){return a.exports=r=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},r.apply(this,arguments)}a.exports=r}),yf=Object.prototype.toString,to=function(r){return kt(r)?Object.keys(r):[]};function rr(a,r){to(a).forEach(function(i){return r(a[i],i)})}function Tf(a,r,i){return i===void 0&&(i=0),to(a).reduce(function(e,t){return r(e,a[t],t)},i)}function he(a){for(var r=arguments.length,i=new Array(r>1?r-1:0),e=1;e<r;e++)i[e-1]=arguments[e];return Object.assign?Ci.apply(void 0,[a].concat(i)):(i.forEach(function(t){t&&rr(t,function(n,s){a[s]=n})}),a)}function kt(a){return!!a&&typeof a=="object"}function Vr(a){return kt(a)&&yf.call(a)==="[object Object]"&&a.constructor===Object}function ki(a,r){if(!a||!r)return"";if(typeof S.getComputedStyle=="function"){var i=S.getComputedStyle(a);return i?i.getPropertyValue(r)||i[r]:""}return""}function ro(a){return typeof a=="string"&&!!a.trim()}function io(a){if(a.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function bf(a){return new RegExp("(^|\\s)"+a+"($|\\s)")}function ir(){return N===S.document}function nr(a){return kt(a)&&a.nodeType===1}function no(){try{return S.parent!==S.self}catch{return!0}}function ao(a){return function(r,i){if(!ro(r))return N[a](null);ro(i)&&(i=N.querySelector(i));var e=nr(i)?i:N;return e[a]&&e[a](r)}}function de(a,r,i,e){a===void 0&&(a="div"),r===void 0&&(r={}),i===void 0&&(i={});var t=N.createElement(a);return Object.getOwnPropertyNames(r).forEach(function(n){var s=r[n];n.indexOf("aria-")!==-1||n==="role"||n==="type"?(re.warn(`Setting attributes in the second argument of createEl()
has been deprecated. Use the third argument instead.
`+("createEl(type, properties, attributes). Attempting to set "+n+" to "+s+".")),t.setAttribute(n,s)):n==="textContent"?ar(t,s):t[n]!==s&&(t[n]=s)}),Object.getOwnPropertyNames(i).forEach(function(n){t.setAttribute(n,i[n])}),e&&Fn(t,e),t}function ar(a,r){return typeof a.textContent>"u"?a.innerText=r:a.textContent=r,a}function Nn(a,r){r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a)}function Mt(a,r){return io(r),a.classList?a.classList.contains(r):bf(r).test(a.className)}function mt(a,r){return a.classList?a.classList.add(r):Mt(a,r)||(a.className=(a.className+" "+r).trim()),a}function Hr(a,r){return a.classList?a.classList.remove(r):(io(r),a.className=a.className.split(/\s+/).filter(function(i){return i!==r}).join(" ")),a}function so(a,r,i){var e=Mt(a,r);if(typeof i=="function"&&(i=i(a,r)),typeof i!="boolean"&&(i=!e),i!==e)return i?mt(a,r):Hr(a,r),a}function oo(a,r){Object.getOwnPropertyNames(r).forEach(function(i){var e=r[i];e===null||typeof e>"u"||e===!1?a.removeAttribute(i):a.setAttribute(i,e===!0?"":e)})}function vt(a){var r={},i=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(a&&a.attributes&&a.attributes.length>0)for(var e=a.attributes,t=e.length-1;t>=0;t--){var n=e[t].name,s=e[t].value;(typeof a[n]=="boolean"||i.indexOf(","+n+",")!==-1)&&(s=s!==null),r[n]=s}return r}function uo(a,r){return a.getAttribute(r)}function Wr(a,r,i){a.setAttribute(r,i)}function Ai(a,r){a.removeAttribute(r)}function lo(){N.body.focus(),N.onselectstart=function(){return!1}}function co(){N.onselectstart=function(){return!0}}function Gr(a){if(a&&a.getBoundingClientRect&&a.parentNode){var r=a.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(e){r[e]!==void 0&&(i[e]=r[e])}),i.height||(i.height=parseFloat(ki(a,"height"))),i.width||(i.width=parseFloat(ki(a,"width"))),i}}function fo(a){var r;if(a.getBoundingClientRect&&a.parentNode&&(r=a.getBoundingClientRect()),!r)return{left:0,top:0};var i=N.documentElement,e=N.body,t=i.clientLeft||e.clientLeft||0,n=S.pageXOffset||e.scrollLeft,s=r.left+n-t,o=i.clientTop||e.clientTop||0,u=S.pageYOffset||e.scrollTop,l=r.top+u-o;return{left:Math.round(s),top:Math.round(l)}}function Mn(a,r){var i={},e=fo(a),t=a.offsetWidth,n=a.offsetHeight,s=e.top,o=e.left,u=r.pageY,l=r.pageX;return r.changedTouches&&(l=r.changedTouches[0].pageX,u=r.changedTouches[0].pageY),i.y=Math.max(0,Math.min(1,(s-u+n)/n)),i.x=Math.max(0,Math.min(1,(l-o)/t)),i}function ho(a){return kt(a)&&a.nodeType===3}function Un(a){for(;a.firstChild;)a.removeChild(a.firstChild);return a}function po(a){return typeof a=="function"&&(a=a()),(Array.isArray(a)?a:[a]).map(function(r){if(typeof r=="function"&&(r=r()),nr(r)||ho(r))return r;if(typeof r=="string"&&/\S/.test(r))return N.createTextNode(r)}).filter(function(r){return r})}function Fn(a,r){return po(r).forEach(function(i){return a.appendChild(i)}),a}function mo(a,r){return Fn(Un(a),r)}function sr(a){return a.button===void 0&&a.buttons===void 0||a.button===0&&a.buttons===void 0||a.type==="mouseup"&&a.button===0&&a.buttons===0?!0:!(a.button!==0||a.buttons!==1)}var At=ao("querySelector"),vo=ao("querySelectorAll"),go=Object.freeze({__proto__:null,isReal:ir,isEl:nr,isInFrame:no,createEl:de,textContent:ar,prependTo:Nn,hasClass:Mt,addClass:mt,removeClass:Hr,toggleClass:so,setAttributes:oo,getAttributes:vt,getAttribute:uo,setAttribute:Wr,removeAttribute:Ai,blockTextSelection:lo,unblockTextSelection:co,getBoundingClientRect:Gr,findPosition:fo,getPointerPosition:Mn,isTextNode:ho,emptyEl:Un,normalizeContent:po,appendContent:Fn,insertContent:mo,isSingleLeftClick:sr,$:At,$$:vo}),_o=!1,Bn,xf=function(){if(!(!ir()||Bn.options.autoSetup===!1)){var r=Array.prototype.slice.call(N.getElementsByTagName("video")),i=Array.prototype.slice.call(N.getElementsByTagName("audio")),e=Array.prototype.slice.call(N.getElementsByTagName("video-js")),t=r.concat(i,e);if(t&&t.length>0)for(var n=0,s=t.length;n<s;n++){var o=t[n];if(o&&o.getAttribute){if(o.player===void 0){var u=o.getAttribute("data-setup");u!==null&&Bn(o)}}else{jn(1);break}}else _o||jn(1)}};function jn(a,r){r&&(Bn=r),S.setTimeout(xf,a)}function Vn(){_o=!0,S.removeEventListener("load",Vn)}ir()&&(N.readyState==="complete"?Vn():S.addEventListener("load",Vn));var yo=function(r){var i=N.createElement("style");return i.className=r,i},To=function(r,i){r.styleSheet?r.styleSheet.cssText=i:r.textContent=i},Sf=3,Ef=Sf;function Pt(){return Ef++}var bo;S.WeakMap||(bo=function(){function a(){this.vdata="vdata"+Math.floor(S.performance&&S.performance.now()||Date.now()),this.data={}}var r=a.prototype;return r.set=function(e,t){var n=e[this.vdata]||Pt();return e[this.vdata]||(e[this.vdata]=n),this.data[n]=t,this},r.get=function(e){var t=e[this.vdata];if(t)return this.data[t];re("We have no data for this element",e)},r.has=function(e){var t=e[this.vdata];return t in this.data},r.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},a}());var Pe=S.WeakMap?new WeakMap:new bo;function xo(a,r){if(Pe.has(a)){var i=Pe.get(a);i.handlers[r].length===0&&(delete i.handlers[r],a.removeEventListener?a.removeEventListener(r,i.dispatcher,!1):a.detachEvent&&a.detachEvent("on"+r,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),Object.getOwnPropertyNames(i).length===0&&Pe.delete(a)}}function Hn(a,r,i,e){i.forEach(function(t){a(r,t,e)})}function Pi(a){if(a.fixed_)return a;function r(){return!0}function i(){return!1}if(!a||!a.isPropagationStopped){var e=a||S.event;a={};for(var t in e)t!=="layerX"&&t!=="layerY"&&t!=="keyLocation"&&t!=="webkitMovementX"&&t!=="webkitMovementY"&&(t==="returnValue"&&e.preventDefault||(a[t]=e[t]));if(a.target||(a.target=a.srcElement||N),a.relatedTarget||(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement),a.preventDefault=function(){e.preventDefault&&e.preventDefault(),a.returnValue=!1,e.returnValue=!1,a.defaultPrevented=!0},a.defaultPrevented=!1,a.stopPropagation=function(){e.stopPropagation&&e.stopPropagation(),a.cancelBubble=!0,e.cancelBubble=!0,a.isPropagationStopped=r},a.isPropagationStopped=i,a.stopImmediatePropagation=function(){e.stopImmediatePropagation&&e.stopImmediatePropagation(),a.isImmediatePropagationStopped=r,a.stopPropagation()},a.isImmediatePropagationStopped=i,a.clientX!==null&&a.clientX!==void 0){var n=N.documentElement,s=N.body;a.pageX=a.clientX+(n&&n.scrollLeft||s&&s.scrollLeft||0)-(n&&n.clientLeft||s&&s.clientLeft||0),a.pageY=a.clientY+(n&&n.scrollTop||s&&s.scrollTop||0)-(n&&n.clientTop||s&&s.clientTop||0)}a.which=a.charCode||a.keyCode,a.button!==null&&a.button!==void 0&&(a.button=a.button&1?0:a.button&4?1:a.button&2?2:0)}return a.fixed_=!0,a}var Ii,Cf=function(){if(typeof Ii!="boolean"){Ii=!1;try{var r=Object.defineProperty({},"passive",{get:function(){Ii=!0}});S.addEventListener("test",null,r),S.removeEventListener("test",null,r)}catch{}}return Ii},kf=["touchstart","touchmove"];function He(a,r,i){if(Array.isArray(r))return Hn(He,a,r,i);Pe.has(a)||Pe.set(a,{});var e=Pe.get(a);if(e.handlers||(e.handlers={}),e.handlers[r]||(e.handlers[r]=[]),i.guid||(i.guid=Pt()),e.handlers[r].push(i),e.dispatcher||(e.disabled=!1,e.dispatcher=function(n,s){if(!e.disabled){n=Pi(n);var o=e.handlers[n.type];if(o)for(var u=o.slice(0),l=0,c=u.length;l<c&&!n.isImmediatePropagationStopped();l++)try{u[l].call(a,n,s)}catch(f){re.error(f)}}}),e.handlers[r].length===1)if(a.addEventListener){var t=!1;Cf()&&kf.indexOf(r)>-1&&(t={passive:!0}),a.addEventListener(r,e.dispatcher,t)}else a.attachEvent&&a.attachEvent("on"+r,e.dispatcher)}function Ce(a,r,i){if(Pe.has(a)){var e=Pe.get(a);if(e.handlers){if(Array.isArray(r))return Hn(Ce,a,r,i);var t=function(l,c){e.handlers[c]=[],xo(l,c)};if(r===void 0){for(var n in e.handlers)Object.prototype.hasOwnProperty.call(e.handlers||{},n)&&t(a,n);return}var s=e.handlers[r];if(s){if(!i){t(a,r);return}if(i.guid)for(var o=0;o<s.length;o++)s[o].guid===i.guid&&s.splice(o--,1);xo(a,r)}}}}function or(a,r,i){var e=Pe.has(a)?Pe.get(a):{},t=a.parentNode||a.ownerDocument;if(typeof r=="string"?r={type:r,target:a}:r.target||(r.target=a),r=Pi(r),e.dispatcher&&e.dispatcher.call(a,r,i),t&&!r.isPropagationStopped()&&r.bubbles===!0)or.call(null,t,r,i);else if(!t&&!r.defaultPrevented&&r.target&&r.target[r.type]){Pe.has(r.target)||Pe.set(r.target,{});var n=Pe.get(r.target);r.target[r.type]&&(n.disabled=!0,typeof r.target[r.type]=="function"&&r.target[r.type](),n.disabled=!1)}return!r.defaultPrevented}function Di(a,r,i){if(Array.isArray(r))return Hn(Di,a,r,i);var e=function t(){Ce(a,r,t),i.apply(this,arguments)};e.guid=i.guid=i.guid||Pt(),He(a,r,e)}function So(a,r,i){var e=function t(){Ce(a,r,t),i.apply(this,arguments)};e.guid=i.guid=i.guid||Pt(),He(a,r,e)}var Af=Object.freeze({__proto__:null,fixEvent:Pi,on:He,off:Ce,trigger:or,one:Di,any:So}),gt=30,te=function(r,i,e){i.guid||(i.guid=Pt());var t=i.bind(r);return t.guid=e?e+"_"+i.guid:i.guid,t},Ut=function(r,i){var e=S.performance.now(),t=function(){var s=S.performance.now();s-e>=i&&(r.apply(void 0,arguments),e=s)};return t},Pf=function(r,i,e,t){t===void 0&&(t=S);var n,s=function(){t.clearTimeout(n),n=null},o=function(){var l=this,c=arguments,f=function(){n=null,f=null,e||r.apply(l,c)};!n&&e&&r.apply(l,c),t.clearTimeout(n),n=t.setTimeout(f,i)};return o.cancel=s,o},be=function(){};be.prototype.allowedEvents_={},be.prototype.on=function(a,r){var i=this.addEventListener;this.addEventListener=function(){},He(this,a,r),this.addEventListener=i},be.prototype.addEventListener=be.prototype.on,be.prototype.off=function(a,r){Ce(this,a,r)},be.prototype.removeEventListener=be.prototype.off,be.prototype.one=function(a,r){var i=this.addEventListener;this.addEventListener=function(){},Di(this,a,r),this.addEventListener=i},be.prototype.any=function(a,r){var i=this.addEventListener;this.addEventListener=function(){},So(this,a,r),this.addEventListener=i},be.prototype.trigger=function(a){var r=a.type||a;typeof a=="string"&&(a={type:r}),a=Pi(a),this.allowedEvents_[r]&&this["on"+r]&&this["on"+r](a),or(this,a)},be.prototype.dispatchEvent=be.prototype.trigger;var qr;be.prototype.queueTrigger=function(a){var r=this;qr||(qr=new Map);var i=a.type||a,e=qr.get(this);e||(e=new Map,qr.set(this,e));var t=e.get(i);e.delete(i),S.clearTimeout(t);var n=S.setTimeout(function(){e.size===0&&(e=null,qr.delete(r)),r.trigger(a)},0);e.set(i,n)};var Ft=function(r){return r instanceof be||!!r.eventBusEl_&&["on","one","off","trigger"].every(function(i){return typeof r[i]=="function"})},If=function(r,i){Ft(r)?i():(r.eventedCallbacks||(r.eventedCallbacks=[]),r.eventedCallbacks.push(i))},Eo=function(r){return typeof r=="string"&&/\S/.test(r)||Array.isArray(r)&&!!r.length},Wn=function(r){if(!r.nodeName&&!Ft(r))throw new Error("Invalid target; must be a DOM node or evented object.")},Co=function(r){if(!Eo(r))throw new Error("Invalid event type; must be a non-empty string or array.")},ko=function(r){if(typeof r!="function")throw new Error("Invalid listener; must be a function.")},Gn=function(r,i){var e=i.length<3||i[0]===r||i[0]===r.eventBusEl_,t,n,s;return e?(t=r.eventBusEl_,i.length>=3&&i.shift(),n=i[0],s=i[1]):(t=i[0],n=i[1],s=i[2]),Wn(t),Co(n),ko(s),s=te(r,s),{isTargetingSelf:e,target:t,type:n,listener:s}},Bt=function(r,i,e,t){Wn(r),r.nodeName?Af[i](r,e,t):r[i](e,t)},Df={on:function(){for(var r=this,i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];var n=Gn(this,e),s=n.isTargetingSelf,o=n.target,u=n.type,l=n.listener;if(Bt(o,"on",u,l),!s){var c=function(){return r.off(o,u,l)};c.guid=l.guid;var f=function(){return r.off("dispose",c)};f.guid=l.guid,Bt(this,"on","dispose",c),Bt(o,"on","dispose",f)}},one:function(){for(var r=this,i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];var n=Gn(this,e),s=n.isTargetingSelf,o=n.target,u=n.type,l=n.listener;if(s)Bt(o,"one",u,l);else{var c=function f(){r.off(o,u,f);for(var d=arguments.length,m=new Array(d),_=0;_<d;_++)m[_]=arguments[_];l.apply(null,m)};c.guid=l.guid,Bt(o,"one",u,c)}},any:function(){for(var r=this,i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];var n=Gn(this,e),s=n.isTargetingSelf,o=n.target,u=n.type,l=n.listener;if(s)Bt(o,"any",u,l);else{var c=function f(){r.off(o,u,f);for(var d=arguments.length,m=new Array(d),_=0;_<d;_++)m[_]=arguments[_];l.apply(null,m)};c.guid=l.guid,Bt(o,"any",u,c)}},off:function(r,i,e){if(!r||Eo(r))Ce(this.eventBusEl_,r,i);else{var t=r,n=i;Wn(t),Co(n),ko(e),e=te(this,e),this.off("dispose",e),t.nodeName?(Ce(t,n,e),Ce(t,"dispose",e)):Ft(t)&&(t.off(n,e),t.off("dispose",e))}},trigger:function(r,i){return or(this.eventBusEl_,r,i)}};function qn(a,r){r===void 0&&(r={});var i=r,e=i.eventBusKey;if(e){if(!a[e].nodeName)throw new Error('The eventBusKey "'+e+'" does not refer to an element.');a.eventBusEl_=a[e]}else a.eventBusEl_=de("span",{className:"vjs-event-bus"});return he(a,Df),a.eventedCallbacks&&a.eventedCallbacks.forEach(function(t){t()}),a.on("dispose",function(){a.off(),S.setTimeout(function(){a.eventBusEl_=null},0)}),a}var wf={state:{},setState:function(r){var i=this;typeof r=="function"&&(r=r());var e;return rr(r,function(t,n){i.state[n]!==t&&(e=e||{},e[n]={from:i.state[n],to:t}),i.state[n]=t}),e&&Ft(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function Ao(a,r){return he(a,wf),a.state=he({},a.state,r),typeof a.handleStateChanged=="function"&&Ft(a)&&a.on("statechanged",a.handleStateChanged),a}var wi=function(r){return typeof r!="string"?r:r.replace(/./,function(i){return i.toLowerCase()})},ge=function(r){return typeof r!="string"?r:r.replace(/./,function(i){return i.toUpperCase()})},Of=function(r,i){return ge(r)===ge(i)};function fe(){for(var a={},r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return i.forEach(function(t){t&&rr(t,function(n,s){if(!Vr(n)){a[s]=n;return}Vr(a[s])||(a[s]={}),a[s]=fe(a[s],n)})}),a}var L=function(){function a(i,e,t){if(!i&&this.play?this.player_=i=this:this.player_=i,this.isDisposed_=!1,this.parentComponent_=null,this.options_=fe({},this.options_),e=this.options_=fe(this.options_,e),this.id_=e.id||e.el&&e.el.id,!this.id_){var n=i&&i.id&&i.id()||"no_player";this.id_=n+"_component_"+Pt()}this.name_=e.name||null,e.el?this.el_=e.el:e.createEl!==!1&&(this.el_=this.createEl()),e.evented!==!1&&qn(this,{eventBusKey:this.el_?"el_":null}),Ao(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={};var s;S.Set||(s=function(){function o(){this.set_={}}var u=o.prototype;return u.has=function(c){return c in this.set_},u.delete=function(c){var f=this.has(c);return delete this.set_[c],f},u.add=function(c){return this.set_[c]=1,this},u.forEach=function(c,f){for(var d in this.set_)c.call(f,d,d,this)},o}()),this.setTimeoutIds_=S.Set?new Set:new s,this.setIntervalIds_=S.Set?new Set:new s,this.rafIds_=S.Set?new Set:new s,this.clearingTimersOnDispose_=!1,e.initChildren!==!1&&this.initChildren(),this.ready(t),e.reportTouchActivity!==!1&&this.enableTouchActivity()}var r=a.prototype;return r.dispose=function(){if(!this.isDisposed_){if(this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),Pe.has(this.el_)&&Pe.delete(this.el_),this.el_=null),this.player_=null}},r.isDisposed=function(){return!!this.isDisposed_},r.player=function(){return this.player_},r.options=function(e){return e?(this.options_=fe(this.options_,e),this.options_):this.options_},r.el=function(){return this.el_},r.createEl=function(e,t,n){return de(e,t,n)},r.localize=function(e,t,n){n===void 0&&(n=e);var s=this.player_.language&&this.player_.language(),o=this.player_.languages&&this.player_.languages(),u=o&&o[s],l=s&&s.split("-")[0],c=o&&o[l],f=n;return u&&u[e]?f=u[e]:c&&c[e]&&(f=c[e]),t&&(f=f.replace(/\{(\d+)\}/g,function(d,m){var _=t[m-1],b=_;return typeof _>"u"&&(b=d),b})),f},r.contentEl=function(){return this.contentEl_||this.el_},r.id=function(){return this.id_},r.name=function(){return this.name_},r.children=function(){return this.children_},r.getChildById=function(e){return this.childIndex_[e]},r.getChild=function(e){if(e)return this.childNameIndex_[e]},r.getDescendant=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.reduce(function(u,l){return u.concat(l)},[]);for(var s=this,o=0;o<t.length;o++)if(s=s.getChild(t[o]),!s||!s.getChild)return;return s},r.addChild=function(e,t,n){t===void 0&&(t={}),n===void 0&&(n=this.children_.length);var s,o;if(typeof e=="string"){o=ge(e);var u=t.componentClass||o;t.name=o;var l=a.getComponent(u);if(!l)throw new Error("Component "+u+" does not exist");if(typeof l!="function")return null;s=new l(this.player_||this,t)}else s=e;if(s.parentComponent_&&s.parentComponent_.removeChild(s),this.children_.splice(n,0,s),s.parentComponent_=this,typeof s.id=="function"&&(this.childIndex_[s.id()]=s),o=o||s.name&&ge(s.name()),o&&(this.childNameIndex_[o]=s,this.childNameIndex_[wi(o)]=s),typeof s.el=="function"&&s.el()){var c=null;this.children_[n+1]&&(this.children_[n+1].el_?c=this.children_[n+1].el_:nr(this.children_[n+1])&&(c=this.children_[n+1])),this.contentEl().insertBefore(s.el(),c)}return s},r.removeChild=function(e){if(typeof e=="string"&&(e=this.getChild(e)),!(!e||!this.children_)){for(var t=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[ge(e.name())]=null,this.childNameIndex_[wi(e.name())]=null;var s=e.el();s&&s.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},r.initChildren=function(){var e=this,t=this.options_.children;if(t){var n=this.options_,s=function(c){var f=c.name,d=c.opts;if(n[f]!==void 0&&(d=n[f]),d!==!1){d===!0&&(d={}),d.playerOptions=e.options_.playerOptions;var m=e.addChild(f,d);m&&(e[f]=m)}},o,u=a.getComponent("Tech");Array.isArray(t)?o=t:o=Object.keys(t),o.concat(Object.keys(this.options_).filter(function(l){return!o.some(function(c){return typeof c=="string"?l===c:l===c.name})})).map(function(l){var c,f;return typeof l=="string"?(c=l,f=t[c]||e.options_[c]||{}):(c=l.name,f=l),{name:c,opts:f}}).filter(function(l){var c=a.getComponent(l.opts.componentClass||ge(l.name));return c&&!u.isTech(c)}).forEach(s)}},r.buildCSSClass=function(){return""},r.ready=function(e,t){if(t===void 0&&(t=!1),!!e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}t?e.call(this):this.setTimeout(e,1)}},r.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)},r.$=function(e,t){return At(e,t||this.contentEl())},r.$$=function(e,t){return vo(e,t||this.contentEl())},r.hasClass=function(e){return Mt(this.el_,e)},r.addClass=function(e){mt(this.el_,e)},r.removeClass=function(e){Hr(this.el_,e)},r.toggleClass=function(e,t){so(this.el_,e,t)},r.show=function(){this.removeClass("vjs-hidden")},r.hide=function(){this.addClass("vjs-hidden")},r.lockShowing=function(){this.addClass("vjs-lock-showing")},r.unlockShowing=function(){this.removeClass("vjs-lock-showing")},r.getAttribute=function(e){return uo(this.el_,e)},r.setAttribute=function(e,t){Wr(this.el_,e,t)},r.removeAttribute=function(e){Ai(this.el_,e)},r.width=function(e,t){return this.dimension("width",e,t)},r.height=function(e,t){return this.dimension("height",e,t)},r.dimensions=function(e,t){this.width(e,!0),this.height(t)},r.dimension=function(e,t,n){if(t!==void 0){(t===null||t!==t)&&(t=0),(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?this.el_.style[e]=t:t==="auto"?this.el_.style[e]="":this.el_.style[e]=t+"px",n||this.trigger("componentresize");return}if(!this.el_)return 0;var s=this.el_.style[e],o=s.indexOf("px");return parseInt(o!==-1?s.slice(0,o):this.el_["offset"+ge(e)],10)},r.currentDimension=function(e){var t=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(t=ki(this.el_,e),t=parseFloat(t),t===0||isNaN(t)){var n="offset"+ge(e);t=this.el_[n]}return t},r.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},r.currentWidth=function(){return this.currentDimension("width")},r.currentHeight=function(){return this.currentDimension("height")},r.focus=function(){this.el_.focus()},r.blur=function(){this.el_.blur()},r.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},r.handleKeyPress=function(e){this.handleKeyDown(e)},r.emitTapEvents=function(){var e=0,t=null,n=10,s=200,o;this.on("touchstart",function(l){l.touches.length===1&&(t={pageX:l.touches[0].pageX,pageY:l.touches[0].pageY},e=S.performance.now(),o=!0)}),this.on("touchmove",function(l){if(l.touches.length>1)o=!1;else if(t){var c=l.touches[0].pageX-t.pageX,f=l.touches[0].pageY-t.pageY,d=Math.sqrt(c*c+f*f);d>n&&(o=!1)}});var u=function(){o=!1};this.on("touchleave",u),this.on("touchcancel",u),this.on("touchend",function(l){if(t=null,o===!0){var c=S.performance.now()-e;c<s&&(l.preventDefault(),this.trigger("tap"))}})},r.enableTouchActivity=function(){if(!(!this.player()||!this.player().reportUserActivity)){var e=te(this.player(),this.player().reportUserActivity),t;this.on("touchstart",function(){e(),this.clearInterval(t),t=this.setInterval(e,250)});var n=function(o){e(),this.clearInterval(t)};this.on("touchmove",e),this.on("touchend",n),this.on("touchcancel",n)}},r.setTimeout=function(e,t){var n=this,s;return e=te(this,e),this.clearTimersOnDispose_(),s=S.setTimeout(function(){n.setTimeoutIds_.has(s)&&n.setTimeoutIds_.delete(s),e()},t),this.setTimeoutIds_.add(s),s},r.clearTimeout=function(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),S.clearTimeout(e)),e},r.setInterval=function(e,t){e=te(this,e),this.clearTimersOnDispose_();var n=S.setInterval(e,t);return this.setIntervalIds_.add(n),n},r.clearInterval=function(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),S.clearInterval(e)),e},r.requestAnimationFrame=function(e){var t=this;if(!this.supportsRaf_)return this.setTimeout(e,1e3/60);this.clearTimersOnDispose_();var n;return e=te(this,e),n=S.requestAnimationFrame(function(){t.rafIds_.has(n)&&t.rafIds_.delete(n),e()}),this.rafIds_.add(n),n},r.cancelAnimationFrame=function(e){return this.supportsRaf_?(this.rafIds_.has(e)&&(this.rafIds_.delete(e),S.cancelAnimationFrame(e)),e):this.clearTimeout(e)},r.clearTimersOnDispose_=function(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(t){var n=t[0],s=t[1];e[n].forEach(e[s],e)}),e.clearingTimersOnDispose_=!1}))},a.registerComponent=function(e,t){if(typeof e!="string"||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var n=a.getComponent("Tech"),s=n&&n.isTech(t),o=a===t||a.prototype.isPrototypeOf(t.prototype);if(s||!o){var u;throw s?u="techs must be registered using Tech.registerTech()":u="must be a Component subclass",new Error('Illegal component, "'+e+'"; '+u+".")}e=ge(e),a.components_||(a.components_={});var l=a.getComponent("Player");if(e==="Player"&&l&&l.players){var c=l.players,f=Object.keys(c);if(c&&f.length>0&&f.map(function(d){return c[d]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return a.components_[e]=t,a.components_[wi(e)]=t,t},a.getComponent=function(e){if(!(!e||!a.components_))return a.components_[e]},a}();L.prototype.supportsRaf_=typeof S.requestAnimationFrame=="function"&&typeof S.cancelAnimationFrame=="function",L.registerComponent("Component",L);function Lf(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}var J=Lf,R0=pt(function(a){function r(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a.exports=r=function(t){return typeof t}:a.exports=r=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(i)}a.exports=r}),N0=pt(function(a){function r(i){return a.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(i)}a.exports=r});function Rf(a,r){a.prototype=Object.create(r.prototype),a.prototype.constructor=a,a.__proto__=r}var H=Rf,xe=S.navigator&&S.navigator.userAgent||"",Po=/AppleWebKit\/([\d.]+)/i.exec(xe),Nf=Po?parseFloat(Po.pop()):null,Io=/iPod/i.test(xe),Mf=function(){var a=xe.match(/OS (\d+)_/i);return a&&a[1]?a[1]:null}(),It=/Android/i.test(xe),zn=function(){var a=xe.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!a)return null;var r=a[1]&&parseFloat(a[1]),i=a[2]&&parseFloat(a[2]);return r&&i?parseFloat(a[1]+"."+a[2]):r||null}(),Do=It&&zn<5&&Nf<537,wo=/Firefox/i.test(xe),zr=/Edg/i.test(xe),_t=!zr&&(/Chrome/i.test(xe)||/CriOS/i.test(xe)),Oo=function(){var a=xe.match(/(Chrome|CriOS)\/(\d+)/);return a&&a[2]?parseFloat(a[2]):null}(),Kr=function(){var a=/MSIE\s(\d+)\.\d/.exec(xe),r=a&&parseFloat(a[1]);return!r&&/Trident\/7.0/i.test(xe)&&/rv:11.0/.test(xe)&&(r=11),r}(),Kn=/Safari/i.test(xe)&&!_t&&!It&&!zr,Lo=/Windows/i.test(xe),ur=ir()&&("ontouchstart"in S||S.navigator.maxTouchPoints||S.DocumentTouch&&S.document instanceof S.DocumentTouch),Xn=/iPad/i.test(xe)||Kn&&ur&&!/iPhone/i.test(xe),$n=/iPhone/i.test(xe)&&!Xn,tt=$n||Xn||Io,Yn=(Kn||tt)&&!_t,Uf=Object.freeze({__proto__:null,IS_IPOD:Io,IOS_VERSION:Mf,IS_ANDROID:It,ANDROID_VERSION:zn,IS_NATIVE_ANDROID:Do,IS_FIREFOX:wo,IS_EDGE:zr,IS_CHROME:_t,CHROME_VERSION:Oo,IE_VERSION:Kr,IS_SAFARI:Kn,IS_WINDOWS:Lo,TOUCH_ENABLED:ur,IS_IPAD:Xn,IS_IPHONE:$n,IS_IOS:tt,IS_ANY_SAFARI:Yn});function Ff(a,r,i){if(typeof r!="number"||r<0||r>i)throw new Error("Failed to execute '"+a+"' on 'TimeRanges': The index provided ("+r+") is non-numeric or out of bounds (0-"+i+").")}function Ro(a,r,i,e){return Ff(a,e,i.length-1),i[e][r]}function Qn(a){return a===void 0||a.length===0?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:a.length,start:Ro.bind(null,"start",0,a),end:Ro.bind(null,"end",1,a)}}function jt(a,r){return Array.isArray(a)?Qn(a):a===void 0||r===void 0?Qn():Qn([[a,r]])}function No(a,r){var i=0,e,t;if(!r)return 0;(!a||!a.length)&&(a=jt(0,0));for(var n=0;n<a.length;n++)e=a.start(n),t=a.end(n),t>r&&(t=r),i+=t-e;return i/r}for(var Jn={prefixed:!0},Oi=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Mo=Oi[0],Xr,Li=0;Li<Oi.length;Li++)if(Oi[Li][1]in N){Xr=Oi[Li];break}if(Xr){for(var Ri=0;Ri<Xr.length;Ri++)Jn[Mo[Ri]]=Xr[Ri];Jn.prefixed=Xr[0]!==Mo[0]}function Ie(a){if(a instanceof Ie)return a;typeof a=="number"?this.code=a:typeof a=="string"?this.message=a:kt(a)&&(typeof a.code=="number"&&(this.code=a.code),he(this,a)),this.message||(this.message=Ie.defaultMessages[this.code]||"")}Ie.prototype.code=0,Ie.prototype.message="",Ie.prototype.status=null,Ie.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Ie.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var lr=0;lr<Ie.errorTypes.length;lr++)Ie[Ie.errorTypes[lr]]=lr,Ie.prototype[Ie.errorTypes[lr]]=lr;var Bf=jf;function jf(a,r){var i,e=null;try{i=JSON.parse(a,r)}catch(t){e=t}return[e,i]}function $r(a){return a!=null&&typeof a.then=="function"}function Vt(a){$r(a)&&a.then(null,function(r){})}var Zn=function(r){var i=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,t,n){return r[t]&&(e[t]=r[t]),e},{cues:r.cues&&Array.prototype.map.call(r.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})});return i},Vf=function(r){var i=r.$$("track"),e=Array.prototype.map.call(i,function(n){return n.track}),t=Array.prototype.map.call(i,function(n){var s=Zn(n.track);return n.src&&(s.src=n.src),s});return t.concat(Array.prototype.filter.call(r.textTracks(),function(n){return e.indexOf(n)===-1}).map(Zn))},Hf=function(r,i){return r.forEach(function(e){var t=i.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(n){return t.addCue(n)})}),i.textTracks()},Uo={textTracksToJson:Vf,jsonToTextTracks:Hf,trackToJson_:Zn},Y=pt(function(a,r){function i(u){if(u&&typeof u=="object"){var l=u.which||u.keyCode||u.charCode;l&&(u=l)}if(typeof u=="number")return s[u];var c=String(u),f=e[c.toLowerCase()];if(f)return f;var f=t[c.toLowerCase()];if(f)return f;if(c.length===1)return c.charCodeAt(0)}i.isEventKey=function(l,c){if(l&&typeof l=="object"){var f=l.which||l.keyCode||l.charCode;if(f==null)return!1;if(typeof c=="string"){var d=e[c.toLowerCase()];if(d)return d===f;var d=t[c.toLowerCase()];if(d)return d===f}else if(typeof c=="number")return c===f;return!1}},r=a.exports=i;var e=r.code=r.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},t=r.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(n=97;n<123;n++)e[String.fromCharCode(n)]=n-32;for(var n=48;n<58;n++)e[n-48]=n;for(n=1;n<13;n++)e["f"+n]=n+111;for(n=0;n<10;n++)e["numpad "+n]=n+96;var s=r.names=r.title={};for(n in e)s[e[n]]=n;for(var o in t)e[o]=t[o]}),M0=Y.code,U0=Y.codes,F0=Y.aliases,B0=Y.names,j0=Y.title,ea="vjs-modal-dialog",cr=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.opened_=n.hasBeenOpened_=n.hasBeenFilled_=!1,n.closeable(!n.options_.uncloseable),n.content(n.options_.content),n.contentEl_=de("div",{className:ea+"-content"},{role:"document"}),n.descEl_=de("p",{className:ea+"-description vjs-control-text",id:n.el().getAttribute("aria-describedby")}),ar(n.descEl_,n.description()),n.el_.appendChild(n.descEl_),n.el_.appendChild(n.contentEl_),n}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},i.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,a.prototype.dispose.call(this)},i.buildCSSClass=function(){return ea+" vjs-hidden "+a.prototype.buildCSSClass.call(this)},i.label=function(){return this.localize(this.options_.label||"Modal Window")},i.description=function(){var t=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),t},i.open=function(){if(!this.opened_){var t=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!t.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&t.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=t.controls(),t.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},i.opened=function(t){return typeof t=="boolean"&&this[t?"open":"close"](),this.opened_},i.close=function(){if(this.opened_){var t=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&t.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&t.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},i.closeable=function(t){if(typeof t=="boolean"){var n=this.closeable_=!!t,s=this.getChild("closeButton");if(n&&!s){var o=this.contentEl_;this.contentEl_=this.el_,s=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=o,this.on(s,"close",this.close)}!n&&s&&(this.off(s,"close",this.close),this.removeChild(s),s.dispose())}return this.closeable_},i.fill=function(){this.fillWith(this.content())},i.fillWith=function(t){var n=this.contentEl(),s=n.parentNode,o=n.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,s.removeChild(n),this.empty(),mo(n,t),this.trigger("modalfill"),o?s.insertBefore(n,o):s.appendChild(n);var u=this.getChild("closeButton");u&&s.appendChild(u.el_)},i.empty=function(){this.trigger("beforemodalempty"),Un(this.contentEl()),this.trigger("modalempty")},i.content=function(t){return typeof t<"u"&&(this.content_=t),this.content_},i.conditionalFocus_=function(){var t=N.activeElement,n=this.player_.el_;this.previouslyActiveEl_=null,(n.contains(t)||n===t)&&(this.previouslyActiveEl_=t,this.focus())},i.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},i.handleKeyDown=function(t){if(t.stopPropagation(),Y.isEventKey(t,"Escape")&&this.closeable()){t.preventDefault(),this.close();return}if(Y.isEventKey(t,"Tab")){for(var n=this.focusableEls_(),s=this.el_.querySelector(":focus"),o,u=0;u<n.length;u++)if(s===n[u]){o=u;break}N.activeElement===this.el_&&(o=0),t.shiftKey&&o===0?(n[n.length-1].focus(),t.preventDefault()):!t.shiftKey&&o===n.length-1&&(n[0].focus(),t.preventDefault())}},i.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(n){return(n instanceof S.HTMLAnchorElement||n instanceof S.HTMLAreaElement)&&n.hasAttribute("href")||(n instanceof S.HTMLInputElement||n instanceof S.HTMLSelectElement||n instanceof S.HTMLTextAreaElement||n instanceof S.HTMLButtonElement)&&!n.hasAttribute("disabled")||n instanceof S.HTMLIFrameElement||n instanceof S.HTMLObjectElement||n instanceof S.HTMLEmbedElement||n.hasAttribute("tabindex")&&n.getAttribute("tabindex")!==-1||n.hasAttribute("contenteditable")})},r}(L);cr.prototype.options_={pauseOnOpen:!0,temporary:!0},L.registerComponent("ModalDialog",cr);var fr=function(a){H(r,a);function r(e){var t;e===void 0&&(e=[]),t=a.call(this)||this,t.tracks_=[],Object.defineProperty(J(t),"length",{get:function(){return this.tracks_.length}});for(var n=0;n<e.length;n++)t.addTrack(e[n]);return t}var i=r.prototype;return i.addTrack=function(t){var n=this.tracks_.length;""+n in this||Object.defineProperty(this,n,{get:function(){return this.tracks_[n]}}),this.tracks_.indexOf(t)===-1&&(this.tracks_.push(t),this.trigger({track:t,type:"addtrack",target:this}))},i.removeTrack=function(t){for(var n,s=0,o=this.length;s<o;s++)if(this[s]===t){n=this[s],n.off&&n.off(),this.tracks_.splice(s,1);break}n&&this.trigger({track:n,type:"removetrack",target:this})},i.getTrackById=function(t){for(var n=null,s=0,o=this.length;s<o;s++){var u=this[s];if(u.id===t){n=u;break}}return n},r}(be);fr.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"};for(var Wf in fr.prototype.allowedEvents_)fr.prototype["on"+Wf]=null;var ta=function(r,i){for(var e=0;e<r.length;e++)!Object.keys(r[e]).length||i.id===r[e].id||(r[e].enabled=!1)},Gf=function(a){H(r,a);function r(e){var t;e===void 0&&(e=[]);for(var n=e.length-1;n>=0;n--)if(e[n].enabled){ta(e,e[n]);break}return t=a.call(this,e)||this,t.changing_=!1,t}var i=r.prototype;return i.addTrack=function(t){var n=this;t.enabled&&ta(this,t),a.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){n.changing_||(n.changing_=!0,ta(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},i.removeTrack=function(t){a.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},r}(fr),ra=function(r,i){for(var e=0;e<r.length;e++)!Object.keys(r[e]).length||i.id===r[e].id||(r[e].selected=!1)},qf=function(a){H(r,a);function r(e){var t;e===void 0&&(e=[]);for(var n=e.length-1;n>=0;n--)if(e[n].selected){ra(e,e[n]);break}return t=a.call(this,e)||this,t.changing_=!1,Object.defineProperty(J(t),"selectedIndex",{get:function(){for(var o=0;o<this.length;o++)if(this[o].selected)return o;return-1},set:function(){}}),t}var i=r.prototype;return i.addTrack=function(t){var n=this;t.selected&&ra(this,t),a.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){n.changing_||(n.changing_=!0,ra(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},i.removeTrack=function(t){a.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},r}(fr),Fo=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.addTrack=function(t){var n=this;a.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_);var s=["metadata","chapters"];s.indexOf(t.kind)===-1&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},i.removeTrack=function(t){a.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},r}(fr),zf=function(){function a(i){i===void 0&&(i=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var e=0,t=i.length;e<t;e++)this.addTrackElement_(i[e])}var r=a.prototype;return r.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)},r.getTrackElementByTrack_=function(e){for(var t,n=0,s=this.trackElements_.length;n<s;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},r.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&typeof this.trackElements_[t].track.off=="function"&&this.trackElements_[t].track.off(),typeof this.trackElements_[t].off=="function"&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},a}(),Bo=function(){function a(i){a.prototype.setCues_.call(this,i),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var r=a.prototype;return r.setCues_=function(e){var t=this.length||0,n=0,s=e.length;this.cues_=e,this.length_=e.length;var o=function(l){""+l in this||Object.defineProperty(this,""+l,{get:function(){return this.cues_[l]}})};if(t<s)for(n=t;n<s;n++)o.call(this,n)},r.getCueById=function(e){for(var t=null,n=0,s=this.length;n<s;n++){var o=this[n];if(o.id===e){t=o;break}}return t},a}(),Kf={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Xf={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},$f={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},jo={disabled:"disabled",hidden:"hidden",showing:"showing"},ia=function(a){H(r,a);function r(i){var e;i===void 0&&(i={}),e=a.call(this)||this;var t={id:i.id||"vjs_track_"+Pt(),kind:i.kind||"",label:i.label||"",language:i.language||""},n=function(u){Object.defineProperty(J(e),u,{get:function(){return t[u]},set:function(){}})};for(var s in t)n(s);return e}return r}(be),na=function(r){var i=["protocol","hostname","port","pathname","search","hash","host"],e=N.createElement("a");e.href=r;var t=e.host===""&&e.protocol!=="file:",n;t&&(n=N.createElement("div"),n.innerHTML='<a href="'+r+'"></a>',e=n.firstChild,n.setAttribute("style","display:none; position:absolute;"),N.body.appendChild(n));for(var s={},o=0;o<i.length;o++)s[i[o]]=e[i[o]];return s.protocol==="http:"&&(s.host=s.host.replace(/:80$/,"")),s.protocol==="https:"&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=S.location.protocol),t&&N.body.removeChild(n),s},Vo=function(r){if(!r.match(/^https?:\/\//)){var i=N.createElement("div");i.innerHTML='<a href="'+r+'">x</a>',r=i.firstChild.href}return r},aa=function(r){if(typeof r=="string"){var i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/,e=i.exec(r);if(e)return e.pop().toLowerCase()}return""},Ni=function(r,i){i===void 0&&(i=S.location);var e=na(r),t=e.protocol===":"?i.protocol:e.protocol,n=t+e.host!==i.protocol+i.host;return n},Yf=Object.freeze({__proto__:null,parseUrl:na,getAbsoluteURL:Vo,getFileExtension:aa,isCrossOrigin:Ni}),Qf=Zf,Jf=Object.prototype.toString;function Zf(a){var r=Jf.call(a);return r==="[object Function]"||typeof a=="function"&&r!=="[object RegExp]"||typeof window<"u"&&(a===window.setTimeout||a===window.alert||a===window.confirm||a===window.prompt)}/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bj√∂rklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var eh=function(r){var i={};return r&&r.trim().split(`
`).forEach(function(e){var t=e.indexOf(":"),n=e.slice(0,t).trim().toLowerCase(),s=e.slice(t+1).trim();typeof i[n]>"u"?i[n]=s:Array.isArray(i[n])?i[n].push(s):i[n]=[i[n],s]}),i},sa=yt,th=yt;yt.XMLHttpRequest=S.XMLHttpRequest||ah,yt.XDomainRequest="withCredentials"in new yt.XMLHttpRequest?yt.XMLHttpRequest:S.XDomainRequest,rh(["get","put","post","patch","head","delete"],function(a){yt[a==="delete"?"del":a]=function(r,i,e){return i=Ho(r,i,e),i.method=a.toUpperCase(),Wo(i)}});function rh(a,r){for(var i=0;i<a.length;i++)r(a[i])}function ih(a){for(var r in a)if(a.hasOwnProperty(r))return!1;return!0}function Ho(a,r,i){var e=a;return Qf(r)?(i=r,typeof a=="string"&&(e={uri:a})):e=Ci({},r,{uri:a}),e.callback=i,e}function yt(a,r,i){return r=Ho(a,r,i),Wo(r)}function Wo(a){if(typeof a.callback>"u")throw new Error("callback argument missing");var r=!1,i=function(O,M,U){r||(r=!0,a.callback(O,M,U))};function e(){o.readyState===4&&setTimeout(s,0)}function t(){var D=void 0;if(o.response?D=o.response:D=o.responseText||nh(o),b)try{D=JSON.parse(D)}catch{}return D}function n(D){return clearTimeout(A),D instanceof Error||(D=new Error(""+(D||"Unknown XMLHttpRequest Error"))),D.statusCode=0,i(D,I)}function s(){if(!l){var D;clearTimeout(A),a.useXDR&&o.status===void 0?D=200:D=o.status===1223?204:o.status;var O=I,M=null;return D!==0?(O={body:t(),statusCode:D,method:f,headers:{},url:c,rawRequest:o},o.getAllResponseHeaders&&(O.headers=eh(o.getAllResponseHeaders()))):M=new Error("Internal XMLHttpRequest Error"),i(M,O,O.body)}}var o=a.xhr||null;o||(a.cors||a.useXDR?o=new yt.XDomainRequest:o=new yt.XMLHttpRequest);var u,l,c=o.url=a.uri||a.url,f=o.method=a.method||"GET",d=a.body||a.data,m=o.headers=a.headers||{},_=!!a.sync,b=!1,A,I={body:void 0,headers:{},statusCode:0,method:f,url:c,rawRequest:o};if("json"in a&&a.json!==!1&&(b=!0,m.accept||m.Accept||(m.Accept="application/json"),f!=="GET"&&f!=="HEAD"&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),d=JSON.stringify(a.json===!0?d:a.json))),o.onreadystatechange=e,o.onload=s,o.onerror=n,o.onprogress=function(){},o.onabort=function(){l=!0},o.ontimeout=n,o.open(f,c,!_,a.username,a.password),_||(o.withCredentials=!!a.withCredentials),!_&&a.timeout>0&&(A=setTimeout(function(){if(!l){l=!0,o.abort("timeout");var D=new Error("XMLHttpRequest timeout");D.code="ETIMEDOUT",n(D)}},a.timeout)),o.setRequestHeader)for(u in m)m.hasOwnProperty(u)&&o.setRequestHeader(u,m[u]);else if(a.headers&&!ih(a.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in a&&(o.responseType=a.responseType),"beforeSend"in a&&typeof a.beforeSend=="function"&&a.beforeSend(o),o.send(d||null),o}function nh(a){try{if(a.responseType==="document")return a.responseXML;var r=a.responseXML&&a.responseXML.documentElement.nodeName==="parsererror";if(a.responseType===""&&!r)return a.responseXML}catch{}return null}function ah(){}sa.default=th;var Go=function(r,i){var e=new S.WebVTT.Parser(S,S.vttjs,S.WebVTT.StringDecoder()),t=[];e.oncue=function(n){i.addCue(n)},e.onparsingerror=function(n){t.push(n)},e.onflush=function(){i.trigger({type:"loadeddata",target:i})},e.parse(r),t.length>0&&(S.console&&S.console.groupCollapsed&&S.console.groupCollapsed("Text Track parsing errors for "+i.src),t.forEach(function(n){return re.error(n)}),S.console&&S.console.groupEnd&&S.console.groupEnd()),e.flush()},qo=function(r,i){var e={uri:r},t=Ni(r);t&&(e.cors=t),sa(e,te(this,function(n,s,o){if(n)return re.error(n,s);i.loaded_=!0,typeof S.WebVTT!="function"?i.tech_&&i.tech_.any(["vttjsloaded","vttjserror"],function(u){if(u.type==="vttjserror"){re.error("vttjs failed to load, stopping trying to process "+i.src);return}return Go(o,i)}):Go(o,i)}))},Yr=function(a){H(r,a);function r(e){var t;if(e===void 0&&(e={}),!e.tech)throw new Error("A tech was not provided.");var n=fe(e,{kind:$f[e.kind]||"subtitles",language:e.language||e.srclang||""}),s=jo[n.mode]||"disabled",o=n.default;(n.kind==="metadata"||n.kind==="chapters")&&(s="hidden"),t=a.call(this,n)||this,t.tech_=n.tech,t.cues_=[],t.activeCues_=[],t.preload_=t.tech_.preloadTextTracks!==!1;var u=new Bo(t.cues_),l=new Bo(t.activeCues_),c=!1,f=te(J(t),function(){this.activeCues=this.activeCues,c&&(this.trigger("cuechange"),c=!1)});return s!=="disabled"&&t.tech_.ready(function(){t.tech_.on("timeupdate",f)},!0),Object.defineProperties(J(t),{default:{get:function(){return o},set:function(){}},mode:{get:function(){return s},set:function(m){var _=this;jo[m]&&(s=m,!this.preload_&&s!=="disabled"&&this.cues.length===0&&qo(this.src,this),s!=="disabled"?this.tech_.ready(function(){_.tech_.on("timeupdate",f)},!0):this.tech_.off("timeupdate",f),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?u:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(this.cues.length===0)return l;for(var m=this.tech_.currentTime(),_=[],b=0,A=this.cues.length;b<A;b++){var I=this.cues[b];(I.startTime<=m&&I.endTime>=m||I.startTime===I.endTime&&I.startTime<=m&&I.startTime+.5>=m)&&_.push(I)}if(c=!1,_.length!==this.activeCues_.length)c=!0;else for(var D=0;D<_.length;D++)this.activeCues_.indexOf(_[D])===-1&&(c=!0);return this.activeCues_=_,l.setCues_(this.activeCues_),l},set:function(){}}}),n.src?(t.src=n.src,t.preload_||(t.loaded_=!0),(t.preload_||o||n.kind!=="subtitles"&&n.kind!=="captions")&&qo(t.src,J(t))):t.loaded_=!0,t}var i=r.prototype;return i.addCue=function(t){var n=t;if(S.vttjs&&!(t instanceof S.vttjs.VTTCue)){n=new S.vttjs.VTTCue(t.startTime,t.endTime,t.text);for(var s in t)s in n||(n[s]=t[s]);n.id=t.id,n.originalCue_=t}for(var o=this.tech_.textTracks(),u=0;u<o.length;u++)o[u]!==this&&o[u].removeCue(n);this.cues_.push(n),this.cues.setCues_(this.cues_)},i.removeCue=function(t){for(var n=this.cues_.length;n--;){var s=this.cues_[n];if(s===t||s.originalCue_&&s.originalCue_===t){this.cues_.splice(n,1),this.cues.setCues_(this.cues_);break}}},r}(ia);Yr.prototype.allowedEvents_={cuechange:"cuechange"};var zo=function(a){H(r,a);function r(i){var e;i===void 0&&(i={});var t=fe(i,{kind:Xf[i.kind]||""});e=a.call(this,t)||this;var n=!1;return Object.defineProperty(J(e),"enabled",{get:function(){return n},set:function(o){typeof o!="boolean"||o===n||(n=o,this.trigger("enabledchange"))}}),t.enabled&&(e.enabled=t.enabled),e.loaded_=!0,e}return r}(ia),Ko=function(a){H(r,a);function r(i){var e;i===void 0&&(i={});var t=fe(i,{kind:Kf[i.kind]||""});e=a.call(this,t)||this;var n=!1;return Object.defineProperty(J(e),"selected",{get:function(){return n},set:function(o){typeof o!="boolean"||o===n||(n=o,this.trigger("selectedchange"))}}),t.selected&&(e.selected=t.selected),e}return r}(ia),Xo=0,sh=1,$o=2,oh=3,hr=function(a){H(r,a);function r(i){var e;i===void 0&&(i={}),e=a.call(this)||this;var t,n=new Yr(i);return e.kind=n.kind,e.src=n.src,e.srclang=n.language,e.label=n.label,e.default=n.default,Object.defineProperties(J(e),{readyState:{get:function(){return t}},track:{get:function(){return n}}}),t=Xo,n.addEventListener("loadeddata",function(){t=$o,e.trigger({type:"load",target:J(e)})}),e}return r}(be);hr.prototype.allowedEvents_={load:"load"},hr.NONE=Xo,hr.LOADING=sh,hr.LOADED=$o,hr.ERROR=oh;var Ke={audio:{ListClass:Gf,TrackClass:zo,capitalName:"Audio"},video:{ListClass:qf,TrackClass:Ko,capitalName:"Video"},text:{ListClass:Fo,TrackClass:Yr,capitalName:"Text"}};Object.keys(Ke).forEach(function(a){Ke[a].getterName=a+"Tracks",Ke[a].privateName=a+"Tracks_"});var dr={remoteText:{ListClass:Fo,TrackClass:Yr,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:zf,TrackClass:hr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},De=Ci({},Ke,dr);dr.names=Object.keys(dr),Ke.names=Object.keys(Ke),De.names=[].concat(dr.names).concat(Ke.names);var oa=Object.create||function(){function a(){}return function(r){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return a.prototype=r,new a}}();function We(a,r){this.name="ParsingError",this.code=a.code,this.message=r||a.message}We.prototype=oa(Error.prototype),We.prototype.constructor=We,We.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function ua(a){function r(e,t,n,s){return(e|0)*3600+(t|0)*60+(n|0)+(s|0)/1e3}var i=a.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return i?i[3]?r(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?r(i[1],i[2],0,i[4]):r(0,i[1],i[2],i[4]):null}function Qr(){this.values=oa(null)}Qr.prototype={set:function(r,i){!this.get(r)&&i!==""&&(this.values[r]=i)},get:function(r,i,e){return e?this.has(r)?this.values[r]:i[e]:this.has(r)?this.values[r]:i},has:function(r){return r in this.values},alt:function(r,i,e){for(var t=0;t<e.length;++t)if(i===e[t]){this.set(r,i);break}},integer:function(r,i){/^-?\d+$/.test(i)&&this.set(r,parseInt(i,10))},percent:function(r,i){var e;return(e=i.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(i=parseFloat(i),i>=0&&i<=100)?(this.set(r,i),!0):!1}};function Jr(a,r,i,e){var t=e?a.split(e):[a];for(var n in t)if(typeof t[n]=="string"){var s=t[n].split(i);if(s.length===2){var o=s[0],u=s[1];r(o,u)}}}function uh(a,r,i){var e=a;function t(){var o=ua(a);if(o===null)throw new We(We.Errors.BadTimeStamp,"Malformed timestamp: "+e);return a=a.replace(/^[^\sa-zA-Z-]+/,""),o}function n(o,u){var l=new Qr;Jr(o,function(c,f){switch(c){case"region":for(var d=i.length-1;d>=0;d--)if(i[d].id===f){l.set(c,i[d].region);break}break;case"vertical":l.alt(c,f,["rl","lr"]);break;case"line":var m=f.split(","),_=m[0];l.integer(c,_),l.percent(c,_)&&l.set("snapToLines",!1),l.alt(c,_,["auto"]),m.length===2&&l.alt("lineAlign",m[1],["start","center","end"]);break;case"position":m=f.split(","),l.percent(c,m[0]),m.length===2&&l.alt("positionAlign",m[1],["start","center","end"]);break;case"size":l.percent(c,f);break;case"align":l.alt(c,f,["start","center","end","left","right"]);break}},/:/,/\s/),u.region=l.get("region",null),u.vertical=l.get("vertical","");try{u.line=l.get("line","auto")}catch{}u.lineAlign=l.get("lineAlign","start"),u.snapToLines=l.get("snapToLines",!0),u.size=l.get("size",100);try{u.align=l.get("align","center")}catch{u.align=l.get("align","middle")}try{u.position=l.get("position","auto")}catch{u.position=l.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},u.align)}u.positionAlign=l.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},u.align)}function s(){a=a.replace(/^\s+/,"")}if(s(),r.startTime=t(),s(),a.substr(0,3)!=="-->")throw new We(We.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+e);a=a.substr(3),s(),r.endTime=t(),s(),n(a,r)}var la=N.createElement("textarea"),lh={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},Yo={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},ch={v:"title",lang:"lang"},Qo={rt:"ruby"};function Jo(a,r){function i(){if(!r)return null;function _(A){return r=r.substr(A.length),A}var b=r.match(/^([^<]*)(<[^>]*>?)?/);return _(b[1]?b[1]:b[2])}function e(_){return la.innerHTML=_,_=la.textContent,la.textContent="",_}function t(_,b){return!Qo[b.localName]||Qo[b.localName]===_.localName}function n(_,b){var A=lh[_];if(!A)return null;var I=a.document.createElement(A),D=ch[_];return D&&b&&(I[D]=b.trim()),I}for(var s=a.document.createElement("div"),o=s,u,l=[];(u=i())!==null;){if(u[0]==="<"){if(u[1]==="/"){l.length&&l[l.length-1]===u.substr(2).replace(">","")&&(l.pop(),o=o.parentNode);continue}var c=ua(u.substr(1,u.length-2)),f;if(c){f=a.document.createProcessingInstruction("timestamp",c),o.appendChild(f);continue}var d=u.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!d||(f=n(d[1],d[3]),!f)||!t(o,f))continue;if(d[2]){var m=d[2].split(".");m.forEach(function(_){var b=/^bg_/.test(_),A=b?_.slice(3):_;if(Yo.hasOwnProperty(A)){var I=b?"background-color":"color",D=Yo[A];f.style[I]=D}}),f.className=m.join(" ")}l.push(d[1]),o.appendChild(f),o=f;continue}o.appendChild(a.document.createTextNode(e(u)))}return s}var Zo=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function fh(a){for(var r=0;r<Zo.length;r++){var i=Zo[r];if(a>=i[0]&&a<=i[1])return!0}return!1}function hh(a){var r=[],i="",e;if(!a||!a.childNodes)return"ltr";function t(o,u){for(var l=u.childNodes.length-1;l>=0;l--)o.push(u.childNodes[l])}function n(o){if(!o||!o.length)return null;var u=o.pop(),l=u.textContent||u.innerText;if(l){var c=l.match(/^.*(\n|\r)/);return c?(o.length=0,c[0]):l}if(u.tagName==="ruby")return n(o);if(u.childNodes)return t(o,u),n(o)}for(t(r,a);i=n(r);)for(var s=0;s<i.length;s++)if(e=i.charCodeAt(s),fh(e))return"rtl";return"ltr"}function dh(a){if(typeof a.line=="number"&&(a.snapToLines||a.line>=0&&a.line<=100))return a.line;if(!a.track||!a.track.textTrackList||!a.track.textTrackList.mediaElement)return-1;for(var r=a.track,i=r.textTrackList,e=0,t=0;t<i.length&&i[t]!==r;t++)i[t].mode==="showing"&&e++;return++e*-1}function Mi(){}Mi.prototype.applyStyles=function(a,r){r=r||this.div;for(var i in a)a.hasOwnProperty(i)&&(r.style[i]=a[i])},Mi.prototype.formatStyle=function(a,r){return a===0?0:a+r};function Ui(a,r,i){Mi.call(this),this.cue=r,this.cueDiv=Jo(a,r.text);var e={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:r.vertical===""?"horizontal-tb":r.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(e,this.cueDiv),this.div=a.document.createElement("div"),e={direction:hh(this.cueDiv),writingMode:r.vertical===""?"horizontal-tb":r.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:r.align==="middle"?"center":r.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(e),this.div.appendChild(this.cueDiv);var t=0;switch(r.positionAlign){case"start":t=r.position;break;case"center":t=r.position-r.size/2;break;case"end":t=r.position-r.size;break}r.vertical===""?this.applyStyles({left:this.formatStyle(t,"%"),width:this.formatStyle(r.size,"%")}):this.applyStyles({top:this.formatStyle(t,"%"),height:this.formatStyle(r.size,"%")}),this.move=function(n){this.applyStyles({top:this.formatStyle(n.top,"px"),bottom:this.formatStyle(n.bottom,"px"),left:this.formatStyle(n.left,"px"),right:this.formatStyle(n.right,"px"),height:this.formatStyle(n.height,"px"),width:this.formatStyle(n.width,"px")})}}Ui.prototype=oa(Mi.prototype),Ui.prototype.constructor=Ui;function we(a){var r,i,e,t;if(a.div){i=a.div.offsetHeight,e=a.div.offsetWidth,t=a.div.offsetTop;var n=(n=a.div.childNodes)&&(n=n[0])&&n.getClientRects&&n.getClientRects();a=a.div.getBoundingClientRect(),r=n?Math.max(n[0]&&n[0].height||0,a.height/n.length):0}this.left=a.left,this.right=a.right,this.top=a.top||t,this.height=a.height||i,this.bottom=a.bottom||t+(a.height||i),this.width=a.width||e,this.lineHeight=r!==void 0?r:a.lineHeight}we.prototype.move=function(a,r){switch(r=r!==void 0?r:this.lineHeight,a){case"+x":this.left+=r,this.right+=r;break;case"-x":this.left-=r,this.right-=r;break;case"+y":this.top+=r,this.bottom+=r;break;case"-y":this.top-=r,this.bottom-=r;break}},we.prototype.overlaps=function(a){return this.left<a.right&&this.right>a.left&&this.top<a.bottom&&this.bottom>a.top},we.prototype.overlapsAny=function(a){for(var r=0;r<a.length;r++)if(this.overlaps(a[r]))return!0;return!1},we.prototype.within=function(a){return this.top>=a.top&&this.bottom<=a.bottom&&this.left>=a.left&&this.right<=a.right},we.prototype.overlapsOppositeAxis=function(a,r){switch(r){case"+x":return this.left<a.left;case"-x":return this.right>a.right;case"+y":return this.top<a.top;case"-y":return this.bottom>a.bottom}},we.prototype.intersectPercentage=function(a){var r=Math.max(0,Math.min(this.right,a.right)-Math.max(this.left,a.left)),i=Math.max(0,Math.min(this.bottom,a.bottom)-Math.max(this.top,a.top)),e=r*i;return e/(this.height*this.width)},we.prototype.toCSSCompatValues=function(a){return{top:this.top-a.top,bottom:a.bottom-this.bottom,left:this.left-a.left,right:a.right-this.right,height:this.height,width:this.width}},we.getSimpleBoxPosition=function(a){var r=a.div?a.div.offsetHeight:a.tagName?a.offsetHeight:0,i=a.div?a.div.offsetWidth:a.tagName?a.offsetWidth:0,e=a.div?a.div.offsetTop:a.tagName?a.offsetTop:0;a=a.div?a.div.getBoundingClientRect():a.tagName?a.getBoundingClientRect():a;var t={left:a.left,right:a.right,top:a.top||e,height:a.height||r,bottom:a.bottom||e+(a.height||r),width:a.width||i};return t};function ph(a,r,i,e){function t(A,I){for(var D,O=new we(A),M=1,U=0;U<I.length;U++){for(;A.overlapsOppositeAxis(i,I[U])||A.within(i)&&A.overlapsAny(e);)A.move(I[U]);if(A.within(i))return A;var R=A.intersectPercentage(i);M>R&&(D=new we(A),M=R),A=new we(O)}return D||O}var n=new we(r),s=r.cue,o=dh(s),u=[];if(s.snapToLines){var l;switch(s.vertical){case"":u=["+y","-y"],l="height";break;case"rl":u=["+x","-x"],l="width";break;case"lr":u=["-x","+x"],l="width";break}var c=n.lineHeight,f=c*Math.round(o),d=i[l]+c,m=u[0];Math.abs(f)>d&&(f=f<0?-1:1,f*=Math.ceil(d/c)*c),o<0&&(f+=s.vertical===""?i.height:i.width,u=u.reverse()),n.move(m,f)}else{var _=n.lineHeight/i.height*100;switch(s.lineAlign){case"center":o-=_/2;break;case"end":o-=_;break}switch(s.vertical){case"":r.applyStyles({top:r.formatStyle(o,"%")});break;case"rl":r.applyStyles({left:r.formatStyle(o,"%")});break;case"lr":r.applyStyles({right:r.formatStyle(o,"%")});break}u=["+y","-x","+x","-y"],n=new we(r)}var b=t(n,u);r.move(b.toCSSCompatValues(i))}function pr(){}pr.StringDecoder=function(){return{decode:function(r){if(!r)return"";if(typeof r!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(r))}}},pr.convertCueToDOMTree=function(a,r){return!a||!r?null:Jo(a,r)};var mh=.05,vh="sans-serif",gh="1.5%";pr.processCues=function(a,r,i){if(!a||!r||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var e=a.document.createElement("div");e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.margin=gh,i.appendChild(e);function t(c){for(var f=0;f<c.length;f++)if(c[f].hasBeenReset||!c[f].displayState)return!0;return!1}if(!t(r)){for(var n=0;n<r.length;n++)e.appendChild(r[n].displayState);return}var s=[],o=we.getSimpleBoxPosition(e),u=Math.round(o.height*mh*100)/100,l={font:u+"px "+vh};(function(){for(var c,f,d=0;d<r.length;d++)f=r[d],c=new Ui(a,f,l),e.appendChild(c.div),ph(a,c,o,s),f.displayState=c.div,s.push(we.getSimpleBoxPosition(c))})()},pr.Parser=function(a,r,i){i||(i=r,r={}),r||(r={}),this.window=a,this.vttjs=r,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]},pr.Parser.prototype={reportOrThrowError:function(r){if(r instanceof We)this.onparsingerror&&this.onparsingerror(r);else throw r},parse:function(r){var i=this;r&&(i.buffer+=i.decoder.decode(r,{stream:!0}));function e(){for(var f=i.buffer,d=0;d<f.length&&f[d]!=="\r"&&f[d]!==`
`;)++d;var m=f.substr(0,d);return f[d]==="\r"&&++d,f[d]===`
`&&++d,i.buffer=f.substr(d),m}function t(f){var d=new Qr;if(Jr(f,function(_,b){switch(_){case"id":d.set(_,b);break;case"width":d.percent(_,b);break;case"lines":d.integer(_,b);break;case"regionanchor":case"viewportanchor":var A=b.split(",");if(A.length!==2)break;var I=new Qr;if(I.percent("x",A[0]),I.percent("y",A[1]),!I.has("x")||!I.has("y"))break;d.set(_+"X",I.get("x")),d.set(_+"Y",I.get("y"));break;case"scroll":d.alt(_,b,["up"]);break}},/=/,/\s/),d.has("id")){var m=new(i.vttjs.VTTRegion||i.window.VTTRegion);m.width=d.get("width",100),m.lines=d.get("lines",3),m.regionAnchorX=d.get("regionanchorX",0),m.regionAnchorY=d.get("regionanchorY",100),m.viewportAnchorX=d.get("viewportanchorX",0),m.viewportAnchorY=d.get("viewportanchorY",100),m.scroll=d.get("scroll",""),i.onregion&&i.onregion(m),i.regionList.push({id:d.get("id"),region:m})}}function n(f){var d=new Qr;Jr(f,function(m,_){switch(m){case"MPEGT":d.integer(m+"S",_);break;case"LOCA":d.set(m+"L",ua(_));break}},/[^\d]:/,/,/),i.ontimestampmap&&i.ontimestampmap({MPEGTS:d.get("MPEGTS"),LOCAL:d.get("LOCAL")})}function s(f){f.match(/X-TIMESTAMP-MAP/)?Jr(f,function(d,m){switch(d){case"X-TIMESTAMP-MAP":n(m);break}},/=/):Jr(f,function(d,m){switch(d){case"Region":t(m);break}},/:/)}try{var o;if(i.state==="INITIAL"){if(!/\r\n|\n/.test(i.buffer))return this;o=e();var u=o.match(/^WEBVTT([ \t].*)?$/);if(!u||!u[0])throw new We(We.Errors.BadSignature);i.state="HEADER"}for(var l=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(l?l=!1:o=e(),i.state){case"HEADER":/:/.test(o)?s(o):o||(i.state="ID");continue;case"NOTE":o||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){i.state="NOTE";break}if(!o)continue;i.cue=new(i.vttjs.VTTCue||i.window.VTTCue)(0,0,"");try{i.cue.align="center"}catch{i.cue.align="middle"}if(i.state="CUE",o.indexOf("-->")===-1){i.cue.id=o;continue}case"CUE":try{uh(o,i.cue,i.regionList)}catch(f){i.reportOrThrowError(f),i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var c=o.indexOf("-->")!==-1;if(!o||c&&(l=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+=`
`),i.cue.text+=o.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":o||(i.state="ID");continue}}}catch(f){i.reportOrThrowError(f),i.state==="CUETEXT"&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state=i.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var r=this;try{if(r.buffer+=r.decoder.decode(),(r.cue||r.state==="HEADER")&&(r.buffer+=`

`,r.parse()),r.state==="INITIAL")throw new We(We.Errors.BadSignature)}catch(i){r.reportOrThrowError(i)}return r.onflush&&r.onflush(),this}};var _h=pr,yh="auto",Th={"":1,lr:1,rl:1},bh={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function xh(a){if(typeof a!="string")return!1;var r=Th[a.toLowerCase()];return r?a.toLowerCase():!1}function ca(a){if(typeof a!="string")return!1;var r=bh[a.toLowerCase()];return r?a.toLowerCase():!1}function eu(a,r,i){this.hasBeenReset=!1;var e="",t=!1,n=a,s=r,o=i,u=null,l="",c=!0,f="auto",d="start",m="auto",_="auto",b=100,A="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return e},set:function(D){e=""+D}},pauseOnExit:{enumerable:!0,get:function(){return t},set:function(D){t=!!D}},startTime:{enumerable:!0,get:function(){return n},set:function(D){if(typeof D!="number")throw new TypeError("Start time must be set to a number.");n=D,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(D){if(typeof D!="number")throw new TypeError("End time must be set to a number.");s=D,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(D){o=""+D,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return u},set:function(D){u=D,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return l},set:function(D){var O=xh(D);if(O===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");l=O,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(D){c=!!D,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return f},set:function(D){if(typeof D!="number"&&D!==yh)throw new SyntaxError("Line: an invalid number or illegal string was specified.");f=D,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return d},set:function(D){var O=ca(D);O?(d=O,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return m},set:function(D){if(D<0||D>100)throw new Error("Position must be between 0 and 100.");m=D,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return _},set:function(D){var O=ca(D);O?(_=O,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return b},set:function(D){if(D<0||D>100)throw new Error("Size must be between 0 and 100.");b=D,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return A},set:function(D){var O=ca(D);if(!O)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");A=O,this.hasBeenReset=!0}}}),this.displayState=void 0}eu.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Sh=eu,Eh={"":!0,up:!0};function Ch(a){if(typeof a!="string")return!1;var r=Eh[a.toLowerCase()];return r?a.toLowerCase():!1}function Zr(a){return typeof a=="number"&&a>=0&&a<=100}function kh(){var a=100,r=3,i=0,e=100,t=0,n=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return a},set:function(u){if(!Zr(u))throw new Error("Width must be between 0 and 100.");a=u}},lines:{enumerable:!0,get:function(){return r},set:function(u){if(typeof u!="number")throw new TypeError("Lines must be set to a number.");r=u}},regionAnchorY:{enumerable:!0,get:function(){return e},set:function(u){if(!Zr(u))throw new Error("RegionAnchorX must be between 0 and 100.");e=u}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(u){if(!Zr(u))throw new Error("RegionAnchorY must be between 0 and 100.");i=u}},viewportAnchorY:{enumerable:!0,get:function(){return n},set:function(u){if(!Zr(u))throw new Error("ViewportAnchorY must be between 0 and 100.");n=u}},viewportAnchorX:{enumerable:!0,get:function(){return t},set:function(u){if(!Zr(u))throw new Error("ViewportAnchorX must be between 0 and 100.");t=u}},scroll:{enumerable:!0,get:function(){return s},set:function(u){var l=Ch(u);l===!1?console.warn("Scroll: an invalid or illegal string was specified."):s=l}}})}var Ah=kh,ei=pt(function(a){var r=a.exports={WebVTT:_h,VTTCue:Sh,VTTRegion:Ah};S.vttjs=r,S.WebVTT=r.WebVTT;var i=r.VTTCue,e=r.VTTRegion,t=S.VTTCue,n=S.VTTRegion;r.shim=function(){S.VTTCue=i,S.VTTRegion=e},r.restore=function(){S.VTTCue=t,S.VTTRegion=n},S.VTTCue||r.shim()}),V0=ei.WebVTT,H0=ei.VTTCue,W0=ei.VTTRegion;function Ph(a,r,i,e,t){t===void 0&&(t={});var n=a.textTracks();t.kind=r,i&&(t.label=i),e&&(t.language=e),t.tech=a;var s=new De.text.TrackClass(t);return n.addTrack(s),s}var le=function(a){H(r,a);function r(e,t){var n;return e===void 0&&(e={}),t===void 0&&(t=function(){}),e.reportTouchActivity=!1,n=a.call(this,null,e,t)||this,n.hasStarted_=!1,n.on("playing",function(){this.hasStarted_=!0}),n.on("loadstart",function(){this.hasStarted_=!1}),De.names.forEach(function(s){var o=De[s];e&&e[o.getterName]&&(n[o.privateName]=e[o.getterName])}),n.featuresProgressEvents||n.manualProgressOn(),n.featuresTimeupdateEvents||n.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(s){e["native"+s+"Tracks"]===!1&&(n["featuresNative"+s+"Tracks"]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?n.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(n.featuresNativeTextTracks=!0),n.featuresNativeTextTracks||n.emulateTextTracks(),n.preloadTextTracks=e.preloadTextTracks!==!1,n.autoRemoteTextTracks_=new De.text.ListClass,n.initTrackListeners(),e.nativeControlsForTouch||n.emitTapEvents(),n.constructor&&(n.name_=n.constructor.name||"Unknown Tech"),n}var i=r.prototype;return i.triggerSourceset=function(t){var n=this;this.isReady_||this.one("ready",function(){return n.setTimeout(function(){return n.triggerSourceset(t)},1)}),this.trigger({src:t,type:"sourceset"})},i.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},i.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},i.trackProgress=function(t){this.stopTrackingProgress(),this.progressInterval=this.setInterval(te(this,function(){var n=this.bufferedPercent();this.bufferedPercent_!==n&&this.trigger("progress"),this.bufferedPercent_=n,n===1&&this.stopTrackingProgress()}),500)},i.onDurationChange=function(t){this.duration_=this.duration()},i.buffered=function(){return jt(0,0)},i.bufferedPercent=function(){return No(this.buffered(),this.duration_)},i.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},i.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},i.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},i.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},i.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},i.dispose=function(){this.clearTracks(Ke.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),a.prototype.dispose.call(this)},i.clearTracks=function(t){var n=this;t=[].concat(t),t.forEach(function(s){for(var o=n[s+"Tracks"]()||[],u=o.length;u--;){var l=o[u];s==="text"&&n.removeRemoteTextTrack(l),o.removeTrack(l)}})},i.cleanupAutoTextTracks=function(){for(var t=this.autoRemoteTextTracks_||[],n=t.length;n--;){var s=t[n];this.removeRemoteTextTrack(s)}},i.reset=function(){},i.error=function(t){return t!==void 0&&(this.error_=new Ie(t),this.trigger("error")),this.error_},i.played=function(){return this.hasStarted_?jt(0,0):jt()},i.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},i.initTrackListeners=function(){var t=this;Ke.names.forEach(function(n){var s=Ke[n],o=function(){t.trigger(n+"trackchange")},u=t[s.getterName]();u.addEventListener("removetrack",o),u.addEventListener("addtrack",o),t.on("dispose",function(){u.removeEventListener("removetrack",o),u.removeEventListener("addtrack",o)})})},i.addWebVttScript_=function(){var t=this;if(!S.WebVTT)if(N.body.contains(this.el())){if(!this.options_["vtt.js"]&&Vr(ei)&&Object.keys(ei).length>0){this.trigger("vttjsloaded");return}var n=N.createElement("script");n.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",n.onload=function(){t.trigger("vttjsloaded")},n.onerror=function(){t.trigger("vttjserror")},this.on("dispose",function(){n.onload=null,n.onerror=null}),S.WebVTT=!0,this.el().parentNode.appendChild(n)}else this.ready(this.addWebVttScript_)},i.emulateTextTracks=function(){var t=this,n=this.textTracks(),s=this.remoteTextTracks(),o=function(d){return n.addTrack(d.track)},u=function(d){return n.removeTrack(d.track)};s.on("addtrack",o),s.on("removetrack",u),this.addWebVttScript_();var l=function(){return t.trigger("texttrackchange")},c=function(){l();for(var d=0;d<n.length;d++){var m=n[d];m.removeEventListener("cuechange",l),m.mode==="showing"&&m.addEventListener("cuechange",l)}};c(),n.addEventListener("change",c),n.addEventListener("addtrack",c),n.addEventListener("removetrack",c),this.on("dispose",function(){s.off("addtrack",o),s.off("removetrack",u),n.removeEventListener("change",c),n.removeEventListener("addtrack",c),n.removeEventListener("removetrack",c);for(var f=0;f<n.length;f++){var d=n[f];d.removeEventListener("cuechange",l)}})},i.addTextTrack=function(t,n,s){if(!t)throw new Error("TextTrack kind is required but was not provided");return Ph(this,t,n,s)},i.createRemoteTextTrack=function(t){var n=fe(t,{tech:this});return new dr.remoteTextEl.TrackClass(n)},i.addRemoteTextTrack=function(t,n){var s=this;t===void 0&&(t={});var o=this.createRemoteTextTrack(t);return n!==!0&&n!==!1&&(re.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),n=!0),this.remoteTextTrackEls().addTrackElement_(o),this.remoteTextTracks().addTrack(o.track),n!==!0&&this.ready(function(){return s.autoRemoteTextTracks_.addTrack(o.track)}),o},i.removeRemoteTextTrack=function(t){var n=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(n),this.remoteTextTracks().removeTrack(t),this.autoRemoteTextTracks_.removeTrack(t)},i.getVideoPlaybackQuality=function(){return{}},i.requestPictureInPicture=function(){var t=this.options_.Promise||S.Promise;if(t)return t.reject()},i.setPoster=function(){},i.playsinline=function(){},i.setPlaysinline=function(){},i.overrideNativeAudioTracks=function(){},i.overrideNativeVideoTracks=function(){},i.canPlayType=function(){return""},r.canPlayType=function(){return""},r.canPlaySource=function(t,n){return r.canPlayType(t.type)},r.isTech=function(t){return t.prototype instanceof r||t instanceof r||t===r},r.registerTech=function(t,n){if(r.techs_||(r.techs_={}),!r.isTech(n))throw new Error("Tech "+t+" must be a Tech");if(!r.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!r.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return t=ge(t),r.techs_[t]=n,r.techs_[wi(t)]=n,t!=="Tech"&&r.defaultTechOrder_.push(t),n},r.getTech=function(t){if(t){if(r.techs_&&r.techs_[t])return r.techs_[t];if(t=ge(t),S&&S.videojs&&S.videojs[t])return re.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),S.videojs[t]}},r}(L);De.names.forEach(function(a){var r=De[a];le.prototype[r.getterName]=function(){return this[r.privateName]=this[r.privateName]||new r.ListClass,this[r.privateName]}}),le.prototype.featuresVolumeControl=!0,le.prototype.featuresMuteControl=!0,le.prototype.featuresFullscreenResize=!1,le.prototype.featuresPlaybackRate=!1,le.prototype.featuresProgressEvents=!1,le.prototype.featuresSourceset=!1,le.prototype.featuresTimeupdateEvents=!1,le.prototype.featuresNativeTextTracks=!1,le.withSourceHandlers=function(a){a.registerSourceHandler=function(i,e){var t=a.sourceHandlers;t||(t=a.sourceHandlers=[]),e===void 0&&(e=t.length),t.splice(e,0,i)},a.canPlayType=function(i){for(var e=a.sourceHandlers||[],t,n=0;n<e.length;n++)if(t=e[n].canPlayType(i),t)return t;return""},a.selectSourceHandler=function(i,e){for(var t=a.sourceHandlers||[],n,s=0;s<t.length;s++)if(n=t[s].canHandleSource(i,e),n)return t[s];return null},a.canPlaySource=function(i,e){var t=a.selectSourceHandler(i,e);return t?t.canHandleSource(i,e):""};var r=["seekable","seeking","duration"];r.forEach(function(i){var e=this[i];typeof e=="function"&&(this[i]=function(){return this.sourceHandler_&&this.sourceHandler_[i]?this.sourceHandler_[i].apply(this.sourceHandler_,arguments):e.apply(this,arguments)})},a.prototype),a.prototype.setSource=function(i){var e=a.selectSourceHandler(i,this.options_);e||(a.nativeSourceHandler?e=a.nativeSourceHandler:re.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),e!==a.nativeSourceHandler&&(this.currentSource_=i),this.sourceHandler_=e.handleSource(i,this,this.options_),this.one("dispose",this.disposeSourceHandler)},a.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},L.registerComponent("Tech",le),le.registerTech("Tech",le),le.defaultTechOrder_=[];var Ht={},fa={},Fi={};function Ih(a,r){Ht[a]=Ht[a]||[],Ht[a].push(r)}function Dh(a,r,i){a.setTimeout(function(){return Wt(r,Ht[r.type],i,a)},1)}function wh(a,r){a.forEach(function(i){return i.setTech&&i.setTech(r)})}function Oh(a,r,i){return a.reduceRight(ha(i),r[i]())}function Lh(a,r,i,e){return r[i](a.reduce(ha(i),e))}function tu(a,r,i,e){e===void 0&&(e=null);var t="call"+ge(i),n=a.reduce(ha(t),e),s=n===Fi,o=s?null:r[i](n);return Mh(a,i,o,s),o}var Rh={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1},Nh={setCurrentTime:1,setMuted:1,setVolume:1},ru={play:1,pause:1};function ha(a){return function(r,i){return r===Fi?Fi:i[a]?i[a](r):r}}function Mh(a,r,i,e){for(var t=a.length-1;t>=0;t--){var n=a[t];n[r]&&n[r](e,i)}}function Uh(a){fa[a.id()]=null}function Fh(a,r){var i=fa[a.id()],e=null;if(i==null)return e=r(a),fa[a.id()]=[[r,e]],e;for(var t=0;t<i.length;t++){var n=i[t],s=n[0],o=n[1];s===r&&(e=o)}return e===null&&(e=r(a),i.push([r,e])),e}function Wt(a,r,i,e,t,n){a===void 0&&(a={}),r===void 0&&(r=[]),t===void 0&&(t=[]),n===void 0&&(n=!1);var s=r,o=s[0],u=s.slice(1);if(typeof o=="string")Wt(a,Ht[o],i,e,t,n);else if(o){var l=Fh(e,o);if(!l.setSource)return t.push(l),Wt(a,u,i,e,t,n);l.setSource(he({},a),function(c,f){if(c)return Wt(a,u,i,e,t,n);t.push(l),Wt(f,a.type===f.type?u:Ht[f.type],i,e,t,n)})}else u.length?Wt(a,u,i,e,t,n):n?i(a,t):Wt(a,Ht["*"],i,e,t,!0)}var Bh={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Bi=function(r){r===void 0&&(r="");var i=aa(r),e=Bh[i.toLowerCase()];return e||""},jh=function(r,i){if(!i)return"";if(r.cache_.source.src===i&&r.cache_.source.type)return r.cache_.source.type;var e=r.cache_.sources.filter(function(o){return o.src===i});if(e.length)return e[0].type;for(var t=r.$$("source"),n=0;n<t.length;n++){var s=t[n];if(s.type&&s.src&&s.src===i)return s.type}return Bi(i)},Vh=function a(r){if(Array.isArray(r)){var i=[];r.forEach(function(e){e=a(e),Array.isArray(e)?i=i.concat(e):kt(e)&&i.push(e)}),r=i}else typeof r=="string"&&r.trim()?r=[iu({src:r})]:kt(r)&&typeof r.src=="string"&&r.src&&r.src.trim()?r=[iu(r)]:r=[];return r};function iu(a){if(!a.type){var r=Bi(a.src);r&&(a.type=r)}return a}var Hh=function(a){H(r,a);function r(i,e,t){var n,s=fe({createEl:!1},e);if(n=a.call(this,i,s,t)||this,!e.playerOptions.sources||e.playerOptions.sources.length===0)for(var o=0,u=e.playerOptions.techOrder;o<u.length;o++){var l=ge(u[o]),c=le.getTech(l);if(l||(c=L.getComponent(l)),c&&c.isSupported()){i.loadTech_(l);break}}else i.src(e.playerOptions.sources);return n}return r}(L);L.registerComponent("MediaLoader",Hh);var ji=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.emitTapEvents(),n.enable(),n}var i=r.prototype;return i.createEl=function(t,n,s){t===void 0&&(t="div"),n===void 0&&(n={}),s===void 0&&(s={}),n=he({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),t==="button"&&re.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),s=he({role:"button"},s),this.tabIndex_=n.tabIndex;var o=a.prototype.createEl.call(this,t,n,s);return this.createControlTextEl(o),o},i.dispose=function(){this.controlTextEl_=null,a.prototype.dispose.call(this)},i.createControlTextEl=function(t){return this.controlTextEl_=de("span",{className:"vjs-control-text"},{"aria-live":"polite"}),t&&t.appendChild(this.controlTextEl_),this.controlText(this.controlText_,t),this.controlTextEl_},i.controlText=function(t,n){if(n===void 0&&(n=this.el()),t===void 0)return this.controlText_||"Need Text";var s=this.localize(t);this.controlText_=t,ar(this.controlTextEl_,s),this.nonIconControl||n.setAttribute("title",s)},i.buildCSSClass=function(){return"vjs-control vjs-button "+a.prototype.buildCSSClass.call(this)},i.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},i.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},i.handleClick=function(t){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},i.handleKeyDown=function(t){Y.isEventKey(t,"Space")||Y.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):a.prototype.handleKeyDown.call(this,t)},r}(L);L.registerComponent("ClickableComponent",ji);var Wh=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.update(),e.on("posterchange",te(J(n),n.update)),n}var i=r.prototype;return i.dispose=function(){this.player().off("posterchange",this.update),a.prototype.dispose.call(this)},i.createEl=function(){var t=de("div",{className:"vjs-poster",tabIndex:-1});return t},i.update=function(t){var n=this.player().poster();this.setSrc(n),n?this.show():this.hide()},i.setSrc=function(t){var n="";t&&(n='url("'+t+'")'),this.el_.style.backgroundImage=n},i.handleClick=function(t){if(this.player_.controls()){var n=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;this.player_.tech(!0)&&!((Kr||zr)&&n)&&this.player_.tech(!0).focus(),this.player_.paused()?Vt(this.player_.play()):this.player_.pause()}},r}(ji);L.registerComponent("PosterImage",Wh);var Xe="#222",nu="#ccc",Gh={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function da(a,r){var i;if(a.length===4)i=a[1]+a[1]+a[2]+a[2]+a[3]+a[3];else if(a.length===7)i=a.slice(1);else throw new Error("Invalid color code provided, "+a+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+r+")"}function pa(a,r,i){try{a.style[r]=i}catch{return}}var qh=function(a){H(r,a);function r(e,t,n){var s;s=a.call(this,e,t,n)||this;var o=te(J(s),s.updateDisplay);return e.on("loadstart",te(J(s),s.toggleDisplay)),e.on("texttrackchange",o),e.on("loadedmetadata",te(J(s),s.preselectTrack)),e.ready(te(J(s),function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",o),e.on("playerresize",o),S.addEventListener("orientationchange",o),e.on("dispose",function(){return S.removeEventListener("orientationchange",o)});for(var u=this.options_.playerOptions.tracks||[],l=0;l<u.length;l++)this.player_.addRemoteTextTrack(u[l],!0);this.preselectTrack()})),s}var i=r.prototype;return i.preselectTrack=function(){for(var t={captions:1,subtitles:1},n=this.player_.textTracks(),s=this.player_.cache_.selectedLanguage,o,u,l,c=0;c<n.length;c++){var f=n[c];s&&s.enabled&&s.language&&s.language===f.language&&f.kind in t?f.kind===s.kind?l=f:l||(l=f):s&&!s.enabled?(l=null,o=null,u=null):f.default&&(f.kind==="descriptions"&&!o?o=f:f.kind in t&&!u&&(u=f))}l?l.mode="showing":u?u.mode="showing":o&&(o.mode="showing")},i.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},i.clearDisplay=function(){typeof S.WebVTT=="function"&&S.WebVTT.processCues(S,[],this.el_)},i.updateDisplay=function(){var t=this.player_.textTracks(),n=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),n){for(var s=[],o=0;o<t.length;++o){var u=t[o];u.mode==="showing"&&s.push(u)}this.updateForTrack(s);return}for(var l=null,c=null,f=t.length;f--;){var d=t[f];d.mode==="showing"&&(d.kind==="descriptions"?l=d:c=d)}c?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(c)):l&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(l))},i.updateDisplayState=function(t){for(var n=this.player_.textTrackSettings.getValues(),s=t.activeCues,o=s.length;o--;){var u=s[o];if(u){var l=u.displayState;if(n.color&&(l.firstChild.style.color=n.color),n.textOpacity&&pa(l.firstChild,"color",da(n.color||"#fff",n.textOpacity)),n.backgroundColor&&(l.firstChild.style.backgroundColor=n.backgroundColor),n.backgroundOpacity&&pa(l.firstChild,"backgroundColor",da(n.backgroundColor||"#000",n.backgroundOpacity)),n.windowColor&&(n.windowOpacity?pa(l,"backgroundColor",da(n.windowColor,n.windowOpacity)):l.style.backgroundColor=n.windowColor),n.edgeStyle&&(n.edgeStyle==="dropshadow"?l.firstChild.style.textShadow="2px 2px 3px "+Xe+", 2px 2px 4px "+Xe+", 2px 2px 5px "+Xe:n.edgeStyle==="raised"?l.firstChild.style.textShadow="1px 1px "+Xe+", 2px 2px "+Xe+", 3px 3px "+Xe:n.edgeStyle==="depressed"?l.firstChild.style.textShadow="1px 1px "+nu+", 0 1px "+nu+", -1px -1px "+Xe+", 0 -1px "+Xe:n.edgeStyle==="uniform"&&(l.firstChild.style.textShadow="0 0 4px "+Xe+", 0 0 4px "+Xe+", 0 0 4px "+Xe+", 0 0 4px "+Xe)),n.fontPercent&&n.fontPercent!==1){var c=S.parseFloat(l.style.fontSize);l.style.fontSize=c*n.fontPercent+"px",l.style.height="auto",l.style.top="auto",l.style.bottom="2px"}n.fontFamily&&n.fontFamily!=="default"&&(n.fontFamily==="small-caps"?l.firstChild.style.fontVariant="small-caps":l.firstChild.style.fontFamily=Gh[n.fontFamily])}}},i.updateForTrack=function(t){if(Array.isArray(t)||(t=[t]),!(typeof S.WebVTT!="function"||t.every(function(m){return!m.activeCues}))){for(var n=[],s=0;s<t.length;++s)for(var o=t[s],u=0;u<o.activeCues.length;++u)n.push(o.activeCues[u]);S.WebVTT.processCues(S,n,this.el_);for(var l=0;l<t.length;++l){for(var c=t[l],f=0;f<c.activeCues.length;++f){var d=c.activeCues[f].displayState;mt(d,"vjs-text-track-cue"),mt(d,"vjs-text-track-cue-"+(c.language?c.language:l))}this.player_.textTrackSettings&&this.updateDisplayState(c)}}},r}(L);L.registerComponent("TextTrackDisplay",qh);var zh=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.createEl=function(){var t=this.player_.isAudio(),n=this.localize(t?"Audio Player":"Video Player"),s=de("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),o=a.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return o.appendChild(s),o},r}(L);L.registerComponent("LoadingSpinner",zh);var rt=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.createEl=function(t,n,s){n===void 0&&(n={}),s===void 0&&(s={}),t="button",n=he({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},n),s=he({type:"button"},s);var o=L.prototype.createEl.call(this,t,n,s);return this.createControlTextEl(o),o},i.addChild=function(t,n){n===void 0&&(n={});var s=this.constructor.name;return re.warn("Adding an actionable (user controllable) child to a Button ("+s+") is not supported; use a ClickableComponent instead."),L.prototype.addChild.call(this,t,n)},i.enable=function(){a.prototype.enable.call(this),this.el_.removeAttribute("disabled")},i.disable=function(){a.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},i.handleKeyDown=function(t){if(Y.isEventKey(t,"Space")||Y.isEventKey(t,"Enter")){t.stopPropagation();return}a.prototype.handleKeyDown.call(this,t)},r}(ji);L.registerComponent("Button",rt);var au=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.mouseused_=!1,n.on("mousedown",n.handleMouseDown),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-big-play-button"},i.handleClick=function(t){var n=this.player_.play();if(this.mouseused_&&t.clientX&&t.clientY){var s=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;Vt(n),this.player_.tech(!0)&&!((Kr||zr)&&s)&&this.player_.tech(!0).focus();return}var o=this.player_.getChild("controlBar"),u=o&&o.getChild("playToggle");if(!u){this.player_.tech(!0).focus();return}var l=function(){return u.focus()};$r(n)?n.then(l,function(){}):this.setTimeout(l,1)},i.handleKeyDown=function(t){this.mouseused_=!1,a.prototype.handleKeyDown.call(this,t)},i.handleMouseDown=function(t){this.mouseused_=!0},r}(rt);au.prototype.controlText_="Play Video",L.registerComponent("BigPlayButton",au);var Kh=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.controlText(t&&t.controlText||n.localize("Close")),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-close-button "+a.prototype.buildCSSClass.call(this)},i.handleClick=function(t){this.trigger({type:"close",bubbles:!1})},i.handleKeyDown=function(t){Y.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):a.prototype.handleKeyDown.call(this,t)},r}(rt);L.registerComponent("CloseButton",Kh);var su=function(a){H(r,a);function r(e,t){var n;return t===void 0&&(t={}),n=a.call(this,e,t)||this,t.replay=t.replay===void 0||t.replay,n.on(e,"play",n.handlePlay),n.on(e,"pause",n.handlePause),t.replay&&n.on(e,"ended",n.handleEnded),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-play-control "+a.prototype.buildCSSClass.call(this)},i.handleClick=function(t){this.player_.paused()?this.player_.play():this.player_.pause()},i.handleSeeked=function(t){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(t):this.handlePlay(t)},i.handlePlay=function(t){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},i.handlePause=function(t){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},i.handleEnded=function(t){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},r}(rt);su.prototype.controlText_="Play",L.registerComponent("PlayToggle",su);var ou=function(r,i){r=r<0?0:r;var e=Math.floor(r%60),t=Math.floor(r/60%60),n=Math.floor(r/3600),s=Math.floor(i/60%60),o=Math.floor(i/3600);return(isNaN(r)||r===1/0)&&(n=t=e="-"),n=n>0||o>0?n+":":"",t=((n||s>=10)&&t<10?"0"+t:t)+":",e=e<10?"0"+e:e,n+t+e},ma=ou;function Xh(a){ma=a}function $h(){ma=ou}function mr(a,r){return r===void 0&&(r=a),ma(a,r)}var vr=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.on(e,["timeupdate","ended"],n.updateContent),n.updateTextNode_(),n}var i=r.prototype;return i.createEl=function(){var t=this.buildCSSClass(),n=a.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+"\xA0</span>"});return this.contentEl_=de("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),n.appendChild(this.contentEl_),n},i.dispose=function(){this.contentEl_=null,this.textNode_=null,a.prototype.dispose.call(this)},i.updateTextNode_=function(t){var n=this;t===void 0&&(t=0),t=mr(t),this.formattedTime_!==t&&(this.formattedTime_=t,this.requestAnimationFrame(function(){if(n.contentEl_){var s=n.textNode_;n.textNode_=N.createTextNode(n.formattedTime_),n.textNode_&&(s?n.contentEl_.replaceChild(n.textNode_,s):n.contentEl_.appendChild(n.textNode_))}}))},i.updateContent=function(t){},r}(L);vr.prototype.labelText_="Time",vr.prototype.controlText_="Time",L.registerComponent("TimeDisplay",vr);var va=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-current-time"},i.updateContent=function(t){var n;this.player_.ended()?n=this.player_.duration():n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(n)},r}(vr);va.prototype.labelText_="Current Time",va.prototype.controlText_="Current Time",L.registerComponent("CurrentTimeDisplay",va);var ga=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.on(e,"durationchange",n.updateContent),n.on(e,"loadstart",n.updateContent),n.on(e,"loadedmetadata",n.updateContent),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-duration"},i.updateContent=function(t){var n=this.player_.duration();this.updateTextNode_(n)},r}(vr);ga.prototype.labelText_="Duration",ga.prototype.controlText_="Duration",L.registerComponent("DurationDisplay",ga);var Yh=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},r}(L);L.registerComponent("TimeDivider",Yh);var _a=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.on(e,"durationchange",n.updateContent),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-remaining-time"},i.createEl=function(){var t=a.prototype.createEl.call(this);return t.insertBefore(de("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},i.updateContent=function(t){if(typeof this.player_.duration()=="number"){var n;this.player_.ended()?n=0:this.player_.remainingTimeDisplay?n=this.player_.remainingTimeDisplay():n=this.player_.remainingTime(),this.updateTextNode_(n)}},r}(vr);_a.prototype.labelText_="Remaining Time",_a.prototype.controlText_="Remaining Time",L.registerComponent("RemainingTimeDisplay",_a);var Qh=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.updateShowing(),n.on(n.player(),"durationchange",n.updateShowing),n}var i=r.prototype;return i.createEl=function(){var t=a.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=de("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"\xA0</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},i.dispose=function(){this.contentEl_=null,a.prototype.dispose.call(this)},i.updateShowing=function(t){this.player().duration()===1/0?this.show():this.hide()},r}(L);L.registerComponent("LiveDisplay",Qh);var uu=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.updateLiveEdgeStatus(),n.player_.liveTracker&&n.on(n.player_.liveTracker,"liveedgechange",n.updateLiveEdgeStatus),n}var i=r.prototype;return i.createEl=function(){var t=a.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=de("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},i.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},i.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},i.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,a.prototype.dispose.call(this)},r}(rt);uu.prototype.controlText_="Seek to live, currently playing live",L.registerComponent("SeekToLive",uu);var ya=function(r,i,e){return r=Number(r),Math.min(e,Math.max(i,isNaN(r)?i:r))},Ta=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.bar=n.getChild(n.options_.barName),n.vertical(!!n.options_.vertical),n.enable(),n}var i=r.prototype;return i.enabled=function(){return this.enabled_},i.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},i.disable=function(){if(this.enabled()){var t=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},i.createEl=function(t,n,s){return n===void 0&&(n={}),s===void 0&&(s={}),n.className=n.className+" vjs-slider",n=he({tabIndex:0},n),s=he({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},s),a.prototype.createEl.call(this,t,n,s)},i.handleMouseDown=function(t){var n=this.bar.el_.ownerDocument;t.type==="mousedown"&&t.preventDefault(),t.type==="touchstart"&&!_t&&t.preventDefault(),lo(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(n,"mousemove",this.handleMouseMove),this.on(n,"mouseup",this.handleMouseUp),this.on(n,"touchmove",this.handleMouseMove),this.on(n,"touchend",this.handleMouseUp),this.handleMouseMove(t)},i.handleMouseMove=function(t){},i.handleMouseUp=function(){var t=this.bar.el_.ownerDocument;co(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.update()},i.update=function(){var t=this;if(!(!this.el_||!this.bar)){var n=this.getProgress();return n===this.progress_||(this.progress_=n,this.requestAnimationFrame(function(){var s=t.vertical()?"height":"width";t.bar.el().style[s]=(n*100).toFixed(2)+"%"})),n}},i.getProgress=function(){return Number(ya(this.getPercent(),0,1).toFixed(4))},i.calculateDistance=function(t){var n=Mn(this.el_,t);return this.vertical()?n.y:n.x},i.handleKeyDown=function(t){Y.isEventKey(t,"Left")||Y.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):Y.isEventKey(t,"Right")||Y.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):a.prototype.handleKeyDown.call(this,t)},i.handleClick=function(t){t.stopPropagation(),t.preventDefault()},i.vertical=function(t){if(t===void 0)return this.vertical_||!1;this.vertical_=!!t,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},r}(L);L.registerComponent("Slider",Ta);var ba=function(r,i){return ya(r/i*100,0,100).toFixed(2)+"%"},Jh=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.partEls_=[],n.on(e,"progress",n.update),n}var i=r.prototype;return i.createEl=function(){var t=a.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),n=de("span",{className:"vjs-control-text"}),s=de("span",{textContent:this.localize("Loaded")}),o=N.createTextNode(": ");return this.percentageEl_=de("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),t.appendChild(n),n.appendChild(s),n.appendChild(o),n.appendChild(this.percentageEl_),t},i.dispose=function(){this.partEls_=null,this.percentageEl_=null,a.prototype.dispose.call(this)},i.update=function(t){var n=this;this.requestAnimationFrame(function(){var s=n.player_.liveTracker,o=n.player_.buffered(),u=s&&s.isLive()?s.seekableEnd():n.player_.duration(),l=n.player_.bufferedEnd(),c=n.partEls_,f=ba(l,u);n.percent_!==f&&(n.el_.style.width=f,ar(n.percentageEl_,f),n.percent_=f);for(var d=0;d<o.length;d++){var m=o.start(d),_=o.end(d),b=c[d];b||(b=n.el_.appendChild(de()),c[d]=b),!(b.dataset.start===m&&b.dataset.end===_)&&(b.dataset.start=m,b.dataset.end=_,b.style.left=ba(m,l),b.style.width=ba(_-m,l))}for(var A=c.length;A>o.length;A--)n.el_.removeChild(c[A-1]);c.length=o.length})},r}(L);L.registerComponent("LoadProgressBar",Jh);var Zh=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.update=Ut(te(J(n),n.update),gt),n}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},i.update=function(t,n,s){var o=Gr(this.el_),u=Gr(this.player_.el()),l=t.width*n;if(!(!u||!o)){var c=t.left-u.left+l,f=t.width-l+(u.right-t.right),d=o.width/2;c<d?d+=d-c:f<d&&(d=f),d<0?d=0:d>o.width&&(d=o.width),this.el_.style.right="-"+d+"px",this.write(s)}},i.write=function(t){ar(this.el_,t)},i.updateTime=function(t,n,s,o){var u=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var l,c=u.player_.duration();if(u.player_.liveTracker&&u.player_.liveTracker.isLive()){var f=u.player_.liveTracker.liveWindow(),d=f-n*f;l=(d<1?"":"-")+mr(d,f)}else l=mr(s,c);u.update(t,n,l),o&&o()})},r}(L);L.registerComponent("TimeTooltip",Zh);var xa=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.update=Ut(te(J(n),n.update),gt),n}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},i.update=function(t,n){var s=this.getChild("timeTooltip");if(s){var o=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();s.updateTime(t,n,o)}},r}(L);xa.prototype.options_={children:[]},!tt&&!It&&xa.prototype.options_.children.push("timeTooltip"),L.registerComponent("PlayProgressBar",xa);var lu=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.update=Ut(te(J(n),n.update),gt),n}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},i.update=function(t,n){var s=this,o=n*this.player_.duration();this.getChild("timeTooltip").updateTime(t,n,o,function(){s.el_.style.left=t.width*n+"px"})},r}(L);lu.prototype.options_={children:["timeTooltip"]},L.registerComponent("MouseTimeDisplay",lu);var Vi=5,cu=12,Sa=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.setEventHandlers_(),n}var i=r.prototype;return i.setEventHandlers_=function(){this.update_=te(this,this.update),this.update=Ut(this.update_,gt),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in N&&"visibilityState"in N&&this.on(N,"visibilitychange",this.toggleVisibility_)},i.toggleVisibility_=function(t){N.hidden?this.disableInterval_(t):(this.enableInterval_(),this.update())},i.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,gt))},i.disableInterval_=function(t){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&t&&t.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},i.update=function(t){var n=this,s=a.prototype.update.call(this);return this.requestAnimationFrame(function(){var o=n.player_.ended()?n.player_.duration():n.getCurrentTime_(),u=n.player_.liveTracker,l=n.player_.duration();u&&u.isLive()&&(l=n.player_.liveTracker.liveCurrentTime()),n.percent_!==s&&(n.el_.setAttribute("aria-valuenow",(s*100).toFixed(2)),n.percent_=s),(n.currentTime_!==o||n.duration_!==l)&&(n.el_.setAttribute("aria-valuetext",n.localize("progress bar timing: currentTime={1} duration={2}",[mr(o,l),mr(l,l)],"{1} of {2}")),n.currentTime_=o,n.duration_=l),n.bar&&n.bar.update(Gr(n.el()),n.getProgress())}),s},i.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},i.getPercent=function(){var t=this.getCurrentTime_(),n,s=this.player_.liveTracker;return s&&s.isLive()?(n=(t-s.seekableStart())/s.liveWindow(),s.atLiveEdge()&&(n=1)):n=t/this.player_.duration(),n},i.handleMouseDown=function(t){sr(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),a.prototype.handleMouseDown.call(this,t))},i.handleMouseMove=function(t){if(sr(t)){var n,s=this.calculateDistance(t),o=this.player_.liveTracker;if(!o||!o.isLive())n=s*this.player_.duration(),n===this.player_.duration()&&(n=n-.1);else{if(s>=.99){o.seekToLiveEdge();return}var u=o.seekableStart(),l=o.liveCurrentTime();if(n=u+s*o.liveWindow(),n>=l&&(n=l),n<=u&&(n=u+.1),n===1/0)return}this.player_.currentTime(n)}},i.enable=function(){a.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},i.disable=function(){a.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},i.handleMouseUp=function(t){a.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Vt(this.player_.play()):this.update_()},i.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+Vi)},i.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-Vi)},i.handleAction=function(t){this.player_.paused()?this.player_.play():this.player_.pause()},i.handleKeyDown=function(t){if(Y.isEventKey(t,"Space")||Y.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(Y.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(Y.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(Y(t))){t.preventDefault(),t.stopPropagation();var n=(Y.codes[Y(t)]-Y.codes[0])*10/100;this.player_.currentTime(this.player_.duration()*n)}else Y.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-Vi*cu)):Y.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+Vi*cu)):a.prototype.handleKeyDown.call(this,t)},i.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableInterval_),this.off(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in N&&"visibilityState"in N&&this.off(N,"visibilitychange",this.toggleVisibility_),a.prototype.dispose.call(this)},r}(Ta);Sa.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},!tt&&!It&&Sa.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),L.registerComponent("SeekBar",Sa);var fu=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.handleMouseMove=Ut(te(J(n),n.handleMouseMove),gt),n.throttledHandleMouseSeek=Ut(te(J(n),n.handleMouseSeek),gt),n.enable(),n}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},i.handleMouseMove=function(t){var n=this.getChild("seekBar");if(n){var s=n.getChild("playProgressBar"),o=n.getChild("mouseTimeDisplay");if(!(!s&&!o)){var u=n.el(),l=Gr(u),c=Mn(u,t).x;c=ya(0,1,c),o&&o.update(l,c),s&&s.update(l,n.getProgress())}}},i.handleMouseSeek=function(t){var n=this.getChild("seekBar");n&&n.handleMouseMove(t)},i.enabled=function(){return this.enabled_},i.disable=function(){this.children().forEach(function(t){return t.disable&&t.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},i.enable=function(){this.children().forEach(function(t){return t.enable&&t.enable()}),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},i.handleMouseDown=function(t){var n=this.el_.ownerDocument,s=this.getChild("seekBar");s&&s.handleMouseDown(t),this.on(n,"mousemove",this.throttledHandleMouseSeek),this.on(n,"touchmove",this.throttledHandleMouseSeek),this.on(n,"mouseup",this.handleMouseUp),this.on(n,"touchend",this.handleMouseUp)},i.handleMouseUp=function(t){var n=this.el_.ownerDocument,s=this.getChild("seekBar");s&&s.handleMouseUp(t),this.off(n,"mousemove",this.throttledHandleMouseSeek),this.off(n,"touchmove",this.throttledHandleMouseSeek),this.off(n,"mouseup",this.handleMouseUp),this.off(n,"touchend",this.handleMouseUp)},r}(L);fu.prototype.options_={children:["seekBar"]},L.registerComponent("ProgressControl",fu);var hu=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.on(e,["enterpictureinpicture","leavepictureinpicture"],n.handlePictureInPictureChange),N.pictureInPictureEnabled||n.disable(),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-picture-in-picture-control "+a.prototype.buildCSSClass.call(this)},i.handlePictureInPictureChange=function(t){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},i.handleClick=function(t){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},r}(rt);hu.prototype.controlText_="Picture-in-Picture",L.registerComponent("PictureInPictureToggle",hu);var du=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.on(e,"fullscreenchange",n.handleFullscreenChange),N[e.fsApi_.fullscreenEnabled]===!1&&n.disable(),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-fullscreen-control "+a.prototype.buildCSSClass.call(this)},i.handleFullscreenChange=function(t){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},i.handleClick=function(t){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},r}(rt);du.prototype.controlText_="Fullscreen",L.registerComponent("FullscreenToggle",du);var ed=function(r,i){i.tech_&&!i.tech_.featuresVolumeControl&&r.addClass("vjs-hidden"),r.on(i,"loadstart",function(){i.tech_.featuresVolumeControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")})},td=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},r}(L);L.registerComponent("VolumeLevel",td);var Ea=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.on("slideractive",n.updateLastVolume_),n.on(e,"volumechange",n.updateARIAAttributes),e.ready(function(){return n.updateARIAAttributes()}),n}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},i.handleMouseDown=function(t){sr(t)&&a.prototype.handleMouseDown.call(this,t)},i.handleMouseMove=function(t){sr(t)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(t)))},i.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},i.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},i.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},i.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},i.updateARIAAttributes=function(t){var n=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",n),this.el_.setAttribute("aria-valuetext",n+"%")},i.volumeAsPercentage_=function(){return Math.round(this.player_.volume()*100)},i.updateLastVolume_=function(){var t=this,n=this.player_.volume();this.one("sliderinactive",function(){t.player_.volume()===0&&t.player_.lastVolume_(n)})},r}(Ta);Ea.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Ea.prototype.playerEvent="volumechange",L.registerComponent("VolumeBar",Ea);var pu=function(a){H(r,a);function r(e,t){var n;return t===void 0&&(t={}),t.vertical=t.vertical||!1,(typeof t.volumeBar>"u"||Vr(t.volumeBar))&&(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),n=a.call(this,e,t)||this,ed(J(n),e),n.throttledHandleMouseMove=Ut(te(J(n),n.handleMouseMove),gt),n.on("mousedown",n.handleMouseDown),n.on("touchstart",n.handleMouseDown),n.on(n.volumeBar,["focus","slideractive"],function(){n.volumeBar.addClass("vjs-slider-active"),n.addClass("vjs-slider-active"),n.trigger("slideractive")}),n.on(n.volumeBar,["blur","sliderinactive"],function(){n.volumeBar.removeClass("vjs-slider-active"),n.removeClass("vjs-slider-active"),n.trigger("sliderinactive")}),n}var i=r.prototype;return i.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),a.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},i.handleMouseDown=function(t){var n=this.el_.ownerDocument;this.on(n,"mousemove",this.throttledHandleMouseMove),this.on(n,"touchmove",this.throttledHandleMouseMove),this.on(n,"mouseup",this.handleMouseUp),this.on(n,"touchend",this.handleMouseUp)},i.handleMouseUp=function(t){var n=this.el_.ownerDocument;this.off(n,"mousemove",this.throttledHandleMouseMove),this.off(n,"touchmove",this.throttledHandleMouseMove),this.off(n,"mouseup",this.handleMouseUp),this.off(n,"touchend",this.handleMouseUp)},i.handleMouseMove=function(t){this.volumeBar.handleMouseMove(t)},r}(L);pu.prototype.options_={children:["volumeBar"]},L.registerComponent("VolumeControl",pu);var rd=function(r,i){i.tech_&&!i.tech_.featuresMuteControl&&r.addClass("vjs-hidden"),r.on(i,"loadstart",function(){i.tech_.featuresMuteControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")})},mu=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,rd(J(n),e),n.on(e,["loadstart","volumechange"],n.update),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-mute-control "+a.prototype.buildCSSClass.call(this)},i.handleClick=function(t){var n=this.player_.volume(),s=this.player_.lastVolume_();if(n===0){var o=s<.1?.1:s;this.player_.volume(o),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},i.update=function(t){this.updateIcon_(),this.updateControlText_()},i.updateIcon_=function(){var t=this.player_.volume(),n=3;tt&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),t===0||this.player_.muted()?n=0:t<.33?n=1:t<.67&&(n=2);for(var s=0;s<4;s++)Hr(this.el_,"vjs-vol-"+s);mt(this.el_,"vjs-vol-"+n)},i.updateControlText_=function(){var t=this.player_.muted()||this.player_.volume()===0,n=t?"Unmute":"Mute";this.controlText()!==n&&this.controlText(n)},r}(rt);mu.prototype.controlText_="Mute",L.registerComponent("MuteToggle",mu);var vu=function(a){H(r,a);function r(e,t){var n;return t===void 0&&(t={}),typeof t.inline<"u"?t.inline=t.inline:t.inline=!0,(typeof t.volumeControl>"u"||Vr(t.volumeControl))&&(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),n=a.call(this,e,t)||this,n.on(e,["loadstart"],n.volumePanelState_),n.on(n.muteToggle,"keyup",n.handleKeyPress),n.on(n.volumeControl,"keyup",n.handleVolumeControlKeyUp),n.on("keydown",n.handleKeyPress),n.on("mouseover",n.handleMouseOver),n.on("mouseout",n.handleMouseOut),n.on(n.volumeControl,["slideractive"],n.sliderActive_),n.on(n.volumeControl,["sliderinactive"],n.sliderInactive_),n}var i=r.prototype;return i.sliderActive_=function(){this.addClass("vjs-slider-active")},i.sliderInactive_=function(){this.removeClass("vjs-slider-active")},i.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},i.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),a.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},i.dispose=function(){this.handleMouseOut(),a.prototype.dispose.call(this)},i.handleVolumeControlKeyUp=function(t){Y.isEventKey(t,"Esc")&&this.muteToggle.focus()},i.handleMouseOver=function(t){this.addClass("vjs-hover"),He(N,"keyup",te(this,this.handleKeyPress))},i.handleMouseOut=function(t){this.removeClass("vjs-hover"),Ce(N,"keyup",te(this,this.handleKeyPress))},i.handleKeyPress=function(t){Y.isEventKey(t,"Esc")&&this.handleMouseOut()},r}(L);vu.prototype.options_={children:["muteToggle","volumeControl"]},L.registerComponent("VolumePanel",vu);var Ca=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,t&&(n.menuButton_=t.menuButton),n.focusedChild_=-1,n.on("keydown",n.handleKeyDown),n.boundHandleBlur_=te(J(n),n.handleBlur),n.boundHandleTapClick_=te(J(n),n.handleTapClick),n}var i=r.prototype;return i.addEventListenerForItem=function(t){t instanceof L&&(this.on(t,"blur",this.boundHandleBlur_),this.on(t,["tap","click"],this.boundHandleTapClick_))},i.removeEventListenerForItem=function(t){t instanceof L&&(this.off(t,"blur",this.boundHandleBlur_),this.off(t,["tap","click"],this.boundHandleTapClick_))},i.removeChild=function(t){typeof t=="string"&&(t=this.getChild(t)),this.removeEventListenerForItem(t),a.prototype.removeChild.call(this,t)},i.addItem=function(t){var n=this.addChild(t);n&&this.addEventListenerForItem(n)},i.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=de(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=a.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),He(n,"click",function(s){s.preventDefault(),s.stopImmediatePropagation()}),n},i.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,a.prototype.dispose.call(this)},i.handleBlur=function(t){var n=t.relatedTarget||N.activeElement;if(!this.children().some(function(o){return o.el()===n})){var s=this.menuButton_;s&&s.buttonPressed_&&n!==s.el().firstChild&&s.unpressButton()}},i.handleTapClick=function(t){if(this.menuButton_){this.menuButton_.unpressButton();var n=this.children();if(!Array.isArray(n))return;var s=n.filter(function(o){return o.el()===t.target})[0];if(!s)return;s.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}},i.handleKeyDown=function(t){Y.isEventKey(t,"Left")||Y.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):(Y.isEventKey(t,"Right")||Y.isEventKey(t,"Up"))&&(t.preventDefault(),t.stopPropagation(),this.stepBack())},i.stepForward=function(){var t=0;this.focusedChild_!==void 0&&(t=this.focusedChild_+1),this.focus(t)},i.stepBack=function(){var t=0;this.focusedChild_!==void 0&&(t=this.focusedChild_-1),this.focus(t)},i.focus=function(t){t===void 0&&(t=0);var n=this.children().slice(),s=n.length&&n[0].className&&/vjs-menu-title/.test(n[0].className);s&&n.shift(),n.length>0&&(t<0?t=0:t>=n.length&&(t=n.length-1),this.focusedChild_=t,n[t].el_.focus())},r}(L);L.registerComponent("Menu",Ca);var ka=function(a){H(r,a);function r(e,t){var n;t===void 0&&(t={}),n=a.call(this,e,t)||this,n.menuButton_=new rt(e,t),n.menuButton_.controlText(n.controlText_),n.menuButton_.el_.setAttribute("aria-haspopup","true");var s=rt.prototype.buildCSSClass();return n.menuButton_.el_.className=n.buildCSSClass()+" "+s,n.menuButton_.removeClass("vjs-control"),n.addChild(n.menuButton_),n.update(),n.enabled_=!0,n.on(n.menuButton_,"tap",n.handleClick),n.on(n.menuButton_,"click",n.handleClick),n.on(n.menuButton_,"keydown",n.handleKeyDown),n.on(n.menuButton_,"mouseenter",function(){n.addClass("vjs-hover"),n.menu.show(),He(N,"keyup",te(J(n),n.handleMenuKeyUp))}),n.on("mouseleave",n.handleMouseLeave),n.on("keydown",n.handleSubmenuKeyDown),n}var i=r.prototype;return i.update=function(){var t=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=t,this.addChild(t),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},i.createMenu=function(){var t=new Ca(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var n=de("li",{className:"vjs-menu-title",innerHTML:ge(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var s=new L(this.player_,{el:n});t.addItem(s)}if(this.items=this.createItems(),this.items)for(var o=0;o<this.items.length;o++)t.addItem(this.items[o]);return t},i.createItems=function(){},i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},i.buildWrapperCSSClass=function(){var t="vjs-menu-button";this.options_.inline===!0?t+="-inline":t+="-popup";var n=rt.prototype.buildCSSClass();return"vjs-menu-button "+t+" "+n+" "+a.prototype.buildCSSClass.call(this)},i.buildCSSClass=function(){var t="vjs-menu-button";return this.options_.inline===!0?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+a.prototype.buildCSSClass.call(this)},i.controlText=function(t,n){return n===void 0&&(n=this.menuButton_.el()),this.menuButton_.controlText(t,n)},i.dispose=function(){this.handleMouseLeave(),a.prototype.dispose.call(this)},i.handleClick=function(t){this.buttonPressed_?this.unpressButton():this.pressButton()},i.handleMouseLeave=function(t){this.removeClass("vjs-hover"),Ce(N,"keyup",te(this,this.handleMenuKeyUp))},i.focus=function(){this.menuButton_.focus()},i.blur=function(){this.menuButton_.blur()},i.handleKeyDown=function(t){Y.isEventKey(t,"Esc")||Y.isEventKey(t,"Tab")?(this.buttonPressed_&&this.unpressButton(),Y.isEventKey(t,"Tab")||(t.preventDefault(),this.menuButton_.focus())):(Y.isEventKey(t,"Up")||Y.isEventKey(t,"Down"))&&(this.buttonPressed_||(t.preventDefault(),this.pressButton()))},i.handleMenuKeyUp=function(t){(Y.isEventKey(t,"Esc")||Y.isEventKey(t,"Tab"))&&this.removeClass("vjs-hover")},i.handleSubmenuKeyPress=function(t){this.handleSubmenuKeyDown(t)},i.handleSubmenuKeyDown=function(t){(Y.isEventKey(t,"Esc")||Y.isEventKey(t,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),Y.isEventKey(t,"Tab")||(t.preventDefault(),this.menuButton_.focus()))},i.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),tt&&no())return;this.menu.focus()}},i.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},i.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},i.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},r}(L);L.registerComponent("MenuButton",ka);var Aa=function(a){H(r,a);function r(i,e){var t,n=e.tracks;if(t=a.call(this,i,e)||this,t.items.length<=1&&t.hide(),!n)return J(t);var s=te(J(t),t.update);return n.addEventListener("removetrack",s),n.addEventListener("addtrack",s),t.player_.on("ready",s),t.player_.on("dispose",function(){n.removeEventListener("removetrack",s),n.removeEventListener("addtrack",s)}),t}return r}(ka);L.registerComponent("TrackButton",Aa);var id=["Tab","Esc","Up","Down","Right","Left"],ti=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.selectable=t.selectable,n.isSelected_=t.selected||!1,n.multiSelectable=t.multiSelectable,n.selected(n.isSelected_),n.selectable?n.multiSelectable?n.el_.setAttribute("role","menuitemcheckbox"):n.el_.setAttribute("role","menuitemradio"):n.el_.setAttribute("role","menuitem"),n}var i=r.prototype;return i.createEl=function(t,n,s){return this.nonIconControl=!0,a.prototype.createEl.call(this,"li",he({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),s)},i.handleKeyDown=function(t){id.some(function(n){return Y.isEventKey(t,n)})||a.prototype.handleKeyDown.call(this,t)},i.handleClick=function(t){this.selected(!0)},i.selected=function(t){this.selectable&&(t?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},r}(ji);L.registerComponent("MenuItem",ti);var ri=function(a){H(r,a);function r(e,t){var n,s=t.track,o=e.textTracks();t.label=s.label||s.language||"Unknown",t.selected=s.mode==="showing",n=a.call(this,e,t)||this,n.track=s,n.kinds=(t.kinds||[t.kind||n.track.kind]).filter(Boolean);var u=function(){for(var d=arguments.length,m=new Array(d),_=0;_<d;_++)m[_]=arguments[_];n.handleTracksChange.apply(J(n),m)},l=function(){for(var d=arguments.length,m=new Array(d),_=0;_<d;_++)m[_]=arguments[_];n.handleSelectedLanguageChange.apply(J(n),m)};if(e.on(["loadstart","texttrackchange"],u),o.addEventListener("change",u),o.addEventListener("selectedlanguagechange",l),n.on("dispose",function(){e.off(["loadstart","texttrackchange"],u),o.removeEventListener("change",u),o.removeEventListener("selectedlanguagechange",l)}),o.onchange===void 0){var c;n.on(["tap","click"],function(){if(typeof S.Event!="object")try{c=new S.Event("change")}catch{}c||(c=N.createEvent("Event"),c.initEvent("change",!0,!0)),o.dispatchEvent(c)})}return n.handleTracksChange(),n}var i=r.prototype;return i.handleClick=function(t){var n=this.track,s=this.player_.textTracks();if(a.prototype.handleClick.call(this,t),!!s)for(var o=0;o<s.length;o++){var u=s[o];this.kinds.indexOf(u.kind)!==-1&&(u===n?u.mode!=="showing"&&(u.mode="showing"):u.mode!=="disabled"&&(u.mode="disabled"))}},i.handleTracksChange=function(t){var n=this.track.mode==="showing";n!==this.isSelected_&&this.selected(n)},i.handleSelectedLanguageChange=function(t){if(this.track.mode==="showing"){var n=this.player_.cache_.selectedLanguage;if(n&&n.enabled&&n.language===this.track.language&&n.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},i.dispose=function(){this.track=null,a.prototype.dispose.call(this)},r}(ti);L.registerComponent("TextTrackMenuItem",ri);var gu=function(a){H(r,a);function r(e,t){return t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,a.call(this,e,t)||this}var i=r.prototype;return i.handleTracksChange=function(t){for(var n=this.player().textTracks(),s=!0,o=0,u=n.length;o<u;o++){var l=n[o];if(this.options_.kinds.indexOf(l.kind)>-1&&l.mode==="showing"){s=!1;break}}s!==this.isSelected_&&this.selected(s)},i.handleSelectedLanguageChange=function(t){for(var n=this.player().textTracks(),s=!0,o=0,u=n.length;o<u;o++){var l=n[o];if(["captions","descriptions","subtitles"].indexOf(l.kind)>-1&&l.mode==="showing"){s=!1;break}}s&&(this.player_.cache_.selectedLanguage={enabled:!1})},r}(ri);L.registerComponent("OffTextTrackMenuItem",gu);var gr=function(a){H(r,a);function r(e,t){return t===void 0&&(t={}),t.tracks=e.textTracks(),a.call(this,e,t)||this}var i=r.prototype;return i.createItems=function(t,n){t===void 0&&(t=[]),n===void 0&&(n=ri);var s;this.label_&&(s=this.label_+" off"),t.push(new gu(this.player_,{kinds:this.kinds_,kind:this.kind_,label:s})),this.hideThreshold_+=1;var o=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var u=0;u<o.length;u++){var l=o[u];if(this.kinds_.indexOf(l.kind)>-1){var c=new n(this.player_,{track:l,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});c.addClass("vjs-"+l.kind+"-menu-item"),t.push(c)}}return t},r}(Aa);L.registerComponent("TextTrackButton",gr);var _u=function(a){H(r,a);function r(e,t){var n,s=t.track,o=t.cue,u=e.currentTime();return t.selectable=!0,t.multiSelectable=!1,t.label=o.text,t.selected=o.startTime<=u&&u<o.endTime,n=a.call(this,e,t)||this,n.track=s,n.cue=o,s.addEventListener("cuechange",te(J(n),n.update)),n}var i=r.prototype;return i.handleClick=function(t){a.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},i.update=function(t){var n=this.cue,s=this.player_.currentTime();this.selected(n.startTime<=s&&s<n.endTime)},r}(ti);L.registerComponent("ChaptersTrackMenuItem",_u);var Pa=function(a){H(r,a);function r(e,t,n){return a.call(this,e,t,n)||this}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-chapters-button "+a.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-chapters-button "+a.prototype.buildWrapperCSSClass.call(this)},i.update=function(t){(!this.track_||t&&(t.type==="addtrack"||t.type==="removetrack"))&&this.setTrack(this.findChaptersTrack()),a.prototype.update.call(this)},i.setTrack=function(t){if(this.track_!==t){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=t,this.track_){this.track_.mode="hidden";var s=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);s&&s.addEventListener("load",this.updateHandler_)}}},i.findChaptersTrack=function(){for(var t=this.player_.textTracks()||[],n=t.length-1;n>=0;n--){var s=t[n];if(s.kind===this.kind_)return s}},i.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(ge(this.kind_))},i.createMenu=function(){return this.options_.title=this.getMenuCaption(),a.prototype.createMenu.call(this)},i.createItems=function(){var t=[];if(!this.track_)return t;var n=this.track_.cues;if(!n)return t;for(var s=0,o=n.length;s<o;s++){var u=n[s],l=new _u(this.player_,{track:this.track_,cue:u});t.push(l)}return t},r}(gr);Pa.prototype.kind_="chapters",Pa.prototype.controlText_="Chapters",L.registerComponent("ChaptersButton",Pa);var Ia=function(a){H(r,a);function r(e,t,n){var s;s=a.call(this,e,t,n)||this;var o=e.textTracks(),u=te(J(s),s.handleTracksChange);return o.addEventListener("change",u),s.on("dispose",function(){o.removeEventListener("change",u)}),s}var i=r.prototype;return i.handleTracksChange=function(t){for(var n=this.player().textTracks(),s=!1,o=0,u=n.length;o<u;o++){var l=n[o];if(l.kind!==this.kind_&&l.mode==="showing"){s=!0;break}}s?this.disable():this.enable()},i.buildCSSClass=function(){return"vjs-descriptions-button "+a.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+a.prototype.buildWrapperCSSClass.call(this)},r}(gr);Ia.prototype.kind_="descriptions",Ia.prototype.controlText_="Descriptions",L.registerComponent("DescriptionsButton",Ia);var Da=function(a){H(r,a);function r(e,t,n){return a.call(this,e,t,n)||this}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-subtitles-button "+a.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+a.prototype.buildWrapperCSSClass.call(this)},r}(gr);Da.prototype.kind_="subtitles",Da.prototype.controlText_="Subtitles",L.registerComponent("SubtitlesButton",Da);var wa=function(a){H(r,a);function r(e,t){var n;return t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",n=a.call(this,e,t)||this,n.addClass("vjs-texttrack-settings"),n.controlText(", opens "+t.kind+" settings dialog"),n}var i=r.prototype;return i.handleClick=function(t){this.player().getChild("textTrackSettings").open()},r}(ri);L.registerComponent("CaptionSettingsMenuItem",wa);var Oa=function(a){H(r,a);function r(e,t,n){return a.call(this,e,t,n)||this}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-captions-button "+a.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-captions-button "+a.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(t.push(new wa(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),a.prototype.createItems.call(this,t)},r}(gr);Oa.prototype.kind_="captions",Oa.prototype.controlText_="Captions",L.registerComponent("CaptionsButton",Oa);var yu=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.createEl=function(t,n,s){var o='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);this.options_.track.kind==="captions"&&(o+=`
        <span aria-hidden="true" class="vjs-icon-placeholder"></span>
        <span class="vjs-control-text"> `+this.localize("Captions")+`</span>
      `),o+="</span>";var u=a.prototype.createEl.call(this,t,he({innerHTML:o},n),s);return u},r}(ri);L.registerComponent("SubsCapsMenuItem",yu);var La=function(a){H(r,a);function r(e,t){var n;return t===void 0&&(t={}),n=a.call(this,e,t)||this,n.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(n.player_.language_)>-1&&(n.label_="captions"),n.menuButton_.controlText(ge(n.label_)),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-subs-caps-button "+a.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+a.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(t.push(new wa(this.player_,{kind:this.label_})),this.hideThreshold_+=1),t=a.prototype.createItems.call(this,t,yu),t},r}(gr);La.prototype.kinds_=["captions","subtitles"],La.prototype.controlText_="Subtitles",L.registerComponent("SubsCapsButton",La);var Tu=function(a){H(r,a);function r(e,t){var n,s=t.track,o=e.audioTracks();t.label=s.label||s.language||"Unknown",t.selected=s.enabled,n=a.call(this,e,t)||this,n.track=s,n.addClass("vjs-"+s.kind+"-menu-item");var u=function(){for(var c=arguments.length,f=new Array(c),d=0;d<c;d++)f[d]=arguments[d];n.handleTracksChange.apply(J(n),f)};return o.addEventListener("change",u),n.on("dispose",function(){o.removeEventListener("change",u)}),n}var i=r.prototype;return i.createEl=function(t,n,s){var o='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);this.options_.track.kind==="main-desc"&&(o+=`
        <span aria-hidden="true" class="vjs-icon-placeholder"></span>
        <span class="vjs-control-text"> `+this.localize("Descriptions")+`</span>
      `),o+="</span>";var u=a.prototype.createEl.call(this,t,he({innerHTML:o},n),s);return u},i.handleClick=function(t){var n=this.player_.audioTracks();a.prototype.handleClick.call(this,t);for(var s=0;s<n.length;s++){var o=n[s];o.enabled=o===this.track}},i.handleTracksChange=function(t){this.selected(this.track.enabled)},r}(ti);L.registerComponent("AudioTrackMenuItem",Tu);var bu=function(a){H(r,a);function r(e,t){return t===void 0&&(t={}),t.tracks=e.audioTracks(),a.call(this,e,t)||this}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-audio-button "+a.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-audio-button "+a.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(t){t===void 0&&(t=[]),this.hideThreshold_=1;for(var n=this.player_.audioTracks(),s=0;s<n.length;s++){var o=n[s];t.push(new Tu(this.player_,{track:o,selectable:!0,multiSelectable:!1}))}return t},r}(Aa);bu.prototype.controlText_="Audio Track",L.registerComponent("AudioTrackButton",bu);var Ra=function(a){H(r,a);function r(e,t){var n,s=t.rate,o=parseFloat(s,10);return t.label=s,t.selected=o===1,t.selectable=!0,t.multiSelectable=!1,n=a.call(this,e,t)||this,n.label=s,n.rate=o,n.on(e,"ratechange",n.update),n}var i=r.prototype;return i.handleClick=function(t){a.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},i.update=function(t){this.selected(this.player().playbackRate()===this.rate)},r}(ti);Ra.prototype.contentElType="button",L.registerComponent("PlaybackRateMenuItem",Ra);var xu=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.updateVisibility(),n.updateLabel(),n.on(e,"loadstart",n.updateVisibility),n.on(e,"ratechange",n.updateLabel),n}var i=r.prototype;return i.createEl=function(){var t=a.prototype.createEl.call(this);return this.labelEl_=de("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},i.dispose=function(){this.labelEl_=null,a.prototype.dispose.call(this)},i.buildCSSClass=function(){return"vjs-playback-rate "+a.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-playback-rate "+a.prototype.buildWrapperCSSClass.call(this)},i.createMenu=function(){var t=new Ca(this.player()),n=this.playbackRates();if(n)for(var s=n.length-1;s>=0;s--)t.addChild(new Ra(this.player(),{rate:n[s]+"x"}));return t},i.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},i.handleClick=function(t){for(var n=this.player().playbackRate(),s=this.playbackRates(),o=s[0],u=0;u<s.length;u++)if(s[u]>n){o=s[u];break}this.player().playbackRate(o)},i.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},i.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},i.updateVisibility=function(t){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},i.updateLabel=function(t){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},r}(ka);xu.prototype.controlText_="Playback Rate",L.registerComponent("PlaybackRateMenuButton",xu);var Su=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-spacer "+a.prototype.buildCSSClass.call(this)},i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},r}(L);L.registerComponent("Spacer",Su);var nd=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-custom-control-spacer "+a.prototype.buildCSSClass.call(this)},i.createEl=function(){var t=a.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="\xA0",t},r}(Su);L.registerComponent("CustomControlSpacer",nd);var Hi=function(a){H(r,a);function r(){return a.apply(this,arguments)||this}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},r}(L);Hi.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in N&&Hi.prototype.options_.children.splice(Hi.prototype.options_.children.length-1,0,"pictureInPictureToggle"),L.registerComponent("ControlBar",Hi);var Eu=function(a){H(r,a);function r(e,t){var n;return n=a.call(this,e,t)||this,n.on(e,"error",n.open),n}var i=r.prototype;return i.buildCSSClass=function(){return"vjs-error-display "+a.prototype.buildCSSClass.call(this)},i.content=function(){var t=this.player().error();return t?this.localize(t.message):""},r}(cr);Eu.prototype.options_=Ci({},cr.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),L.registerComponent("ErrorDisplay",Eu);var Na="vjs-text-track-settings",Cu=["#000","Black"],ku=["#00F","Blue"],Au=["#0FF","Cyan"],Pu=["#0F0","Green"],Iu=["#F0F","Magenta"],Du=["#F00","Red"],wu=["#FFF","White"],Ou=["#FF0","Yellow"],Ma=["1","Opaque"],Ua=["0.5","Semi-Transparent"],Lu=["0","Transparent"],Gt={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Cu,wu,Du,Pu,ku,Ou,Iu,Au]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Ma,Ua,Lu]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[wu,Cu,Du,Pu,ku,Ou,Iu,Au]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(r){return r==="1.00"?null:Number(r)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Ma,Ua]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Lu,Ua,Ma]}};Gt.windowColor.options=Gt.backgroundColor.options;function Ru(a,r){if(r&&(a=r(a)),a&&a!=="none")return a}function ad(a,r){var i=a.options[a.options.selectedIndex].value;return Ru(i,r)}function sd(a,r,i){if(r){for(var e=0;e<a.options.length;e++)if(Ru(a.options[e].value,i)===r){a.selectedIndex=e;break}}}var od=function(a){H(r,a);function r(e,t){var n;return t.temporary=!1,n=a.call(this,e,t)||this,n.updateDisplay=te(J(n),n.updateDisplay),n.fill(),n.hasBeenOpened_=n.hasBeenFilled_=!0,n.endDialog=de("p",{className:"vjs-control-text",textContent:n.localize("End of dialog window.")}),n.el().appendChild(n.endDialog),n.setDefaults(),t.persistTextTrackSettings===void 0&&(n.options_.persistTextTrackSettings=n.options_.playerOptions.persistTextTrackSettings),n.on(n.$(".vjs-done-button"),"click",function(){n.saveSettings(),n.close()}),n.on(n.$(".vjs-default-button"),"click",function(){n.setDefaults(),n.updateDisplay()}),rr(Gt,function(s){n.on(n.$(s.selector),"change",n.updateDisplay)}),n.options_.persistTextTrackSettings&&n.restoreSettings(),n}var i=r.prototype;return i.dispose=function(){this.endDialog=null,a.prototype.dispose.call(this)},i.createElSelect_=function(t,n,s){var o=this;n===void 0&&(n=""),s===void 0&&(s="label");var u=Gt[t],l=u.id.replace("%s",this.id_),c=[n,l].join(" ").trim();return["<"+s+' id="'+l+'" class="'+(s==="label"?"vjs-label":"")+'">',this.localize(u.label),"</"+s+">",'<select aria-labelledby="'+c+'">'].concat(u.options.map(function(f){var d=l+"-"+f[1].replace(/\W+/g,"");return['<option id="'+d+'" value="'+f[0]+'" ','aria-labelledby="'+c+" "+d+'">',o.localize(f[1]),"</option>"].join("")})).concat("</select>").join("")},i.createElFgColor_=function(){var t="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",t),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",t),"</span>","</fieldset>"].join("")},i.createElBgColor_=function(){var t="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",t),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",t),"</span>","</fieldset>"].join("")},i.createElWinColor_=function(){var t="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",t),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",t),"</span>","</fieldset>"].join("")},i.createElColors_=function(){return de("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},i.createElFont_=function(){return de("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},i.createElControls_=function(){var t=this.localize("restore all settings to the default values");return de("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+t+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+t+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},i.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},i.label=function(){return this.localize("Caption Settings Dialog")},i.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},i.buildCSSClass=function(){return a.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},i.getValues=function(){var t=this;return Tf(Gt,function(n,s,o){var u=ad(t.$(s.selector),s.parser);return u!==void 0&&(n[o]=u),n},{})},i.setValues=function(t){var n=this;rr(Gt,function(s,o){sd(n.$(s.selector),t[o],s.parser)})},i.setDefaults=function(){var t=this;rr(Gt,function(n){var s=n.hasOwnProperty("default")?n.default:0;t.$(n.selector).selectedIndex=s})},i.restoreSettings=function(){var t;try{t=JSON.parse(S.localStorage.getItem(Na))}catch(n){re.warn(n)}t&&this.setValues(t)},i.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?S.localStorage.setItem(Na,JSON.stringify(t)):S.localStorage.removeItem(Na)}catch(n){re.warn(n)}}},i.updateDisplay=function(){var t=this.player_.getChild("textTrackDisplay");t&&t.updateDisplay()},i.conditionalBlur_=function(){this.previouslyActiveEl_=null;var t=this.player_.controlBar,n=t&&t.subsCapsButton,s=t&&t.captionsButton;n?n.focus():s&&s.focus()},r}(cr);L.registerComponent("TextTrackSettings",od);var ud=function(a){H(r,a);function r(e,t){var n,s=t.ResizeObserver||S.ResizeObserver;t.ResizeObserver===null&&(s=!1);var o=fe({createEl:!s,reportTouchActivity:!1},t);return n=a.call(this,e,o)||this,n.ResizeObserver=t.ResizeObserver||S.ResizeObserver,n.loadListener_=null,n.resizeObserver_=null,n.debouncedHandler_=Pf(function(){n.resizeHandler()},100,!1,J(n)),s?(n.resizeObserver_=new n.ResizeObserver(n.debouncedHandler_),n.resizeObserver_.observe(e.el())):(n.loadListener_=function(){if(!(!n.el_||!n.el_.contentWindow)){var u=n.debouncedHandler_,l=n.unloadListener_=function(){Ce(this,"resize",u),Ce(this,"unload",l),l=null};He(n.el_.contentWindow,"unload",l),He(n.el_.contentWindow,"resize",u)}},n.one("load",n.loadListener_)),n}var i=r.prototype;return i.createEl=function(){return a.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},i.resizeHandler=function(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")},i.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,a.prototype.dispose.call(this)},r}(L);L.registerComponent("ResizeManager",ud);var ld={trackingThreshold:30,liveTolerance:15},cd=function(a){H(r,a);function r(e,t){var n,s=fe(ld,t,{createEl:!1});return n=a.call(this,e,s)||this,n.reset_(),n.on(n.player_,"durationchange",n.handleDurationchange),Kr&&"hidden"in N&&"visibilityState"in N&&n.on(N,"visibilitychange",n.handleVisibilityChange),n}var i=r.prototype;return i.handleVisibilityChange=function(){this.player_.duration()===1/0&&(N.hidden?this.stopTracking():this.startTracking())},i.trackLive_=function(){var t=this.player_.seekable();if(!(!t||!t.length)){var n=Number(S.performance.now().toFixed(4)),s=this.lastTime_===-1?0:(n-this.lastTime_)/1e3;this.lastTime_=n,this.pastSeekEnd_=this.pastSeekEnd()+s;var o=this.liveCurrentTime(),u=this.player_.currentTime(),l=this.player_.paused()||this.seekedBehindLive_||Math.abs(o-u)>this.options_.liveTolerance;(!this.timeupdateSeen_||o===1/0)&&(l=!1),l!==this.behindLiveEdge_&&(this.behindLiveEdge_=l,this.trigger("liveedgechange"))}},i.handleDurationchange=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},i.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,gt),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLive_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked):(this.one(this.player_,"play",this.handlePlay),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate)))},i.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked)},i.handleSeeked=function(){var t=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.skipNextSeeked_?!1:t>2,this.skipNextSeeked_=!1,this.trackLive_()},i.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},i.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.skipNextSeeked_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLive_),this.off(this.player_,"seeked",this.handleSeeked),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate),this.off(this.player_,"timeupdate",this.seekToLiveEdge)},i.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},i.seekableEnd=function(){for(var t=this.player_.seekable(),n=[],s=t?t.length:0;s--;)n.push(t.end(s));return n.length?n.sort()[n.length-1]:1/0},i.seekableStart=function(){for(var t=this.player_.seekable(),n=[],s=t?t.length:0;s--;)n.push(t.start(s));return n.length?n.sort()[0]:0},i.liveWindow=function(){var t=this.liveCurrentTime();return t===1/0?1/0:t-this.seekableStart()},i.isLive=function(){return this.isTracking()},i.atLiveEdge=function(){return!this.behindLiveEdge()},i.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},i.pastSeekEnd=function(){var t=this.seekableEnd();return this.lastSeekEnd_!==-1&&t!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=t,this.pastSeekEnd_},i.behindLiveEdge=function(){return this.behindLiveEdge_},i.isTracking=function(){return typeof this.trackingInterval_=="number"},i.seekToLiveEdge=function(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.skipNextSeeked_=!0,this.player_.currentTime(this.liveCurrentTime()))},i.dispose=function(){this.off(N,"visibilitychange",this.handleVisibilityChange),this.stopTracking(),a.prototype.dispose.call(this)},r}(L);L.registerComponent("LiveTracker",cd);var Fa=function(r){var i=r.el();if(i.hasAttribute("src"))return r.triggerSourceset(i.src),!0;var e=r.$$("source"),t=[],n="";if(!e.length)return!1;for(var s=0;s<e.length;s++){var o=e[s].src;o&&t.indexOf(o)===-1&&t.push(o)}return t.length?(t.length===1&&(n=t[0]),r.triggerSourceset(n),!0):!1},fd=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(r){var i=N.createElement(this.nodeName.toLowerCase());i.innerHTML=r;for(var e=N.createDocumentFragment();i.childNodes.length;)e.appendChild(i.childNodes[0]);return this.innerText="",S.Element.prototype.appendChild.call(this,e),this.innerHTML}}),Nu=function(r,i){for(var e={},t=0;t<r.length&&(e=Object.getOwnPropertyDescriptor(r[t],i),!(e&&e.set&&e.get));t++);return e.enumerable=!0,e.configurable=!0,e},hd=function(r){return Nu([r.el(),S.HTMLMediaElement.prototype,S.Element.prototype,fd],"innerHTML")},Mu=function(r){var i=r.el();if(!i.resetSourceWatch_){var e={},t=hd(r),n=function(o){return function(){for(var u=arguments.length,l=new Array(u),c=0;c<u;c++)l[c]=arguments[c];var f=o.apply(i,l);return Fa(r),f}};["append","appendChild","insertAdjacentHTML"].forEach(function(s){i[s]&&(e[s]=i[s],i[s]=n(e[s]))}),Object.defineProperty(i,"innerHTML",fe(t,{set:n(t.set)})),i.resetSourceWatch_=function(){i.resetSourceWatch_=null,Object.keys(e).forEach(function(s){i[s]=e[s]}),Object.defineProperty(i,"innerHTML",t)},r.one("sourceset",i.resetSourceWatch_)}},dd=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Vo(S.Element.prototype.getAttribute.call(this,"src")):""},set:function(r){return S.Element.prototype.setAttribute.call(this,"src",r),r}}),pd=function(r){return Nu([r.el(),S.HTMLMediaElement.prototype,dd],"src")},md=function(r){if(r.featuresSourceset){var i=r.el();if(!i.resetSourceset_){var e=pd(r),t=i.setAttribute,n=i.load;Object.defineProperty(i,"src",fe(e,{set:function(o){var u=e.set.call(i,o);return r.triggerSourceset(i.src),u}})),i.setAttribute=function(s,o){var u=t.call(i,s,o);return/src/i.test(s)&&r.triggerSourceset(i.src),u},i.load=function(){var s=n.call(i);return Fa(r)||(r.triggerSourceset(""),Mu(r)),s},i.currentSrc?r.triggerSourceset(i.currentSrc):Fa(r)||Mu(r),i.resetSourceset_=function(){i.resetSourceset_=null,i.load=n,i.setAttribute=t,Object.defineProperty(i,"src",e),i.resetSourceWatch_&&i.resetSourceWatch_()}}}},Ba=function(r,i,e,t){t===void 0&&(t=!0);var n=function(u){return Object.defineProperty(r,i,{value:u,enumerable:!0,writable:!0})},s={configurable:!0,enumerable:!0,get:function(){var u=e();return n(u),u}};return t&&(s.set=n),Object.defineProperty(r,i,s)},W=function(a){H(r,a);function r(e,t){var n;n=a.call(this,e,t)||this;var s=e.source,o=!1;if(s&&(n.el_.currentSrc!==s.src||e.tag&&e.tag.initNetworkState_===3)?n.setSource(s):n.handleLateInit_(n.el_),e.enableSourceset&&n.setupSourcesetHandling_(),n.el_.hasChildNodes()){for(var u=n.el_.childNodes,l=u.length,c=[];l--;){var f=u[l],d=f.nodeName.toLowerCase();d==="track"&&(n.featuresNativeTextTracks?(n.remoteTextTrackEls().addTrackElement_(f),n.remoteTextTracks().addTrack(f.track),n.textTracks().addTrack(f.track),!o&&!n.el_.hasAttribute("crossorigin")&&Ni(f.src)&&(o=!0)):c.push(f))}for(var m=0;m<c.length;m++)n.el_.removeChild(c[m])}return n.proxyNativeTracks_(),n.featuresNativeTextTracks&&o&&re.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),n.restoreMetadataTracksInIOSNativePlayer_(),(ur||$n||Do)&&e.nativeControlsForTouch===!0&&n.setControls(!0),n.proxyWebkitFullscreen_(),n.triggerReady(),n}var i=r.prototype;return i.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),r.disposeMediaElement(this.el_),this.options_=null,a.prototype.dispose.call(this)},i.setupSourcesetHandling_=function(){md(this)},i.restoreMetadataTracksInIOSNativePlayer_=function(){var t=this.textTracks(),n,s=function(){n=[];for(var l=0;l<t.length;l++){var c=t[l];c.kind==="metadata"&&n.push({track:c,storedMode:c.mode})}};s(),t.addEventListener("change",s),this.on("dispose",function(){return t.removeEventListener("change",s)});var o=function u(){for(var l=0;l<n.length;l++){var c=n[l];c.track.mode==="disabled"&&c.track.mode!==c.storedMode&&(c.track.mode=c.storedMode)}t.removeEventListener("change",u)};this.on("webkitbeginfullscreen",function(){t.removeEventListener("change",s),t.removeEventListener("change",o),t.addEventListener("change",o)}),this.on("webkitendfullscreen",function(){t.removeEventListener("change",s),t.addEventListener("change",s),t.removeEventListener("change",o)})},i.overrideNative_=function(t,n){var s=this;if(n===this["featuresNative"+t+"Tracks"]){var o=t.toLowerCase();this[o+"TracksListeners_"]&&Object.keys(this[o+"TracksListeners_"]).forEach(function(u){var l=s.el()[o+"Tracks"];l.removeEventListener(u,s[o+"TracksListeners_"][u])}),this["featuresNative"+t+"Tracks"]=!n,this[o+"TracksListeners_"]=null,this.proxyNativeTracksForType_(o)}},i.overrideNativeAudioTracks=function(t){this.overrideNative_("Audio",t)},i.overrideNativeVideoTracks=function(t){this.overrideNative_("Video",t)},i.proxyNativeTracksForType_=function(t){var n=this,s=Ke[t],o=this.el()[s.getterName],u=this[s.getterName]();if(!(!this["featuresNative"+s.capitalName+"Tracks"]||!o||!o.addEventListener)){var l={change:function(d){var m={type:"change",target:u,currentTarget:u,srcElement:u};u.trigger(m),t==="text"&&n[dr.remoteText.getterName]().trigger(m)},addtrack:function(d){u.addTrack(d.track)},removetrack:function(d){u.removeTrack(d.track)}},c=function(){for(var d=[],m=0;m<u.length;m++){for(var _=!1,b=0;b<o.length;b++)if(o[b]===u[m]){_=!0;break}_||d.push(u[m])}for(;d.length;)u.removeTrack(d.shift())};this[s.getterName+"Listeners_"]=l,Object.keys(l).forEach(function(f){var d=l[f];o.addEventListener(f,d),n.on("dispose",function(m){return o.removeEventListener(f,d)})}),this.on("loadstart",c),this.on("dispose",function(f){return n.off("loadstart",c)})}},i.proxyNativeTracks_=function(){var t=this;Ke.names.forEach(function(n){t.proxyNativeTracksForType_(n)})},i.createEl=function(){var t=this.options_.tag;if(!t||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(t){var n=t.cloneNode(!0);t.parentNode&&t.parentNode.insertBefore(n,t),r.disposeMediaElement(t),t=n}else{t=N.createElement("video");var s=this.options_.tag&&vt(this.options_.tag),o=fe({},s);(!ur||this.options_.nativeControlsForTouch!==!0)&&delete o.controls,oo(t,he(o,{id:this.options_.techId,class:"vjs-tech"}))}t.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&Wr(t,"preload",this.options_.preload);for(var u=["loop","muted","playsinline","autoplay"],l=0;l<u.length;l++){var c=u[l],f=this.options_[c];typeof f<"u"&&(f?Wr(t,c,c):Ai(t,c),t[c]=f)}return t},i.handleLateInit_=function(t){if(!(t.networkState===0||t.networkState===3)){if(t.readyState===0){var n=!1,s=function(){n=!0};this.on("loadstart",s);var o=function(){n||this.trigger("loadstart")};this.on("loadedmetadata",o),this.ready(function(){this.off("loadstart",s),this.off("loadedmetadata",o),n||this.trigger("loadstart")});return}var u=["loadstart"];u.push("loadedmetadata"),t.readyState>=2&&u.push("loadeddata"),t.readyState>=3&&u.push("canplay"),t.readyState>=4&&u.push("canplaythrough"),this.ready(function(){u.forEach(function(l){this.trigger(l)},this)})}},i.setCurrentTime=function(t){try{this.el_.currentTime=t}catch(n){re(n,"Video is not ready. (Video.js)")}},i.duration=function(){var t=this;if(this.el_.duration===1/0&&It&&_t&&this.el_.currentTime===0){var n=function s(){t.el_.currentTime>0&&(t.el_.duration===1/0&&t.trigger("durationchange"),t.off("timeupdate",s))};return this.on("timeupdate",n),NaN}return this.el_.duration||NaN},i.width=function(){return this.el_.offsetWidth},i.height=function(){return this.el_.offsetHeight},i.proxyWebkitFullscreen_=function(){var t=this;if("webkitDisplayingFullscreen"in this.el_){var n=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},s=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",n),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",s),this.on("dispose",function(){t.off("webkitbeginfullscreen",s),t.off("webkitendfullscreen",n)})}},i.supportsFullScreen=function(){if(typeof this.el_.webkitEnterFullScreen=="function"){var t=S.navigator&&S.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},i.enterFullScreen=function(){var t=this.el_;if(t.paused&&t.networkState<=t.HAVE_METADATA)Vt(this.el_.play()),this.setTimeout(function(){t.pause();try{t.webkitEnterFullScreen()}catch(n){this.trigger("fullscreenerror",n)}},0);else try{t.webkitEnterFullScreen()}catch(n){this.trigger("fullscreenerror",n)}},i.exitFullScreen=function(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()},i.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},i.src=function(t){if(t===void 0)return this.el_.src;this.setSrc(t)},i.reset=function(){r.resetMediaElement(this.el_)},i.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},i.setControls=function(t){this.el_.controls=!!t},i.addTextTrack=function(t,n,s){return this.featuresNativeTextTracks?this.el_.addTextTrack(t,n,s):a.prototype.addTextTrack.call(this,t,n,s)},i.createRemoteTextTrack=function(t){if(!this.featuresNativeTextTracks)return a.prototype.createRemoteTextTrack.call(this,t);var n=N.createElement("track");return t.kind&&(n.kind=t.kind),t.label&&(n.label=t.label),(t.language||t.srclang)&&(n.srclang=t.language||t.srclang),t.default&&(n.default=t.default),t.id&&(n.id=t.id),t.src&&(n.src=t.src),n},i.addRemoteTextTrack=function(t,n){var s=a.prototype.addRemoteTextTrack.call(this,t,n);return this.featuresNativeTextTracks&&this.el().appendChild(s),s},i.removeRemoteTextTrack=function(t){if(a.prototype.removeRemoteTextTrack.call(this,t),this.featuresNativeTextTracks)for(var n=this.$$("track"),s=n.length;s--;)(t===n[s]||t===n[s].track)&&this.el().removeChild(n[s])},i.getVideoPlaybackQuality=function(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();var t={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),S.performance&&typeof S.performance.now=="function"?t.creationTime=S.performance.now():S.performance&&S.performance.timing&&typeof S.performance.timing.navigationStart=="number"&&(t.creationTime=S.Date.now()-S.performance.timing.navigationStart),t},r}(le);Ba(W,"TEST_VID",function(){if(ir()){var a=N.createElement("video"),r=N.createElement("track");return r.kind="captions",r.srclang="en",r.label="English",a.appendChild(r),a}}),W.isSupported=function(){try{W.TEST_VID.volume=.5}catch{return!1}return!!(W.TEST_VID&&W.TEST_VID.canPlayType)},W.canPlayType=function(a){return W.TEST_VID.canPlayType(a)},W.canPlaySource=function(a,r){return W.canPlayType(a.type)},W.canControlVolume=function(){try{var a=W.TEST_VID.volume;return W.TEST_VID.volume=a/2+.1,a!==W.TEST_VID.volume}catch{return!1}},W.canMuteVolume=function(){try{var a=W.TEST_VID.muted;return W.TEST_VID.muted=!a,W.TEST_VID.muted?Wr(W.TEST_VID,"muted","muted"):Ai(W.TEST_VID,"muted","muted"),a!==W.TEST_VID.muted}catch{return!1}},W.canControlPlaybackRate=function(){if(It&&_t&&Oo<58)return!1;try{var a=W.TEST_VID.playbackRate;return W.TEST_VID.playbackRate=a/2+.1,a!==W.TEST_VID.playbackRate}catch{return!1}},W.canOverrideAttributes=function(){try{var a=function(){};Object.defineProperty(N.createElement("video"),"src",{get:a,set:a}),Object.defineProperty(N.createElement("audio"),"src",{get:a,set:a}),Object.defineProperty(N.createElement("video"),"innerHTML",{get:a,set:a}),Object.defineProperty(N.createElement("audio"),"innerHTML",{get:a,set:a})}catch{return!1}return!0},W.supportsNativeTextTracks=function(){return Yn||tt&&_t},W.supportsNativeVideoTracks=function(){return!!(W.TEST_VID&&W.TEST_VID.videoTracks)},W.supportsNativeAudioTracks=function(){return!!(W.TEST_VID&&W.TEST_VID.audioTracks)},W.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(a){var r=a[0],i=a[1];Ba(W.prototype,r,function(){return W[i]()},!0)}),W.prototype.movingMediaElementInDOM=!tt,W.prototype.featuresFullscreenResize=!0,W.prototype.featuresProgressEvents=!0,W.prototype.featuresTimeupdateEvents=!0;var Wi;W.patchCanPlayType=function(){zn>=4&&!wo&&!_t&&(Wi=W.TEST_VID&&W.TEST_VID.constructor.prototype.canPlayType,W.TEST_VID.constructor.prototype.canPlayType=function(a){var r=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return a&&r.test(a)?"maybe":Wi.call(this,a)})},W.unpatchCanPlayType=function(){var a=W.TEST_VID.constructor.prototype.canPlayType;return Wi&&(W.TEST_VID.constructor.prototype.canPlayType=Wi),a},W.patchCanPlayType(),W.disposeMediaElement=function(a){if(a){for(a.parentNode&&a.parentNode.removeChild(a);a.hasChildNodes();)a.removeChild(a.firstChild);a.removeAttribute("src"),typeof a.load=="function"&&function(){try{a.load()}catch{}}()}},W.resetMediaElement=function(a){if(a){for(var r=a.querySelectorAll("source"),i=r.length;i--;)a.removeChild(r[i]);a.removeAttribute("src"),typeof a.load=="function"&&function(){try{a.load()}catch{}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(a){W.prototype[a]=function(){return this.el_[a]||this.el_.hasAttribute(a)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(a){W.prototype["set"+ge(a)]=function(r){this.el_[a]=r,r?this.el_.setAttribute(a,a):this.el_.removeAttribute(a)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(a){W.prototype[a]=function(){return this.el_[a]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","crossOrigin"].forEach(function(a){W.prototype["set"+ge(a)]=function(r){this.el_[a]=r}}),["pause","load","play"].forEach(function(a){W.prototype[a]=function(){return this.el_[a]()}}),le.withSourceHandlers(W),W.nativeSourceHandler={},W.nativeSourceHandler.canPlayType=function(a){try{return W.TEST_VID.canPlayType(a)}catch{return""}},W.nativeSourceHandler.canHandleSource=function(a,r){if(a.type)return W.nativeSourceHandler.canPlayType(a.type);if(a.src){var i=aa(a.src);return W.nativeSourceHandler.canPlayType("video/"+i)}return""},W.nativeSourceHandler.handleSource=function(a,r,i){r.setSrc(a.src)},W.nativeSourceHandler.dispose=function(){},W.registerSourceHandler(W.nativeSourceHandler),le.registerTech("Html5",W);var Uu=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],ja={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Va=["tiny","xsmall","small","medium","large","xlarge","huge"],Gi={};Va.forEach(function(a){var r=a.charAt(0)==="x"?"x-"+a.substring(1):a;Gi[a]="vjs-layout-"+r});var vd={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Te=function(a){H(r,a);function r(e,t,n){var s;if(e.id=e.id||t.id||"vjs_video_"+Pt(),t=he(r.getTagSettings(e),t),t.initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if(typeof e.closest=="function"){var o=e.closest("[lang]");o&&o.getAttribute&&(t.language=o.getAttribute("lang"))}else for(var u=e;u&&u.nodeType===1;){if(vt(u).hasOwnProperty("lang")){t.language=u.getAttribute("lang");break}u=u.parentNode}if(s=a.call(this,null,t,n)||this,s.boundDocumentFullscreenChange_=te(J(s),s.documentFullscreenChange_),s.boundFullWindowOnEscKey_=te(J(s),s.fullWindowOnEscKey),s.isFullscreen_=!1,s.log=eo(s.id_),s.fsApi_=Jn,s.isPosterFromTech_=!1,s.queuedCallbacks_=[],s.isReady_=!1,s.hasStarted_=!1,s.userActive_=!1,!s.options_||!s.options_.techOrder||!s.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(s.tag=e,s.tagAttributes=e&&vt(e),s.language(s.options_.language),t.languages){var l={};Object.getOwnPropertyNames(t.languages).forEach(function(d){l[d.toLowerCase()]=t.languages[d]}),s.languages_=l}else s.languages_=r.prototype.options_.languages;s.resetCache_(),s.poster_=t.poster||"",s.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),s.changingSrc_=!1,s.playCallbacks_=[],s.playTerminatedQueue_=[],e.hasAttribute("autoplay")?s.autoplay(!0):s.autoplay(s.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(function(d){if(typeof s[d]!="function")throw new Error('plugin "'+d+'" does not exist')}),s.scrubbing_=!1,s.el_=s.createEl(),qn(J(s),{eventBusKey:"el_"}),s.fsApi_.requestFullscreen&&(He(N,s.fsApi_.fullscreenchange,s.boundDocumentFullscreenChange_),s.on(s.fsApi_.fullscreenchange,s.boundDocumentFullscreenChange_)),s.fluid_&&s.on("playerreset",s.updateStyleEl_);var c=fe(s.options_);t.plugins&&Object.keys(t.plugins).forEach(function(d){s[d](t.plugins[d])}),s.options_.playerOptions=c,s.middleware_=[],s.initChildren(),s.isAudio(e.nodeName.toLowerCase()==="audio"),s.controls()?s.addClass("vjs-controls-enabled"):s.addClass("vjs-controls-disabled"),s.el_.setAttribute("role","region"),s.isAudio()?s.el_.setAttribute("aria-label",s.localize("Audio Player")):s.el_.setAttribute("aria-label",s.localize("Video Player")),s.isAudio()&&s.addClass("vjs-audio"),s.flexNotSupported_()&&s.addClass("vjs-no-flex"),ur&&s.addClass("vjs-touch-enabled"),tt||s.addClass("vjs-workinghover"),r.players[s.id_]=J(s);var f=Js.split(".")[0];return s.addClass("vjs-v"+f),s.userActive(!0),s.reportUserActivity(),s.one("play",s.listenForUserActivity_),s.on("stageclick",s.handleStageClick_),s.on("keydown",s.handleKeyDown),s.breakpoints(s.options_.breakpoints),s.responsive(s.options_.responsive),s}var i=r.prototype;return i.dispose=function(){var t=this;this.trigger("dispose"),this.off("dispose"),Ce(N,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Ce(N,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),r.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Uh(this),De.names.forEach(function(n){var s=De[n],o=t[s.getterName]();o&&o.off&&o.off()}),a.prototype.dispose.call(this)},i.createEl=function(){var t=this.tag,n,s=this.playerElIngest_=t.parentNode&&t.parentNode.hasAttribute&&t.parentNode.hasAttribute("data-vjs-player"),o=this.tag.tagName.toLowerCase()==="video-js";s?n=this.el_=t.parentNode:o||(n=this.el_=a.prototype.createEl.call(this,"div"));var u=vt(t);if(o){for(n=this.el_=t,t=this.tag=N.createElement("video");n.children.length;)t.appendChild(n.firstChild);Mt(n,"video-js")||mt(n,"video-js"),n.appendChild(t),s=this.playerElIngest_=n,Object.keys(n).forEach(function(_){try{t[_]=n[_]}catch{}})}if(t.setAttribute("tabindex","-1"),u.tabindex="-1",(Kr||_t&&Lo)&&(t.setAttribute("role","application"),u.role="application"),t.removeAttribute("width"),t.removeAttribute("height"),"width"in u&&delete u.width,"height"in u&&delete u.height,Object.getOwnPropertyNames(u).forEach(function(_){o&&_==="class"||n.setAttribute(_,u[_]),o&&t.setAttribute(_,u[_])}),t.playerId=t.id,t.id+="_html5_api",t.className="vjs-tech",t.player=n.player=this,this.addClass("vjs-paused"),S.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=yo("vjs-styles-dimensions");var l=At(".vjs-styles-defaults"),c=At("head");c.insertBefore(this.styleEl_,l?l.nextSibling:c.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var f=t.getElementsByTagName("a"),d=0;d<f.length;d++){var m=f.item(d);mt(m,"vjs-hidden"),m.setAttribute("hidden","hidden")}return t.initNetworkState_=t.networkState,t.parentNode&&!s&&t.parentNode.insertBefore(n,t),Nn(t,n),this.children_.unshift(t),this.el_.setAttribute("lang",this.language_),this.el_=n,n},i.crossOrigin=function(t){if(!t)return this.techGet_("crossOrigin");if(t!=="anonymous"&&t!=="use-credentials"){re.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+t+'"');return}this.techCall_("setCrossOrigin",t)},i.width=function(t){return this.dimension("width",t)},i.height=function(t){return this.dimension("height",t)},i.dimension=function(t,n){var s=t+"_";if(n===void 0)return this[s]||0;if(n===""||n==="auto"){this[s]=void 0,this.updateStyleEl_();return}var o=parseFloat(n);if(isNaN(o)){re.error('Improper value "'+n+'" supplied for for '+t);return}this[s]=o,this.updateStyleEl_()},i.fluid=function(t){if(t===void 0)return!!this.fluid_;this.fluid_=!!t,Ft(this)&&this.off("playerreset",this.updateStyleEl_),t?(this.addClass("vjs-fluid"),this.fill(!1),If(function(){this.on("playerreset",this.updateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},i.fill=function(t){if(t===void 0)return!!this.fill_;this.fill_=!!t,t?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},i.aspectRatio=function(t){if(t===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()},i.updateStyleEl_=function(){if(S.VIDEOJS_NO_DYNAMIC_STYLE===!0){var t=typeof this.width_=="number"?this.width_:this.options_.width,n=typeof this.height_=="number"?this.height_:this.options_.height,s=this.tech_&&this.tech_.el();s&&(t>=0&&(s.width=t),n>=0&&(s.height=n));return}var o,u,l,c;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?l=this.aspectRatio_:this.videoWidth()>0?l=this.videoWidth()+":"+this.videoHeight():l="16:9";var f=l.split(":"),d=f[1]/f[0];this.width_!==void 0?o=this.width_:this.height_!==void 0?o=this.height_/d:o=this.videoWidth()||300,this.height_!==void 0?u=this.height_:u=o*d,/^[^a-zA-Z]/.test(this.id())?c="dimensions-"+this.id():c=this.id()+"-dimensions",this.addClass(c),To(this.styleEl_,`
      .`+c+` {
        width: `+o+`px;
        height: `+u+`px;
      }

      .`+c+`.vjs-fluid {
        padding-top: `+d*100+`%;
      }
    `)},i.loadTech_=function(t,n){var s=this;this.tech_&&this.unloadTech_();var o=ge(t),u=t.charAt(0).toLowerCase()+t.slice(1);o!=="Html5"&&this.tag&&(le.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=o,this.isReady_=!1;var l=typeof this.autoplay()=="string"?!1:this.autoplay(),c={source:n,autoplay:l,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+u+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};De.names.forEach(function(d){var m=De[d];c[m.getterName]=s[m.privateName]}),he(c,this.options_[o]),he(c,this.options_[u]),he(c,this.options_[t.toLowerCase()]),this.tag&&(c.tag=this.tag),n&&n.src===this.cache_.src&&this.cache_.currentTime>0&&(c.startTime=this.cache_.currentTime);var f=le.getTech(t);if(!f)throw new Error("No Tech named '"+o+"' exists! '"+o+"' should be registered using videojs.registerTech()'");this.tech_=new f(c),this.tech_.ready(te(this,this.handleTechReady_),!0),Uo.jsonToTextTracks(this.textTracksJson_||[],this.tech_),Uu.forEach(function(d){s.on(s.tech_,d,s["handleTech"+ge(d)+"_"])}),Object.keys(ja).forEach(function(d){s.on(s.tech_,d,function(m){if(s.tech_.playbackRate()===0&&s.tech_.seeking()){s.queuedCallbacks_.push({callback:s["handleTech"+ja[d]+"_"].bind(s),event:m});return}s["handleTech"+ja[d]+"_"](m)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"fullscreenerror",this.handleTechFullscreenError_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(o!=="Html5"||!this.tag)&&Nn(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},i.unloadTech_=function(){var t=this;De.names.forEach(function(n){var s=De[n];t[s.privateName]=t[s.getterName]()}),this.textTracksJson_=Uo.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},i.tech=function(t){return t===void 0&&re.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_},i.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},i.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},i.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},i.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},i.manualAutoplay_=function(t){var n=this;if(!(!this.tech_||typeof t!="string")){var s=function(){var l=n.muted();n.muted(!0);var c=function(){n.muted(l)};n.playTerminatedQueue_.push(c);var f=n.play();if($r(f))return f.catch(c)},o;if(t==="any"&&this.muted()!==!0?(o=this.play(),$r(o)&&(o=o.catch(s))):t==="muted"&&this.muted()!==!0?o=s():o=this.play(),!!$r(o))return o.then(function(){n.trigger({type:"autoplay-success",autoplay:t})}).catch(function(u){n.trigger({type:"autoplay-failure",autoplay:t})})}},i.updateSourceCaches_=function(t){t===void 0&&(t="");var n=t,s="";typeof n!="string"&&(n=t.src,s=t.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],n&&!s&&(s=jh(this,n)),this.cache_.source=fe({},t,{src:n,type:s});for(var o=this.cache_.sources.filter(function(m){return m.src&&m.src===n}),u=[],l=this.$$("source"),c=[],f=0;f<l.length;f++){var d=vt(l[f]);u.push(d),d.src&&d.src===n&&c.push(d.src)}c.length&&!o.length?this.cache_.sources=u:o.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=n},i.handleTechSourceset_=function(t){var n=this;if(!this.changingSrc_){var s=function(c){return n.updateSourceCaches_(c)},o=this.currentSource().src,u=t.src;o&&!/^blob:/.test(o)&&/^blob:/.test(u)&&(!this.lastSource_||this.lastSource_.tech!==u&&this.lastSource_.player!==o)&&(s=function(){}),s(u),t.src||this.tech_.any(["sourceset","loadstart"],function(l){if(l.type!=="sourceset"){var c=n.techGet("currentSrc");n.lastSource_.tech=c,n.updateSourceCaches_(c)}})}this.lastSource_={player:this.currentSource().src,tech:t.src},this.trigger({src:t.src,type:"sourceset"})},i.hasStarted=function(t){if(t===void 0)return this.hasStarted_;t!==this.hasStarted_&&(this.hasStarted_=t,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},i.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},i.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(function(t){return t.callback(t.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},i.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting");var n=this.currentTime(),s=function o(){n!==t.currentTime()&&(t.removeClass("vjs-waiting"),t.off("timeupdate",o))};this.on("timeupdate",s)},i.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},i.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},i.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},i.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},i.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},i.handleTechFirstPlay_=function(){this.options_.starttime&&(re.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},i.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},i.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},i.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},i.handleTechClick_=function(t){sr(t)&&this.controls_&&(this.paused()?Vt(this.play()):this.pause())},i.handleTechDoubleClick_=function(t){if(this.controls_){var n=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(s){return s.contains(t.target)});n||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,t):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},i.handleTechTap_=function(){this.userActive(!this.userActive())},i.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},i.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},i.handleTechTouchEnd_=function(t){t.preventDefault()},i.handleStageClick_=function(){this.reportUserActivity()},i.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},i.documentFullscreenChange_=function(t){var n=t.target.player;if(!(n&&n!==this)){var s=this.el(),o=N[this.fsApi_.fullscreenElement]===s;!o&&s.matches?o=s.matches(":"+this.fsApi_.fullscreen):!o&&s.msMatchesSelector&&(o=s.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(o)}},i.handleTechFullscreenChange_=function(t,n){n&&(n.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(n.isFullscreen))},i.handleTechFullscreenError_=function(t,n){this.trigger("fullscreenerror",n)},i.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},i.handleTechEnterPictureInPicture_=function(t){this.isInPictureInPicture(!0)},i.handleTechLeavePictureInPicture_=function(t){this.isInPictureInPicture(!1)},i.handleTechError_=function(){var t=this.tech_.error();this.error(t)},i.handleTechTextData_=function(){var t=null;arguments.length>1&&(t=arguments[1]),this.trigger("textdata",t)},i.getCache=function(){return this.cache_},i.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},i.techCall_=function(t,n){this.ready(function(){if(t in Nh)return Lh(this.middleware_,this.tech_,t,n);if(t in ru)return tu(this.middleware_,this.tech_,t,n);try{this.tech_&&this.tech_[t](n)}catch(s){throw re(s),s}},!0)},i.techGet_=function(t){if(!(!this.tech_||!this.tech_.isReady_)){if(t in Rh)return Oh(this.middleware_,this.tech_,t);if(t in ru)return tu(this.middleware_,this.tech_,t);try{return this.tech_[t]()}catch(n){throw this.tech_[t]===void 0?(re("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",n),n):n.name==="TypeError"?(re("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",n),this.tech_.isReady_=!1,n):(re(n),n)}}},i.play=function(){var t=this,n=this.options_.Promise||S.Promise;return n?new n(function(s){t.play_(s)}):this.play_()},i.play_=function(t){var n=this;t===void 0&&(t=Vt),this.playCallbacks_.push(t);var s=!!(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!s){this.waitToPlay_=function(u){n.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!s&&(Yn||tt)&&this.load();return}var o=this.techGet_("play");o===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(o)},i.runPlayTerminatedQueue_=function(){var t=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],t.forEach(function(n){n()})},i.runPlayCallbacks_=function(t){var n=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],n.forEach(function(s){s(t)})},i.pause=function(){this.techCall_("pause")},i.paused=function(){return this.techGet_("paused")!==!1},i.played=function(){return this.techGet_("played")||jt(0,0)},i.scrubbing=function(t){if(typeof t>"u")return this.scrubbing_;this.scrubbing_=!!t,t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},i.currentTime=function(t){if(typeof t<"u"){if(t<0&&(t=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=t,this.off("canplay",this.applyInitTime_),this.one("canplay",this.applyInitTime_);return}this.techCall_("setCurrentTime",t),this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime},i.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},i.duration=function(t){if(t===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;t=parseFloat(t),t<0&&(t=1/0),t!==this.cache_.duration&&(this.cache_.duration=t,t===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(t)||this.trigger("durationchange"))},i.remainingTime=function(){return this.duration()-this.currentTime()},i.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},i.buffered=function(){var t=this.techGet_("buffered");return(!t||!t.length)&&(t=jt(0,0)),t},i.bufferedPercent=function(){return No(this.buffered(),this.duration())},i.bufferedEnd=function(){var t=this.buffered(),n=this.duration(),s=t.end(t.length-1);return s>n&&(s=n),s},i.volume=function(t){var n;if(t!==void 0){n=Math.max(0,Math.min(1,parseFloat(t))),this.cache_.volume=n,this.techCall_("setVolume",n),n>0&&this.lastVolume_(n);return}return n=parseFloat(this.techGet_("volume")),isNaN(n)?1:n},i.muted=function(t){if(t!==void 0){this.techCall_("setMuted",t);return}return this.techGet_("muted")||!1},i.defaultMuted=function(t){return t!==void 0?this.techCall_("setDefaultMuted",t):this.techGet_("defaultMuted")||!1},i.lastVolume_=function(t){if(t!==void 0&&t!==0){this.cache_.lastVolume=t;return}return this.cache_.lastVolume},i.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},i.isFullscreen=function(t){if(t!==void 0){var n=this.isFullscreen_;this.isFullscreen_=!!t,this.isFullscreen_!==n&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_},i.requestFullscreen=function(t){var n=this.options_.Promise||S.Promise;if(n){var s=this;return new n(function(o,u){function l(){s.off("fullscreenerror",f),s.off("fullscreenchange",c)}function c(){l(),o()}function f(m,_){l(),u(_)}s.one("fullscreenchange",c),s.one("fullscreenerror",f);var d=s.requestFullscreenHelper_(t);if(d)return d.then(l,l),d})}return this.requestFullscreenHelper_()},i.requestFullscreenHelper_=function(t){var n=this,s;if(this.fsApi_.prefixed||(s=this.options_.fullscreen&&this.options_.fullscreen.options||{},t!==void 0&&(s=t)),this.fsApi_.requestFullscreen){var o=this.el_[this.fsApi_.requestFullscreen](s);return o&&o.then(function(){return n.isFullscreen(!0)},function(){return n.isFullscreen(!1)}),o}else this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):this.enterFullWindow()},i.exitFullscreen=function(){var t=this.options_.Promise||S.Promise;if(t){var n=this;return new t(function(s,o){function u(){n.off("fullscreenerror",c),n.off("fullscreenchange",l)}function l(){u(),s()}function c(d,m){u(),o(m)}n.one("fullscreenchange",l),n.one("fullscreenerror",c);var f=n.exitFullscreenHelper_();if(f)return f.then(u,u),f})}return this.exitFullscreenHelper_()},i.exitFullscreenHelper_=function(){var t=this;if(this.fsApi_.requestFullscreen){var n=N[this.fsApi_.exitFullscreen]();return n&&n.then(function(){return t.isFullscreen(!1)}),n}else this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):this.exitFullWindow()},i.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=N.documentElement.style.overflow,He(N,"keydown",this.boundFullWindowOnEscKey_),N.documentElement.style.overflow="hidden",mt(N.body,"vjs-full-window"),this.trigger("enterFullWindow")},i.fullWindowOnEscKey=function(t){Y.isEventKey(t,"Esc")&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},i.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,Ce(N,"keydown",this.boundFullWindowOnEscKey_),N.documentElement.style.overflow=this.docOrigOverflow,Hr(N.body,"vjs-full-window"),this.trigger("exitFullWindow")},i.isInPictureInPicture=function(t){if(t!==void 0){this.isInPictureInPicture_=!!t,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_},i.requestPictureInPicture=function(){if("pictureInPictureEnabled"in N)return this.techGet_("requestPictureInPicture")},i.exitPictureInPicture=function(){if("pictureInPictureEnabled"in N)return N.exitPictureInPicture()},i.handleKeyDown=function(t){var n=this.options_.userActions;if(!(!n||!n.hotkeys)){var s=function(u){var l=u.tagName.toLowerCase();if(u.isContentEditable)return!0;var c=["button","checkbox","hidden","radio","reset","submit"];if(l==="input")return c.indexOf(u.type)===-1;var f=["textarea"];return f.indexOf(l)!==-1};s(this.el_.ownerDocument.activeElement)||(typeof n.hotkeys=="function"?n.hotkeys.call(this,t):this.handleHotkeys(t))}},i.handleHotkeys=function(t){var n=this.options_.userActions?this.options_.userActions.hotkeys:{},s=n.fullscreenKey,o=s===void 0?function(b){return Y.isEventKey(b,"f")}:s,u=n.muteKey,l=u===void 0?function(b){return Y.isEventKey(b,"m")}:u,c=n.playPauseKey,f=c===void 0?function(b){return Y.isEventKey(b,"k")||Y.isEventKey(b,"Space")}:c;if(o.call(this,t)){t.preventDefault(),t.stopPropagation();var d=L.getComponent("FullscreenToggle");N[this.fsApi_.fullscreenEnabled]!==!1&&d.prototype.handleClick.call(this,t)}else if(l.call(this,t)){t.preventDefault(),t.stopPropagation();var m=L.getComponent("MuteToggle");m.prototype.handleClick.call(this,t)}else if(f.call(this,t)){t.preventDefault(),t.stopPropagation();var _=L.getComponent("PlayToggle");_.prototype.handleClick.call(this,t)}},i.canPlayType=function(t){for(var n,s=0,o=this.options_.techOrder;s<o.length;s++){var u=o[s],l=le.getTech(u);if(l||(l=L.getComponent(u)),!l){re.error('The "'+u+'" tech is undefined. Skipped browser support check for that tech.');continue}if(l.isSupported()&&(n=l.canPlayType(t),n))return n}return""},i.selectSource=function(t){var n=this,s=this.options_.techOrder.map(function(f){return[f,le.getTech(f)]}).filter(function(f){var d=f[0],m=f[1];return m?m.isSupported():(re.error('The "'+d+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),o=function(d,m,_){var b;return d.some(function(A){return m.some(function(I){if(b=_(A,I),b)return!0})}),b},u,l=function(d){return function(m,_){return d(_,m)}},c=function(d,m){var _=d[0],b=d[1];if(b.canPlaySource(m,n.options_[_.toLowerCase()]))return{source:m,tech:_}};return this.options_.sourceOrder?u=o(t,s,l(c)):u=o(s,t,c),u||!1},i.src=function(t){var n=this;if(typeof t>"u")return this.cache_.src||"";var s=Vh(t);if(!s.length){this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);return}this.changingSrc_=!0,this.cache_.sources=s,this.updateSourceCaches_(s[0]),Dh(this,s[0],function(o,u){n.middleware_=u,n.cache_.sources=s,n.updateSourceCaches_(o);var l=n.src_(o);if(l){if(s.length>1)return n.src(s.slice(1));n.changingSrc_=!1,n.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),n.triggerReady();return}wh(u,n.tech_)})},i.src_=function(t){var n=this,s=this.selectSource([t]);return s?Of(s.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(s.tech,s.source),this.tech_.ready(function(){n.changingSrc_=!1}),!1):!0},i.load=function(){this.techCall_("load")},i.reset=function(){var t=this,n=this.options_.Promise||S.Promise;if(this.paused()||!n)this.doReset_();else{var s=this.play();Vt(s.then(function(){return t.doReset_()}))}},i.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Ft(this)&&this.trigger("playerreset")},i.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},i.resetProgressBar_=function(){this.currentTime(0);var t=this.controlBar,n=t.durationDisplay,s=t.remainingTimeDisplay;n&&n.updateContent(),s&&s.updateContent()},i.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},i.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},i.currentSources=function(){var t=this.currentSource(),n=[];return Object.keys(t).length!==0&&n.push(t),this.cache_.sources||n},i.currentSource=function(){return this.cache_.source||{}},i.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},i.currentType=function(){return this.currentSource()&&this.currentSource().type||""},i.preload=function(t){if(t!==void 0){this.techCall_("setPreload",t),this.options_.preload=t;return}return this.techGet_("preload")},i.autoplay=function(t){if(t===void 0)return this.options_.autoplay||!1;var n;typeof t=="string"&&/(any|play|muted)/.test(t)?(this.options_.autoplay=t,this.manualAutoplay_(t),n=!1):t?this.options_.autoplay=!0:this.options_.autoplay=!1,n=typeof n>"u"?this.options_.autoplay:n,this.tech_&&this.techCall_("setAutoplay",n)},i.playsinline=function(t){return t!==void 0?(this.techCall_("setPlaysinline",t),this.options_.playsinline=t,this):this.techGet_("playsinline")},i.loop=function(t){if(t!==void 0){this.techCall_("setLoop",t),this.options_.loop=t;return}return this.techGet_("loop")},i.poster=function(t){if(t===void 0)return this.poster_;t||(t=""),t!==this.poster_&&(this.poster_=t,this.techCall_("setPoster",t),this.isPosterFromTech_=!1,this.trigger("posterchange"))},i.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var t=this.tech_.poster()||"";t!==this.poster_&&(this.poster_=t,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},i.controls=function(t){if(t===void 0)return!!this.controls_;t=!!t,this.controls_!==t&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},i.usingNativeControls=function(t){if(t===void 0)return!!this.usingNativeControls_;t=!!t,this.usingNativeControls_!==t&&(this.usingNativeControls_=t,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},i.error=function(t){if(t===void 0)return this.error_||null;if(this.options_.suppressNotSupportedError&&t&&t.code===4){var n=function(){this.error(t)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],n),this.one("loadstart",function(){this.off(["click","touchstart"],n)});return}if(t===null){this.error_=t,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Ie(t),this.addClass("vjs-error"),re.error("(CODE:"+this.error_.code+" "+Ie.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},i.reportUserActivity=function(t){this.userActivity_=!0},i.userActive=function(t){if(t===void 0)return this.userActive_;if(t=!!t,t!==this.userActive_){if(this.userActive_=t,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(n){n.stopPropagation(),n.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},i.listenForUserActivity_=function(){var t,n,s,o=te(this,this.reportUserActivity),u=function(_){(_.screenX!==n||_.screenY!==s)&&(n=_.screenX,s=_.screenY,o())},l=function(){o(),this.clearInterval(t),t=this.setInterval(o,250)},c=function(_){o(),this.clearInterval(t)};this.on("mousedown",l),this.on("mousemove",u),this.on("mouseup",c),this.on("mouseleave",c);var f=this.getChild("controlBar");f&&!tt&&!It&&(f.on("mouseenter",function(m){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0}),f.on("mouseleave",function(m){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",o),this.on("keyup",o);var d;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(d);var m=this.options_.inactivityTimeout;m<=0||(d=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},m))}},250)},i.playbackRate=function(t){if(t!==void 0){this.techCall_("setPlaybackRate",t);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1},i.defaultPlaybackRate=function(t){return t!==void 0?this.techCall_("setDefaultPlaybackRate",t):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},i.isAudio=function(t){if(t!==void 0){this.isAudio_=!!t;return}return!!this.isAudio_},i.addTextTrack=function(t,n,s){if(this.tech_)return this.tech_.addTextTrack(t,n,s)},i.addRemoteTextTrack=function(t,n){if(this.tech_)return this.tech_.addRemoteTextTrack(t,n)},i.removeRemoteTextTrack=function(t){t===void 0&&(t={});var n=t,s=n.track;if(s||(s=t),this.tech_)return this.tech_.removeRemoteTextTrack(s)},i.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},i.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},i.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},i.language=function(t){if(t===void 0)return this.language_;this.language_=String(t).toLowerCase()},i.languages=function(){return fe(r.prototype.options_.languages,this.languages_)},i.toJSON=function(){var t=fe(this.options_),n=t.tracks;t.tracks=[];for(var s=0;s<n.length;s++){var o=n[s];o=fe(o),o.player=void 0,t.tracks[s]=o}return t},i.createModal=function(t,n){var s=this;n=n||{},n.content=t||"";var o=new cr(this,n);return this.addChild(o),o.on("dispose",function(){s.removeChild(o)}),o.open(),o},i.updateCurrentBreakpoint_=function(){if(this.responsive())for(var t=this.currentBreakpoint(),n=this.currentWidth(),s=0;s<Va.length;s++){var o=Va[s],u=this.breakpoints_[o];if(n<=u){if(t===o)return;t&&this.removeClass(Gi[t]),this.addClass(Gi[o]),this.breakpoint_=o;break}}},i.removeCurrentBreakpoint_=function(){var t=this.currentBreakpointClass();this.breakpoint_="",t&&this.removeClass(t)},i.breakpoints=function(t){return t===void 0?he(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=he({},vd,t),this.updateCurrentBreakpoint_(),he(this.breakpoints_))},i.responsive=function(t){if(t===void 0)return this.responsive_;t=!!t;var n=this.responsive_;if(t!==n)return this.responsive_=t,t?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),t},i.currentBreakpoint=function(){return this.breakpoint_},i.currentBreakpointClass=function(){return Gi[this.breakpoint_]||""},i.loadMedia=function(t,n){var s=this;if(!(!t||typeof t!="object")){this.reset(),this.cache_.media=fe(t);var o=this.cache_.media,u=o.artwork,l=o.poster,c=o.src,f=o.textTracks;!u&&l&&(this.cache_.media.artwork=[{src:l,type:Bi(l)}]),c&&this.src(c),l&&this.poster(l),Array.isArray(f)&&f.forEach(function(d){return s.addRemoteTextTrack(d,!1)}),this.ready(n)}},i.getMedia=function(){if(!this.cache_.media){var t=this.poster(),n=this.currentSources(),s=Array.prototype.map.call(this.remoteTextTracks(),function(u){return{kind:u.kind,label:u.label,language:u.language,src:u.src}}),o={src:n,textTracks:s};return t&&(o.poster=t,o.artwork=[{src:o.poster,type:Bi(o.poster)}]),o}return fe(this.cache_.media)},r.getTagSettings=function(t){var n={sources:[],tracks:[]},s=vt(t),o=s["data-setup"];if(Mt(t,"vjs-fill")&&(s.fill=!0),Mt(t,"vjs-fluid")&&(s.fluid=!0),o!==null){var u=Bf(o||"{}"),l=u[0],c=u[1];l&&re.error(l),he(s,c)}if(he(n,s),t.hasChildNodes())for(var f=t.childNodes,d=0,m=f.length;d<m;d++){var _=f[d],b=_.nodeName.toLowerCase();b==="source"?n.sources.push(vt(_)):b==="track"&&n.tracks.push(vt(_))}return n},i.flexNotSupported_=function(){var t=N.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)},r}(L);De.names.forEach(function(a){var r=De[a];Te.prototype[r.getterName]=function(){return this.tech_?this.tech_[r.getterName]():(this[r.privateName]=this[r.privateName]||new r.ListClass,this[r.privateName])}}),Te.prototype.crossorigin=Te.prototype.crossOrigin,Te.players={};var ii=S.navigator;Te.prototype.options_={techOrder:le.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:ii&&(ii.languages&&ii.languages[0]||ii.userLanguage||ii.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(a){Te.prototype[a]=function(){return this.techGet_(a)}}),Uu.forEach(function(a){Te.prototype["handleTech"+ge(a)+"_"]=function(){return this.trigger(a)}}),L.registerComponent("Player",Te);var Fu=pt(function(a){function r(i,e){return a.exports=r=Object.setPrototypeOf||function(n,s){return n.__proto__=s,n},r(i,e)}a.exports=r});function gd(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var _d=gd,yd=pt(function(a){function r(i,e,t){return _d()?a.exports=r=Reflect.construct:a.exports=r=function(s,o,u){var l=[null];l.push.apply(l,o);var c=Function.bind.apply(s,l),f=new c;return u&&Fu(f,u.prototype),f},r.apply(null,arguments)}a.exports=r}),qi="plugin",_r="activePlugins_",yr={},zi=function(r){return yr.hasOwnProperty(r)},Ki=function(r){return zi(r)?yr[r]:void 0},Bu=function(r,i){r[_r]=r[_r]||{},r[_r][i]=!0},Xi=function(r,i,e){var t=(e?"before":"")+"pluginsetup";r.trigger(t,i),r.trigger(t+":"+i.name,i)},Td=function(r,i){var e=function(){Xi(this,{name:r,plugin:i,instance:null},!0);var n=i.apply(this,arguments);return Bu(this,r),Xi(this,{name:r,plugin:i,instance:n}),n};return Object.keys(i).forEach(function(t){e[t]=i[t]}),e},ju=function(r,i){return i.prototype.name=r,function(){Xi(this,{name:r,plugin:i,instance:null},!0);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var s=yd(i,[this].concat(t));return this[r]=function(){return s},Xi(this,s.getEventHash()),s}},st=function(){function a(i){if(this.constructor===a)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=i,qn(this),delete this.trigger,Ao(this,this.constructor.defaultState),Bu(i,this.name),this.dispose=te(this,this.dispose),i.on("dispose",this.dispose)}var r=a.prototype;return r.version=function(){return this.constructor.VERSION},r.getEventHash=function(e){return e===void 0&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},r.trigger=function(e,t){return t===void 0&&(t={}),or(this.eventBusEl_,e,this.getEventHash(t))},r.handleStateChanged=function(e){},r.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[_r][e]=!1,this.player=this.state=null,t[e]=ju(e,yr[e])},a.isBasic=function(e){var t=typeof e=="string"?Ki(e):e;return typeof t=="function"&&!a.prototype.isPrototypeOf(t.prototype)},a.registerPlugin=function(e,t){if(typeof e!="string")throw new Error('Illegal plugin name, "'+e+'", must be a string, was '+typeof e+".");if(zi(e))re.warn('A plugin named "'+e+'" already exists. You may want to avoid re-registering plugins!');else if(Te.prototype.hasOwnProperty(e))throw new Error('Illegal plugin name, "'+e+'", cannot share a name with an existing player method!');if(typeof t!="function")throw new Error('Illegal plugin for "'+e+'", must be a function, was '+typeof t+".");return yr[e]=t,e!==qi&&(a.isBasic(t)?Te.prototype[e]=Td(e,t):Te.prototype[e]=ju(e,t)),t},a.deregisterPlugin=function(e){if(e===qi)throw new Error("Cannot de-register base plugin.");zi(e)&&(delete yr[e],delete Te.prototype[e])},a.getPlugins=function(e){e===void 0&&(e=Object.keys(yr));var t;return e.forEach(function(n){var s=Ki(n);s&&(t=t||{},t[n]=s)}),t},a.getPluginVersion=function(e){var t=Ki(e);return t&&t.VERSION||""},a}();st.getPlugin=Ki,st.BASE_PLUGIN_NAME=qi,st.registerPlugin(qi,st),Te.prototype.usingPlugin=function(a){return!!this[_r]&&this[_r][a]===!0},Te.prototype.hasPlugin=function(a){return!!zi(a)};function bd(a,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(r&&r.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),r&&Fu(a,r)}var xd=bd,Sd=function(r,i){i===void 0&&(i={});var e=function(){r.apply(this,arguments)},t={};typeof i=="object"?(i.constructor!==Object.prototype.constructor&&(e=i.constructor),t=i):typeof i=="function"&&(e=i),xd(e,r),r&&(e.super_=r);for(var n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n]);return e},Vu=function(r){return r.indexOf("#")===0?r.slice(1):r};function k(a,r,i){var e=k.getPlayer(a);if(e)return r&&re.warn('Player "'+a+'" is already initialised. Options will not be applied.'),i&&e.ready(i),e;var t=typeof a=="string"?At("#"+Vu(a)):a;if(!nr(t))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!t.ownerDocument.defaultView||!t.ownerDocument.body.contains(t))&&re.warn("The element supplied is not included in the DOM"),r=r||{},k.hooks("beforesetup").forEach(function(s){var o=s(t,fe(r));if(!kt(o)||Array.isArray(o)){re.error("please return an object in beforesetup hooks");return}r=fe(r,o)});var n=L.getComponent("Player");return e=new n(t,r,i),k.hooks("setup").forEach(function(s){return s(e)}),e}if(k.hooks_={},k.hooks=function(a,r){return k.hooks_[a]=k.hooks_[a]||[],r&&(k.hooks_[a]=k.hooks_[a].concat(r)),k.hooks_[a]},k.hook=function(a,r){k.hooks(a,r)},k.hookOnce=function(a,r){k.hooks(a,[].concat(r).map(function(i){var e=function t(){return k.removeHook(a,t),i.apply(void 0,arguments)};return e}))},k.removeHook=function(a,r){var i=k.hooks(a).indexOf(r);return i<=-1?!1:(k.hooks_[a]=k.hooks_[a].slice(),k.hooks_[a].splice(i,1),!0)},S.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&ir()){var $i=At(".vjs-styles-defaults");if(!$i){$i=yo("vjs-styles-defaults");var Ha=At("head");Ha&&Ha.insertBefore($i,Ha.firstChild),To($i,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid {
        padding-top: 56.25%
      }
    `)}}jn(1,k),k.VERSION=Js,k.options=Te.prototype.options_,k.getPlayers=function(){return Te.players},k.getPlayer=function(a){var r=Te.players,i;if(typeof a=="string"){var e=Vu(a),t=r[e];if(t)return t;i=At("#"+e)}else i=a;if(nr(i)){var n=i,s=n.player,o=n.playerId;if(s||r[o])return s||r[o]}},k.getAllPlayers=function(){return Object.keys(Te.players).map(function(a){return Te.players[a]}).filter(Boolean)},k.players=Te.players,k.getComponent=L.getComponent,k.registerComponent=function(a,r){le.isTech(r)&&re.warn("The "+a+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),L.registerComponent.call(L,a,r)},k.getTech=le.getTech,k.registerTech=le.registerTech,k.use=Ih,Object.defineProperty(k,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(k.middleware,"TERMINATOR",{value:Fi,writeable:!1,enumerable:!0}),k.browser=Uf,k.TOUCH_ENABLED=ur,k.extend=Sd,k.mergeOptions=fe,k.bind=te,k.registerPlugin=st.registerPlugin,k.deregisterPlugin=st.deregisterPlugin,k.plugin=function(a,r){return re.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),st.registerPlugin(a,r)},k.getPlugins=st.getPlugins,k.getPlugin=st.getPlugin,k.getPluginVersion=st.getPluginVersion,k.addLanguage=function(a,r){var i;return a=(""+a).toLowerCase(),k.options.languages=fe(k.options.languages,(i={},i[a]=r,i)),k.options.languages[a]},k.log=re,k.createLogger=eo,k.createTimeRange=k.createTimeRanges=jt,k.formatTime=mr,k.setFormatTime=Xh,k.resetFormatTime=$h,k.parseUrl=na,k.isCrossOrigin=Ni,k.EventTarget=be,k.on=He,k.one=Di,k.off=Ce,k.trigger=or,k.xhr=sa,k.TextTrack=Yr,k.AudioTrack=zo,k.VideoTrack=Ko,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(a){k[a]=function(){return re.warn("videojs."+a+"() is deprecated; use videojs.dom."+a+"() instead"),go[a].apply(null,arguments)}}),k.computedStyle=ki,k.dom=go,k.url=Yf,k.defineLazyProperty=Ba;var Wa=pt(function(a,r){(function(i){var e=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,t=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(l,c,f){if(f=f||{},l=l.trim(),c=c.trim(),!c){if(!f.alwaysNormalize)return l;var d=o.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var m=o.parseURL(c);if(!m)throw new Error("Error trying to parse relative URL.");if(m.scheme)return f.alwaysNormalize?(m.path=o.normalizePath(m.path),o.buildURLFromParts(m)):c;var _=o.parseURL(l);if(!_)throw new Error("Error trying to parse base URL.");if(!_.netLoc&&_.path&&_.path[0]!=="/"){var b=t.exec(_.path);_.netLoc=b[1],_.path=b[2]}_.netLoc&&!_.path&&(_.path="/");var A={scheme:_.scheme,netLoc:m.netLoc,path:null,params:m.params,query:m.query,fragment:m.fragment};if(!m.netLoc&&(A.netLoc=_.netLoc,m.path[0]!=="/"))if(!m.path)A.path=_.path,m.params||(A.params=_.params,m.query||(A.query=_.query));else{var I=_.path,D=I.substring(0,I.lastIndexOf("/")+1)+m.path;A.path=o.normalizePath(D)}return A.path===null&&(A.path=f.alwaysNormalize?o.normalizePath(m.path):m.path),o.buildURLFromParts(A)},parseURL:function(l){var c=e.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(n,"");l.length!==(l=l.replace(s,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};a.exports=o})()});/*! @name m3u8-parser @version 4.4.0 @license Apache-2.0 */function Ga(){return Ga=Object.assign||function(a){for(var r=1;r<arguments.length;r++){var i=arguments[r];for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(a[e]=i[e])}return a},Ga.apply(this,arguments)}function qa(a,r){a.prototype=Object.create(r.prototype),a.prototype.constructor=a,a.__proto__=r}function Ed(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}var za=function(){function a(){this.listeners={}}var r=a.prototype;return r.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},r.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},r.trigger=function(e){var t=this.listeners[e],n,s,o;if(t)if(arguments.length===2)for(s=t.length,n=0;n<s;++n)t[n].call(this,arguments[1]);else for(o=Array.prototype.slice.call(arguments,1),s=t.length,n=0;n<s;++n)t[n].apply(this,o)},r.dispose=function(){this.listeners={}},r.pipe=function(e){this.on("data",function(t){e.push(t)})},a}(),Cd=function(a){qa(r,a);function r(){var e;return e=a.call(this)||this,e.buffer="",e}var i=r.prototype;return i.push=function(t){var n;for(this.buffer+=t,n=this.buffer.indexOf(`
`);n>-1;n=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,n)),this.buffer=this.buffer.substring(n+1)},r}(za),kd=function(){var r="[^=]*",i='"[^"]*"|[^,]*',e="(?:"+r+")=(?:"+i+")";return new RegExp("(?:^|,)("+e+")")},ni=function(r){for(var i=r.split(kd()),e={},t=i.length,n;t--;)i[t]!==""&&(n=/([^=]*)=(.*)/.exec(i[t]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),e[n[0]]=n[1]);return e},Ad=function(a){qa(r,a);function r(){var e;return e=a.call(this)||this,e.customParsers=[],e.tagMappers=[],e}var i=r.prototype;return i.push=function(t){var n=this,s,o;if(t=t.trim(),t.length!==0){if(t[0]!=="#"){this.trigger("data",{type:"uri",uri:t});return}var u=this.tagMappers.reduce(function(l,c){var f=c(t);return f===t?l:l.concat([f])},[t]);u.forEach(function(l){for(var c=0;c<n.customParsers.length;c++)if(n.customParsers[c].call(n,l))return;if(l.indexOf("#EXT")!==0){n.trigger("data",{type:"comment",text:l.slice(1)});return}if(l=l.replace("\r",""),s=/^#EXTM3U/.exec(l),s){n.trigger("data",{type:"tag",tagType:"m3u"});return}if(s=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(l),s){o={type:"tag",tagType:"inf"},s[1]&&(o.duration=parseFloat(s[1])),s[2]&&(o.title=s[2]),n.trigger("data",o);return}if(s=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"targetduration"},s[1]&&(o.duration=parseInt(s[1],10)),n.trigger("data",o);return}if(s=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"totalduration"},s[1]&&(o.duration=parseInt(s[1],10)),n.trigger("data",o);return}if(s=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"version"},s[1]&&(o.version=parseInt(s[1],10)),n.trigger("data",o);return}if(s=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"media-sequence"},s[1]&&(o.number=parseInt(s[1],10)),n.trigger("data",o);return}if(s=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"discontinuity-sequence"},s[1]&&(o.number=parseInt(s[1],10)),n.trigger("data",o);return}if(s=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(l),s){o={type:"tag",tagType:"playlist-type"},s[1]&&(o.playlistType=s[1]),n.trigger("data",o);return}if(s=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"byterange"},s[1]&&(o.length=parseInt(s[1],10)),s[2]&&(o.offset=parseInt(s[2],10)),n.trigger("data",o);return}if(s=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(l),s){o={type:"tag",tagType:"allow-cache"},s[1]&&(o.allowed=!/NO/.test(s[1])),n.trigger("data",o);return}if(s=/^#EXT-X-MAP:?(.*)$/.exec(l),s){if(o={type:"tag",tagType:"map"},s[1]){var f=ni(s[1]);if(f.URI&&(o.uri=f.URI),f.BYTERANGE){var d=f.BYTERANGE.split("@"),m=d[0],_=d[1];o.byterange={},m&&(o.byterange.length=parseInt(m,10)),_&&(o.byterange.offset=parseInt(_,10))}}n.trigger("data",o);return}if(s=/^#EXT-X-STREAM-INF:?(.*)$/.exec(l),s){if(o={type:"tag",tagType:"stream-inf"},s[1]){if(o.attributes=ni(s[1]),o.attributes.RESOLUTION){var b=o.attributes.RESOLUTION.split("x"),A={};b[0]&&(A.width=parseInt(b[0],10)),b[1]&&(A.height=parseInt(b[1],10)),o.attributes.RESOLUTION=A}o.attributes.BANDWIDTH&&(o.attributes.BANDWIDTH=parseInt(o.attributes.BANDWIDTH,10)),o.attributes["PROGRAM-ID"]&&(o.attributes["PROGRAM-ID"]=parseInt(o.attributes["PROGRAM-ID"],10))}n.trigger("data",o);return}if(s=/^#EXT-X-MEDIA:?(.*)$/.exec(l),s){o={type:"tag",tagType:"media"},s[1]&&(o.attributes=ni(s[1])),n.trigger("data",o);return}if(s=/^#EXT-X-ENDLIST/.exec(l),s){n.trigger("data",{type:"tag",tagType:"endlist"});return}if(s=/^#EXT-X-DISCONTINUITY/.exec(l),s){n.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(s=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(l),s){o={type:"tag",tagType:"program-date-time"},s[1]&&(o.dateTimeString=s[1],o.dateTimeObject=new Date(s[1])),n.trigger("data",o);return}if(s=/^#EXT-X-KEY:?(.*)$/.exec(l),s){o={type:"tag",tagType:"key"},s[1]&&(o.attributes=ni(s[1]),o.attributes.IV&&(o.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(o.attributes.IV=o.attributes.IV.substring(2)),o.attributes.IV=o.attributes.IV.match(/.{8}/g),o.attributes.IV[0]=parseInt(o.attributes.IV[0],16),o.attributes.IV[1]=parseInt(o.attributes.IV[1],16),o.attributes.IV[2]=parseInt(o.attributes.IV[2],16),o.attributes.IV[3]=parseInt(o.attributes.IV[3],16),o.attributes.IV=new Uint32Array(o.attributes.IV))),n.trigger("data",o);return}if(s=/^#EXT-X-START:?(.*)$/.exec(l),s){o={type:"tag",tagType:"start"},s[1]&&(o.attributes=ni(s[1]),o.attributes["TIME-OFFSET"]=parseFloat(o.attributes["TIME-OFFSET"]),o.attributes.PRECISE=/YES/.test(o.attributes.PRECISE)),n.trigger("data",o);return}if(s=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(l),s){o={type:"tag",tagType:"cue-out-cont"},s[1]?o.data=s[1]:o.data="",n.trigger("data",o);return}if(s=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(l),s){o={type:"tag",tagType:"cue-out"},s[1]?o.data=s[1]:o.data="",n.trigger("data",o);return}if(s=/^#EXT-X-CUE-IN:?(.*)?$/.exec(l),s){o={type:"tag",tagType:"cue-in"},s[1]?o.data=s[1]:o.data="",n.trigger("data",o);return}n.trigger("data",{type:"tag",data:l.slice(4)})})}},i.addParser=function(t){var n=this,s=t.expression,o=t.customType,u=t.dataParser,l=t.segment;typeof u!="function"&&(u=function(f){return f}),this.customParsers.push(function(c){var f=s.exec(c);if(f)return n.trigger("data",{type:"custom",data:u(c),customType:o,segment:l}),!0})},i.addTagMapper=function(t){var n=t.expression,s=t.map,o=function(l){return n.test(l)?s(l):l};this.tagMappers.push(o)},r}(za);function Pd(a){for(var r=S.atob(a||""),i=new Uint8Array(r.length),e=0;e<r.length;e++)i[e]=r.charCodeAt(e);return i}var Hu=function(a){qa(r,a);function r(){var e;e=a.call(this)||this,e.lineStream=new Cd,e.parseStream=new Ad,e.lineStream.pipe(e.parseStream);var t=Ed(e),n=[],s={},o,u,l=function(){},c={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},f="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",d=0;return e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},e.parseStream.on("data",function(m){var _,b;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=m.allowed,"allowed"in m||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var D={};"length"in m&&(s.byterange=D,D.length=m.length,"offset"in m||(this.trigger("info",{message:"defaulting offset to zero"}),m.offset=0)),"offset"in m&&(s.byterange=D,D.offset=m.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),m.duration>0&&(s.duration=m.duration),m.duration===0&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=n},key:function(){if(!m.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(m.attributes.METHOD==="NONE"){u=null;return}if(!m.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(m.attributes.KEYFORMAT===f){var D=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(D.indexOf(m.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(m.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),m.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(m.attributes.KEYID&&m.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:m.attributes.KEYFORMAT,keyId:m.attributes.KEYID.substring(2)},pssh:Pd(m.attributes.URI.split(",")[1])}};return}m.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),u={method:m.attributes.METHOD||"AES-128",uri:m.attributes.URI},typeof m.attributes.IV<"u"&&(u.iv=m.attributes.IV)},"media-sequence":function(){if(!isFinite(m.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+m.number});return}this.manifest.mediaSequence=m.number},"discontinuity-sequence":function(){if(!isFinite(m.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+m.number});return}this.manifest.discontinuitySequence=m.number,d=m.number},"playlist-type":function(){if(!/VOD|EVENT/.test(m.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+m.playlist});return}this.manifest.playlistType=m.playlistType},map:function(){o={},m.uri&&(o.uri=m.uri),m.byterange&&(o.byterange=m.byterange)},"stream-inf":function(){if(this.manifest.playlists=n,this.manifest.mediaGroups=this.manifest.mediaGroups||c,!m.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}s.attributes||(s.attributes={}),Ga(s.attributes,m.attributes)},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||c,!(m.attributes&&m.attributes.TYPE&&m.attributes["GROUP-ID"]&&m.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var D=this.manifest.mediaGroups[m.attributes.TYPE];D[m.attributes["GROUP-ID"]]=D[m.attributes["GROUP-ID"]]||{},_=D[m.attributes["GROUP-ID"]],b={default:/yes/i.test(m.attributes.DEFAULT)},b.default?b.autoselect=!0:b.autoselect=/yes/i.test(m.attributes.AUTOSELECT),m.attributes.LANGUAGE&&(b.language=m.attributes.LANGUAGE),m.attributes.URI&&(b.uri=m.attributes.URI),m.attributes["INSTREAM-ID"]&&(b.instreamId=m.attributes["INSTREAM-ID"]),m.attributes.CHARACTERISTICS&&(b.characteristics=m.attributes.CHARACTERISTICS),m.attributes.FORCED&&(b.forced=/yes/i.test(m.attributes.FORCED)),_[m.attributes.NAME]=b},discontinuity:function(){d+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(n.length)},"program-date-time":function(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=m.dateTimeString,this.manifest.dateTimeObject=m.dateTimeObject),s.dateTimeString=m.dateTimeString,s.dateTimeObject=m.dateTimeObject},targetduration:function(){if(!isFinite(m.duration)||m.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+m.duration});return}this.manifest.targetDuration=m.duration},totalduration:function(){if(!isFinite(m.duration)||m.duration<0){this.trigger("warn",{message:"ignoring invalid total duration: "+m.duration});return}this.manifest.totalDuration=m.duration},start:function(){if(!m.attributes||isNaN(m.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:m.attributes["TIME-OFFSET"],precise:m.attributes.PRECISE}},"cue-out":function(){s.cueOut=m.data},"cue-out-cont":function(){s.cueOutCont=m.data},"cue-in":function(){s.cueIn=m.data}}[m.tagType]||l).call(t)},uri:function(){s.uri=m.uri,n.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),u&&(s.key=u),s.timeline=d,o&&(s.map=o),s={}},comment:function(){},custom:function(){m.segment?(s.custom=s.custom||{},s.custom[m.customType]=m.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[m.customType]=m.data)}})[m.type].call(t)}),e}var i=r.prototype;return i.push=function(t){this.lineStream.push(t)},i.end=function(){this.lineStream.push(`
`)},i.addParser=function(t){this.parseStream.addParser(t)},i.addTagMapper=function(t){this.parseStream.addTagMapper(t)},r}(za);function Wu(a){return a&&typeof a=="object"&&"default"in a?a.default:a}var Gu=Wu(Wa),qu=Wu(S),Id=function(r,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(r)||(r=Gu.buildAbsoluteURL(qu.location&&qu.location.href||"",r)),Gu.buildAbsoluteURL(r,i))},Ka=Id;function Dd(a){return a&&typeof a=="object"&&"default"in a?a.default:a}var zu=Dd(S),wd=function(r){return zu.atob?zu.atob(r):Buffer.from(r,"base64").toString("binary")};function Od(a){for(var r=wd(a),i=new Uint8Array(r.length),e=0;e<r.length;e++)i[e]=r.charCodeAt(e);return i}var Ld=Od,Xa=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ku=new RegExp("[\\-\\.0-9"+Xa.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Xu=new RegExp("^"+Xa.source+Ku.source+"*(?::"+Xa.source+Ku.source+"*)?$"),ai=0,Dt=1,Tr=2,si=3,br=4,xr=5,oi=6,Yi=7;function $u(){}$u.prototype={parse:function(r,i,e){var t=this.domBuilder;t.startDocument(),Ju(i,i={}),Rd(r,i,e,t,this.errorHandler),t.endDocument()}};function Rd(a,r,i,e,t){function n(ee){if(ee>65535){ee-=65536;var ue=55296+(ee>>10),_e=56320+(ee&1023);return String.fromCharCode(ue,_e)}else return String.fromCharCode(ee)}function s(ee){var ue=ee.slice(1,-1);return ue in i?i[ue]:ue.charAt(0)==="#"?n(parseInt(ue.substr(1).replace("x","0x"))):(t.error("entity not found:"+ee),ee)}function o(ee){if(ee>b){var ue=a.substring(b,ee).replace(/&#?\w+;/g,s);d&&u(b),e.characters(ue,0,ee-b),b=ee}}function u(ee,ue){for(;ee>=c&&(ue=f.exec(a));)l=ue.index,c=l+ue[0].length,d.lineNumber++;d.columnNumber=ee-l+1}for(var l=0,c=0,f=/.*(?:\r\n?|\n)|.*$/g,d=e.locator,m=[{currentNSMap:r}],_={},b=0;;){try{var A=a.indexOf("<",b);if(A<0){if(!a.substr(b).match(/^\s*$/)){var I=e.doc,D=I.createTextNode(a.substr(b));I.appendChild(D),e.currentElement=D}return}switch(A>b&&o(A),a.charAt(A+1)){case"/":var z=a.indexOf(">",A+3),O=a.substring(A+2,z),M=m.pop();z<0?(O=a.substring(A+2).replace(/[\s<].*/,""),t.error("end tag name: "+O+" is not complete:"+M.tagName),z=A+1+O.length):O.match(/\s</)&&(O=O.replace(/[\s<].*/,""),t.error("end tag name: "+O+" maybe not complete"),z=A+1+O.length);var U=M.localNSMap,R=M.tagName==O,j=R||M.tagName&&M.tagName.toLowerCase()==O.toLowerCase();if(j){if(e.endElement(M.uri,M.localName,O),U)for(var G in U)e.endPrefixMapping(G);R||t.fatalError("end tag name: "+O+" is not match the current start tagName:"+M.tagName)}else m.push(M);z++;break;case"?":d&&u(A),z=Bd(a,A,e);break;case"!":d&&u(A),z=Fd(a,A,e,t);break;default:d&&u(A);var Q=new Zu,$=m[m.length-1].currentNSMap,z=Nd(a,A,Q,$,s,t),K=Q.length;if(!Q.closed&&Ud(a,z,Q.tagName,_)&&(Q.closed=!0,i.nbsp||t.warning("unclosed xml attribute")),d&&K){for(var V=Yu(d,{}),oe=0;oe<K;oe++){var ve=Q[oe];u(ve.offset),ve.locator=Yu(d,{})}e.locator=V,Qu(Q,e,$)&&m.push(Q),e.locator=d}else Qu(Q,e,$)&&m.push(Q);Q.uri==="http://www.w3.org/1999/xhtml"&&!Q.closed?z=Md(a,z,Q.tagName,s,e):z++}}catch(ee){t.error("element parse error: "+ee),z=-1}z>b?b=z:o(Math.max(A,b)+1)}}function Yu(a,r){return r.lineNumber=a.lineNumber,r.columnNumber=a.columnNumber,r}function Nd(a,r,i,e,t,n){for(var s,o,u=++r,l=ai;;){var c=a.charAt(u);switch(c){case"=":if(l===Dt)s=a.slice(r,u),l=si;else if(l===Tr)l=si;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(l===si||l===Dt)if(l===Dt&&(n.warning('attribute value must after "="'),s=a.slice(r,u)),r=u+1,u=a.indexOf(c,r),u>0)o=a.slice(r,u).replace(/&#?\w+;/g,t),i.add(s,o,r-1),l=xr;else throw new Error("attribute value no end '"+c+"' match");else if(l==br)o=a.slice(r,u).replace(/&#?\w+;/g,t),i.add(s,o,r),n.warning('attribute "'+s+'" missed start quot('+c+")!!"),r=u+1,l=xr;else throw new Error('attribute value must after "="');break;case"/":switch(l){case ai:i.setTagName(a.slice(r,u));case xr:case oi:case Yi:l=Yi,i.closed=!0;case br:case Dt:case Tr:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return n.error("unexpected end of input"),l==ai&&i.setTagName(a.slice(r,u)),u;case">":switch(l){case ai:i.setTagName(a.slice(r,u));case xr:case oi:case Yi:break;case br:case Dt:o=a.slice(r,u),o.slice(-1)==="/"&&(i.closed=!0,o=o.slice(0,-1));case Tr:l===Tr&&(o=s),l==br?(n.warning('attribute "'+o+'" missed quot(")!!'),i.add(s,o.replace(/&#?\w+;/g,t),r)):((e[""]!=="http://www.w3.org/1999/xhtml"||!o.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+o+'" missed value!! "'+o+'" instead!!'),i.add(o,o,r));break;case si:throw new Error("attribute value missed!!")}return u;case"\x80":c=" ";default:if(c<=" ")switch(l){case ai:i.setTagName(a.slice(r,u)),l=oi;break;case Dt:s=a.slice(r,u),l=Tr;break;case br:var o=a.slice(r,u).replace(/&#?\w+;/g,t);n.warning('attribute "'+o+'" missed quot(")!!'),i.add(s,o,r);case xr:l=oi;break}else switch(l){case Tr:var f=i.tagName;(e[""]!=="http://www.w3.org/1999/xhtml"||!s.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),i.add(s,s,r),r=u,l=Dt;break;case xr:n.warning('attribute space is required"'+s+'"!!');case oi:l=Dt,r=u;break;case si:l=br,r=u;break;case Yi:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function Qu(a,r,i){for(var e=a.tagName,t=null,f=a.length;f--;){var n=a[f],s=n.qName,o=n.value,d=s.indexOf(":");if(d>0)var u=n.prefix=s.slice(0,d),l=s.slice(d+1),c=u==="xmlns"&&l;else l=s,u=null,c=s==="xmlns"&&"";n.localName=l,c!==!1&&(t==null&&(t={},Ju(i,i={})),i[c]=t[c]=o,n.uri="http://www.w3.org/2000/xmlns/",r.startPrefixMapping(c,o))}for(var f=a.length;f--;){n=a[f];var u=n.prefix;u&&(u==="xml"&&(n.uri="http://www.w3.org/XML/1998/namespace"),u!=="xmlns"&&(n.uri=i[u||""]))}var d=e.indexOf(":");d>0?(u=a.prefix=e.slice(0,d),l=a.localName=e.slice(d+1)):(u=null,l=a.localName=e);var m=a.uri=i[u||""];if(r.startElement(m,l,e,a),a.closed){if(r.endElement(m,l,e),t)for(u in t)r.endPrefixMapping(u)}else return a.currentNSMap=i,a.localNSMap=t,!0}function Md(a,r,i,e,t){if(/^(?:script|textarea)$/i.test(i)){var n=a.indexOf("</"+i+">",r),s=a.substring(r+1,n);if(/[&<]/.test(s))return/^script$/i.test(i)?(t.characters(s,0,s.length),n):(s=s.replace(/&#?\w+;/g,e),t.characters(s,0,s.length),n)}return r+1}function Ud(a,r,i,e){var t=e[i];return t==null&&(t=a.lastIndexOf("</"+i+">"),t<r&&(t=a.lastIndexOf("</"+i)),e[i]=t),t<r}function Ju(a,r){for(var i in a)r[i]=a[i]}function Fd(a,r,i,e){var t=a.charAt(r+2);switch(t){case"-":if(a.charAt(r+3)==="-"){var n=a.indexOf("-->",r+4);return n>r?(i.comment(a,r+4,n-r-4),n+3):(e.error("Unclosed comment"),-1)}else return-1;default:if(a.substr(r+3,6)=="CDATA["){var n=a.indexOf("]]>",r+9);return i.startCDATA(),i.characters(a,r+9,n-r-9),i.endCDATA(),n+3}var s=jd(a,r),o=s.length;if(o>1&&/!doctype/i.test(s[0][0])){var u=s[1][0],l=o>3&&/^public$/i.test(s[2][0])&&s[3][0],c=o>4&&s[4][0],f=s[o-1];return i.startDTD(u,l&&l.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),i.endDTD(),f.index+f[0].length}}return-1}function Bd(a,r,i){var e=a.indexOf("?>",r);if(e){var t=a.substring(r,e).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(t){var n=t[0].length;return i.processingInstruction(t[1],t[2]),e+2}else return-1}return-1}function Zu(a){}Zu.prototype={setTagName:function(r){if(!Xu.test(r))throw new Error("invalid tagName:"+r);this.tagName=r},add:function(r,i,e){if(!Xu.test(r))throw new Error("invalid attribute:"+r);this[this.length++]={qName:r,value:i,offset:e}},length:0,getLocalName:function(r){return this[r].localName},getLocator:function(r){return this[r].locator},getQName:function(r){return this[r].qName},getURI:function(r){return this[r].uri},getValue:function(r){return this[r].value}};function Qi(a,r){return a.__proto__=r,a}Qi({},Qi.prototype)instanceof Qi||(Qi=function(r,i){function e(){}e.prototype=i,e=new e;for(i in r)e[i]=r[i];return e});function jd(a,r){var i,e=[],t=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(t.lastIndex=r,t.exec(a);i=t.exec(a);)if(e.push(i),i[1])return e}var Vd=$u,Hd={XMLReader:Vd};function ui(a,r){for(var i in a)r[i]=a[i]}function Ue(a,r){var i=a.prototype;if(Object.create){var e=Object.create(r.prototype);i.__proto__=e}if(!(i instanceof r)){var t=function(){};t.prototype=r.prototype,t=new t,ui(i,t),a.prototype=i=t}i.constructor!=a&&(typeof a!="function"&&console.error("unknow Class:"+a),i.constructor=a)}var Wd="http://www.w3.org/1999/xhtml",Fe={},ot=Fe.ELEMENT_NODE=1,Sr=Fe.ATTRIBUTE_NODE=2,Ji=Fe.TEXT_NODE=3,el=Fe.CDATA_SECTION_NODE=4,tl=Fe.ENTITY_REFERENCE_NODE=5,Gd=Fe.ENTITY_NODE=6,rl=Fe.PROCESSING_INSTRUCTION_NODE=7,il=Fe.COMMENT_NODE=8,nl=Fe.DOCUMENT_NODE=9,al=Fe.DOCUMENT_TYPE_NODE=10,Tt=Fe.DOCUMENT_FRAGMENT_NODE=11,qd=Fe.NOTATION_NODE=12,ke={},Se={},G0=ke.INDEX_SIZE_ERR=(Se[1]="Index size error",1),q0=ke.DOMSTRING_SIZE_ERR=(Se[2]="DOMString size error",2),zd=ke.HIERARCHY_REQUEST_ERR=(Se[3]="Hierarchy request error",3),z0=ke.WRONG_DOCUMENT_ERR=(Se[4]="Wrong document",4),K0=ke.INVALID_CHARACTER_ERR=(Se[5]="Invalid character",5),X0=ke.NO_DATA_ALLOWED_ERR=(Se[6]="No data allowed",6),$0=ke.NO_MODIFICATION_ALLOWED_ERR=(Se[7]="No modification allowed",7),Kd=ke.NOT_FOUND_ERR=(Se[8]="Not found",8),Y0=ke.NOT_SUPPORTED_ERR=(Se[9]="Not supported",9),sl=ke.INUSE_ATTRIBUTE_ERR=(Se[10]="Attribute in use",10),Q0=ke.INVALID_STATE_ERR=(Se[11]="Invalid state",11),J0=ke.SYNTAX_ERR=(Se[12]="Syntax error",12),Z0=ke.INVALID_MODIFICATION_ERR=(Se[13]="Invalid modification",13),e_=ke.NAMESPACE_ERR=(Se[14]="Invalid namespace",14),t_=ke.INVALID_ACCESS_ERR=(Se[15]="Invalid access",15);function Er(a,r){if(r instanceof Error)var i=r;else i=this,Error.call(this,Se[a]),this.message=Se[a],Error.captureStackTrace&&Error.captureStackTrace(this,Er);return i.code=a,r&&(this.message=this.message+": "+r),i}Er.prototype=Error.prototype,ui(ke,Er);function wt(){}wt.prototype={length:0,item:function(r){return this[r]||null},toString:function(r,i){for(var e=[],t=0;t<this.length;t++)kr(this[t],e,r,i);return e.join("")}};function li(a,r){this._node=a,this._refresh=r,$a(this)}function $a(a){var r=a._node._inc||a._node.ownerDocument._inc;if(a._inc!=r){var i=a._refresh(a._node);bl(a,"length",i.length),ui(i,a),a._inc=r}}li.prototype.item=function(a){return $a(this),this[a]},Ue(li,wt);function Zi(){}function ol(a,r){for(var i=a.length;i--;)if(a[i]===r)return i}function ul(a,r,i,e){if(e?r[ol(r,e)]=i:r[r.length++]=i,a){i.ownerElement=a;var t=a.ownerDocument;t&&(e&&hl(t,a,e),Xd(t,a,i))}}function ll(a,r,i){var e=ol(r,i);if(e>=0){for(var t=r.length-1;e<t;)r[e]=r[++e];if(r.length=t,a){var n=a.ownerDocument;n&&(hl(n,a,i),i.ownerElement=null)}}else throw Er(Kd,new Error(a.tagName+"@"+i))}Zi.prototype={length:0,item:wt.prototype.item,getNamedItem:function(r){for(var i=this.length;i--;){var e=this[i];if(e.nodeName==r)return e}},setNamedItem:function(r){var i=r.ownerElement;if(i&&i!=this._ownerElement)throw new Er(sl);var e=this.getNamedItem(r.nodeName);return ul(this._ownerElement,this,r,e),e},setNamedItemNS:function(r){var i=r.ownerElement,e;if(i&&i!=this._ownerElement)throw new Er(sl);return e=this.getNamedItemNS(r.namespaceURI,r.localName),ul(this._ownerElement,this,r,e),e},removeNamedItem:function(r){var i=this.getNamedItem(r);return ll(this._ownerElement,this,i),i},removeNamedItemNS:function(r,i){var e=this.getNamedItemNS(r,i);return ll(this._ownerElement,this,e),e},getNamedItemNS:function(r,i){for(var e=this.length;e--;){var t=this[e];if(t.localName==i&&t.namespaceURI==r)return t}return null}};function cl(a){if(this._features={},a)for(var r in a)this._features=a[r]}cl.prototype={hasFeature:function(r,i){var e=this._features[r.toLowerCase()];return!!(e&&(!i||i in e))},createDocument:function(r,i,e){var t=new ci;if(t.implementation=this,t.childNodes=new wt,t.doctype=e,e&&t.appendChild(e),i){var n=t.createElementNS(r,i);t.appendChild(n)}return t},createDocumentType:function(r,i,e){var t=new es;return t.name=r,t.nodeName=r,t.publicId=i,t.systemId=e,t}};function Oe(){}Oe.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(r,i){return pl(this,r,i)},replaceChild:function(r,i){this.insertBefore(r,i),i&&this.removeChild(i)},removeChild:function(r){return dl(this,r)},appendChild:function(r){return this.insertBefore(r,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(r){return is(this.ownerDocument||this,this,r)},normalize:function(){for(var r=this.firstChild;r;){var i=r.nextSibling;i&&i.nodeType==Ji&&r.nodeType==Ji?(this.removeChild(i),r.appendData(i.data)):(r.normalize(),r=i)}},isSupported:function(r,i){return this.ownerDocument.implementation.hasFeature(r,i)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(r){for(var i=this;i;){var e=i._nsMap;if(e){for(var t in e)if(e[t]==r)return t}i=i.nodeType==Sr?i.ownerDocument:i.parentNode}return null},lookupNamespaceURI:function(r){for(var i=this;i;){var e=i._nsMap;if(e&&r in e)return e[r];i=i.nodeType==Sr?i.ownerDocument:i.parentNode}return null},isDefaultNamespace:function(r){var i=this.lookupPrefix(r);return i==null}};function fl(a){return a=="<"&&"&lt;"||a==">"&&"&gt;"||a=="&"&&"&amp;"||a=='"'&&"&quot;"||"&#"+a.charCodeAt()+";"}ui(Fe,Oe),ui(Fe,Oe.prototype);function en(a,r){if(r(a))return!0;if(a=a.firstChild)do if(en(a,r))return!0;while(a=a.nextSibling)}function ci(){}function Xd(a,r,i){a&&a._inc++;var e=i.namespaceURI;e=="http://www.w3.org/2000/xmlns/"&&(r._nsMap[i.prefix?i.localName:""]=i.value)}function hl(a,r,i,e){a&&a._inc++;var t=i.namespaceURI;t=="http://www.w3.org/2000/xmlns/"&&delete r._nsMap[i.prefix?i.localName:""]}function Ya(a,r,i){if(a&&a._inc){a._inc++;var e=r.childNodes;if(i)e[e.length++]=i;else{for(var t=r.firstChild,n=0;t;)e[n++]=t,t=t.nextSibling;e.length=n}}}function dl(a,r){var i=r.previousSibling,e=r.nextSibling;return i?i.nextSibling=e:a.firstChild=e,e?e.previousSibling=i:a.lastChild=i,Ya(a.ownerDocument,a),r}function pl(a,r,i){var e=r.parentNode;if(e&&e.removeChild(r),r.nodeType===Tt){var t=r.firstChild;if(t==null)return r;var n=r.lastChild}else t=n=r;var s=i?i.previousSibling:a.lastChild;t.previousSibling=s,n.nextSibling=i,s?s.nextSibling=t:a.firstChild=t,i==null?a.lastChild=n:i.previousSibling=n;do t.parentNode=a;while(t!==n&&(t=t.nextSibling));return Ya(a.ownerDocument||a,a),r.nodeType==Tt&&(r.firstChild=r.lastChild=null),r}function $d(a,r){var i=r.parentNode;if(i){var e=a.lastChild;i.removeChild(r);var e=a.lastChild}var e=a.lastChild;return r.parentNode=a,r.previousSibling=e,r.nextSibling=null,e?e.nextSibling=r:a.firstChild=r,a.lastChild=r,Ya(a.ownerDocument,a,r),r}ci.prototype={nodeName:"#document",nodeType:nl,doctype:null,documentElement:null,_inc:1,insertBefore:function(r,i){if(r.nodeType==Tt){for(var e=r.firstChild;e;){var t=e.nextSibling;this.insertBefore(e,i),e=t}return r}return this.documentElement==null&&r.nodeType==ot&&(this.documentElement=r),pl(this,r,i),r.ownerDocument=this,r},removeChild:function(r){return this.documentElement==r&&(this.documentElement=null),dl(this,r)},importNode:function(r,i){return Tl(this,r,i)},getElementById:function(r){var i=null;return en(this.documentElement,function(e){if(e.nodeType==ot&&e.getAttribute("id")==r)return i=e,!0}),i},createElement:function(r){var i=new Cr;i.ownerDocument=this,i.nodeName=r,i.tagName=r,i.childNodes=new wt;var e=i.attributes=new Zi;return e._ownerElement=i,i},createDocumentFragment:function(){var r=new rn;return r.ownerDocument=this,r.childNodes=new wt,r},createTextNode:function(r){var i=new Qa;return i.ownerDocument=this,i.appendData(r),i},createComment:function(r){var i=new Ja;return i.ownerDocument=this,i.appendData(r),i},createCDATASection:function(r){var i=new Za;return i.ownerDocument=this,i.appendData(r),i},createProcessingInstruction:function(r,i){var e=new rs;return e.ownerDocument=this,e.tagName=e.target=r,e.nodeValue=e.data=i,e},createAttribute:function(r){var i=new tn;return i.ownerDocument=this,i.name=r,i.nodeName=r,i.localName=r,i.specified=!0,i},createEntityReference:function(r){var i=new ts;return i.ownerDocument=this,i.nodeName=r,i},createElementNS:function(r,i){var e=new Cr,t=i.split(":"),n=e.attributes=new Zi;return e.childNodes=new wt,e.ownerDocument=this,e.nodeName=i,e.tagName=i,e.namespaceURI=r,t.length==2?(e.prefix=t[0],e.localName=t[1]):e.localName=i,n._ownerElement=e,e},createAttributeNS:function(r,i){var e=new tn,t=i.split(":");return e.ownerDocument=this,e.nodeName=i,e.name=i,e.namespaceURI=r,e.specified=!0,t.length==2?(e.prefix=t[0],e.localName=t[1]):e.localName=i,e}},Ue(ci,Oe);function Cr(){this._nsMap={}}Cr.prototype={nodeType:ot,hasAttribute:function(r){return this.getAttributeNode(r)!=null},getAttribute:function(r){var i=this.getAttributeNode(r);return i&&i.value||""},getAttributeNode:function(r){return this.attributes.getNamedItem(r)},setAttribute:function(r,i){var e=this.ownerDocument.createAttribute(r);e.value=e.nodeValue=""+i,this.setAttributeNode(e)},removeAttribute:function(r){var i=this.getAttributeNode(r);i&&this.removeAttributeNode(i)},appendChild:function(r){return r.nodeType===Tt?this.insertBefore(r,null):$d(this,r)},setAttributeNode:function(r){return this.attributes.setNamedItem(r)},setAttributeNodeNS:function(r){return this.attributes.setNamedItemNS(r)},removeAttributeNode:function(r){return this.attributes.removeNamedItem(r.nodeName)},removeAttributeNS:function(r,i){var e=this.getAttributeNodeNS(r,i);e&&this.removeAttributeNode(e)},hasAttributeNS:function(r,i){return this.getAttributeNodeNS(r,i)!=null},getAttributeNS:function(r,i){var e=this.getAttributeNodeNS(r,i);return e&&e.value||""},setAttributeNS:function(r,i,e){var t=this.ownerDocument.createAttributeNS(r,i);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},getAttributeNodeNS:function(r,i){return this.attributes.getNamedItemNS(r,i)},getElementsByTagName:function(r){return new li(this,function(i){var e=[];return en(i,function(t){t!==i&&t.nodeType==ot&&(r==="*"||t.tagName==r)&&e.push(t)}),e})},getElementsByTagNameNS:function(r,i){return new li(this,function(e){var t=[];return en(e,function(n){n!==e&&n.nodeType===ot&&(r==="*"||n.namespaceURI===r)&&(i==="*"||n.localName==i)&&t.push(n)}),t})}},ci.prototype.getElementsByTagName=Cr.prototype.getElementsByTagName,ci.prototype.getElementsByTagNameNS=Cr.prototype.getElementsByTagNameNS,Ue(Cr,Oe);function tn(){}tn.prototype.nodeType=Sr,Ue(tn,Oe);function fi(){}fi.prototype={data:"",substringData:function(r,i){return this.data.substring(r,r+i)},appendData:function(r){r=this.data+r,this.nodeValue=this.data=r,this.length=r.length},insertData:function(r,i){this.replaceData(r,0,i)},appendChild:function(r){throw new Error(Se[zd])},deleteData:function(r,i){this.replaceData(r,i,"")},replaceData:function(r,i,e){var t=this.data.substring(0,r),n=this.data.substring(r+i);e=t+e+n,this.nodeValue=this.data=e,this.length=e.length}},Ue(fi,Oe);function Qa(){}Qa.prototype={nodeName:"#text",nodeType:Ji,splitText:function(r){var i=this.data,e=i.substring(r);i=i.substring(0,r),this.data=this.nodeValue=i,this.length=i.length;var t=this.ownerDocument.createTextNode(e);return this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling),t}},Ue(Qa,fi);function Ja(){}Ja.prototype={nodeName:"#comment",nodeType:il},Ue(Ja,fi);function Za(){}Za.prototype={nodeName:"#cdata-section",nodeType:el},Ue(Za,fi);function es(){}es.prototype.nodeType=al,Ue(es,Oe);function ml(){}ml.prototype.nodeType=qd,Ue(ml,Oe);function vl(){}vl.prototype.nodeType=Gd,Ue(vl,Oe);function ts(){}ts.prototype.nodeType=tl,Ue(ts,Oe);function rn(){}rn.prototype.nodeName="#document-fragment",rn.prototype.nodeType=Tt,Ue(rn,Oe);function rs(){}rs.prototype.nodeType=rl,Ue(rs,Oe);function gl(){}gl.prototype.serializeToString=function(a,r,i){return _l.call(a,r,i)},Oe.prototype.toString=_l;function _l(a,r){var i=[],e=this.nodeType==9?this.documentElement:this,t=e.prefix,n=e.namespaceURI;if(n&&t==null){var t=e.lookupPrefix(n);if(t==null)var s=[{namespace:n,prefix:null}]}return kr(this,i,a,r,s),i.join("")}function yl(a,r,i){var e=a.prefix||"",t=a.namespaceURI;if(!e&&!t||e==="xml"&&t==="http://www.w3.org/XML/1998/namespace"||t=="http://www.w3.org/2000/xmlns/")return!1;for(var n=i.length;n--;){var s=i[n];if(s.prefix==e)return s.namespace!=t}return!0}function kr(a,r,i,e,t){if(e)if(a=e(a),a){if(typeof a=="string"){r.push(a);return}}else return;switch(a.nodeType){case ot:t||(t=[]);var n=t.length,s=a.attributes,o=s.length,_=a.firstChild,u=a.tagName;i=Wd===a.namespaceURI||i,r.push("<",u);for(var l=0;l<o;l++){var c=s.item(l);c.prefix=="xmlns"?t.push({prefix:c.localName,namespace:c.value}):c.nodeName=="xmlns"&&t.push({prefix:"",namespace:c.value})}for(var l=0;l<o;l++){var c=s.item(l);if(yl(c,i,t)){var f=c.prefix||"",d=c.namespaceURI,m=f?" xmlns:"+f:" xmlns";r.push(m,'="',d,'"'),t.push({prefix:f,namespace:d})}kr(c,r,i,e,t)}if(yl(a,i,t)){var f=a.prefix||"",d=a.namespaceURI,m=f?" xmlns:"+f:" xmlns";r.push(m,'="',d,'"'),t.push({prefix:f,namespace:d})}if(_||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(r.push(">"),i&&/^script$/i.test(u))for(;_;)_.data?r.push(_.data):kr(_,r,i,e,t),_=_.nextSibling;else for(;_;)kr(_,r,i,e,t),_=_.nextSibling;r.push("</",u,">")}else r.push("/>");return;case nl:case Tt:for(var _=a.firstChild;_;)kr(_,r,i,e,t),_=_.nextSibling;return;case Sr:return r.push(" ",a.name,'="',a.value.replace(/[<&"]/g,fl),'"');case Ji:return r.push(a.data.replace(/[<&]/g,fl));case el:return r.push("<![CDATA[",a.data,"]]>");case il:return r.push("<!--",a.data,"-->");case al:var b=a.publicId,A=a.systemId;if(r.push("<!DOCTYPE ",a.name),b)r.push(' PUBLIC "',b),A&&A!="."&&r.push('" "',A),r.push('">');else if(A&&A!=".")r.push(' SYSTEM "',A,'">');else{var I=a.internalSubset;I&&r.push(" [",I,"]"),r.push(">")}return;case rl:return r.push("<?",a.target," ",a.data,"?>");case tl:return r.push("&",a.nodeName,";");default:r.push("??",a.nodeName)}}function Tl(a,r,i){var e;switch(r.nodeType){case ot:e=r.cloneNode(!1),e.ownerDocument=a;case Tt:break;case Sr:i=!0;break}if(e||(e=r.cloneNode(!1)),e.ownerDocument=a,e.parentNode=null,i)for(var t=r.firstChild;t;)e.appendChild(Tl(a,t,i)),t=t.nextSibling;return e}function is(a,r,i){var e=new r.constructor;for(var t in r){var n=r[t];typeof n!="object"&&n!=e[t]&&(e[t]=n)}switch(r.childNodes&&(e.childNodes=new wt),e.ownerDocument=a,e.nodeType){case ot:var s=r.attributes,o=e.attributes=new Zi,u=s.length;o._ownerElement=e;for(var l=0;l<u;l++)e.setAttributeNode(is(a,s.item(l),!0));break;case Sr:i=!0}if(i)for(var c=r.firstChild;c;)e.appendChild(is(a,c,i)),c=c.nextSibling;return e}function bl(a,r,i){a[r]=i}try{if(Object.defineProperty){var Yd=function a(r){switch(r.nodeType){case ot:case Tt:var i=[];for(r=r.firstChild;r;)r.nodeType!==7&&r.nodeType!==8&&i.push(a(r)),r=r.nextSibling;return i.join("");default:return r.nodeValue}};Object.defineProperty(li.prototype,"length",{get:function(){return $a(this),this.$$length}}),Object.defineProperty(Oe.prototype,"textContent",{get:function(){return Yd(this)},set:function(r){switch(this.nodeType){case ot:case Tt:for(;this.firstChild;)this.removeChild(this.firstChild);(r||String(r))&&this.appendChild(this.ownerDocument.createTextNode(r));break;default:this.data=r,this.value=r,this.nodeValue=r}}}),bl=function(r,i,e){r["$$"+i]=e}}}catch{}var Qd=cl,Jd=gl,xl={DOMImplementation:Qd,XMLSerializer:Jd},ns=pt(function(a,r){function i(f){this.options=f||{locator:{}}}i.prototype.parseFromString=function(f,d){var m=this.options,_=new l,b=m.domBuilder||new t,A=m.errorHandler,I=m.locator,D=m.xmlns||{},O={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return I&&b.setDocumentLocator(I),_.errorHandler=e(A,b,I),_.domBuilder=m.domBuilder||b,/\/x?html?$/.test(d)&&(O.nbsp="\xA0",O.copy="\xA9",D[""]="http://www.w3.org/1999/xhtml"),D.xml=D.xml||"http://www.w3.org/XML/1998/namespace",f?_.parse(f,D,O):_.errorHandler.error("invalid doc source"),b.doc};function e(f,d,m){if(!f){if(d instanceof t)return d;f=d}var _={},b=f instanceof Function;m=m||{};function A(I){var D=f[I];!D&&b&&(D=f.length==2?function(O){f(I,O)}:f),_[I]=D&&function(O){D("[xmldom "+I+"]	"+O+s(m))}||function(){}}return A("warning"),A("error"),A("fatalError"),_}function t(){this.cdata=!1}function n(f,d){d.lineNumber=f.lineNumber,d.columnNumber=f.columnNumber}t.prototype={startDocument:function(){this.doc=new c().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(d,m,_,b){var A=this.doc,I=A.createElementNS(d,_||m),D=b.length;u(this,I),this.currentElement=I,this.locator&&n(this.locator,I);for(var O=0;O<D;O++){var d=b.getURI(O),M=b.getValue(O),_=b.getQName(O),U=A.createAttributeNS(d,_);this.locator&&n(b.getLocator(O),U),U.value=U.nodeValue=M,I.setAttributeNode(U)}},endElement:function(d,m,_){var b=this.currentElement,A=b.tagName;this.currentElement=b.parentNode},startPrefixMapping:function(d,m){},endPrefixMapping:function(d){},processingInstruction:function(d,m){var _=this.doc.createProcessingInstruction(d,m);this.locator&&n(this.locator,_),u(this,_)},ignorableWhitespace:function(d,m,_){},characters:function(d,m,_){if(d=o.apply(this,arguments),d){if(this.cdata)var b=this.doc.createCDATASection(d);else var b=this.doc.createTextNode(d);this.currentElement?this.currentElement.appendChild(b):/^\s*$/.test(d)&&this.doc.appendChild(b),this.locator&&n(this.locator,b)}},skippedEntity:function(d){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(d){(this.locator=d)&&(d.lineNumber=0)},comment:function(d,m,_){d=o.apply(this,arguments);var b=this.doc.createComment(d);this.locator&&n(this.locator,b),u(this,b)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(d,m,_){var b=this.doc.implementation;if(b&&b.createDocumentType){var A=b.createDocumentType(d,m,_);this.locator&&n(this.locator,A),u(this,A)}},warning:function(d){console.warn("[xmldom warning]	"+d,s(this.locator))},error:function(d){console.error("[xmldom error]	"+d,s(this.locator))},fatalError:function(d){throw console.error("[xmldom fatalError]	"+d,s(this.locator)),d}};function s(f){if(f)return`
@`+(f.systemId||"")+"#[line:"+f.lineNumber+",col:"+f.columnNumber+"]"}function o(f,d,m){return typeof f=="string"?f.substr(d,m):f.length>=d+m||d?new java.lang.String(f,d,m)+"":f}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(f){t.prototype[f]=function(){return null}});function u(f,d){f.currentElement?f.currentElement.appendChild(d):f.doc.appendChild(d)}var l=Hd.XMLReader,c=r.DOMImplementation=xl.DOMImplementation;r.XMLSerializer=xl.XMLSerializer,r.DOMParser=i}),r_=ns.DOMImplementation,i_=ns.XMLSerializer,Zd=ns.DOMParser;/*! @name mpd-parser @version 0.10.0 @license Apache-2.0 */var Sl=function(r){return!!r&&typeof r=="object"},Ge=function a(){for(var r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];return i.reduce(function(t,n){return Object.keys(n).forEach(function(s){Array.isArray(t[s])&&Array.isArray(n[s])?t[s]=t[s].concat(n[s]):Sl(t[s])&&Sl(n[s])?t[s]=a(t[s],n[s]):t[s]=n[s]}),t},{})},ep=function(r){return Object.keys(r).map(function(i){return r[i]})},tp=function(r,i){for(var e=[],t=r;t<i;t++)e.push(t);return e},nn=function(r){return r.reduce(function(i,e){return i.concat(e)},[])},El=function(r){if(!r.length)return[];for(var i=[],e=0;e<r.length;e++)i.push(r[e]);return i},rp=function(r,i){return r.reduce(function(e,t,n){return t[i]&&e.push(n),e},[])},Ar={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},hi=function(r){var i=r.baseUrl,e=i===void 0?"":i,t=r.source,n=t===void 0?"":t,s=r.range,o=s===void 0?"":s,u=r.indexRange,l=u===void 0?"":u,c={uri:n,resolvedUri:Ka(e||"",n)};if(o||l){var f=o||l,d=f.split("-"),m=parseInt(d[0],10),_=parseInt(d[1],10);c.byterange={length:_-m+1,offset:m}}return c},ip=function(r){var i=r.offset+r.length-1;return r.offset+"-"+i},np={static:function(r){var i=r.duration,e=r.timescale,t=e===void 0?1:e,n=r.sourceDuration;return{start:0,end:Math.ceil(n/(i/t))}},dynamic:function(r){var i=r.NOW,e=r.clientOffset,t=r.availabilityStartTime,n=r.timescale,s=n===void 0?1:n,o=r.duration,u=r.start,l=u===void 0?0:u,c=r.minimumUpdatePeriod,f=c===void 0?0:c,d=r.timeShiftBufferDepth,m=d===void 0?1/0:d,_=(i+e)/1e3,b=t+l,A=_+f,I=A-b,D=Math.ceil(I*s/o),O=Math.floor((_-b-m)*s/o),M=Math.floor((_-b)*s/o);return{start:Math.max(0,O),end:Math.min(D,M)}}},ap=function(r){return function(i,e){var t=r.duration,n=r.timescale,s=n===void 0?1:n,o=r.periodIndex,u=r.startNumber,l=u===void 0?1:u;return{number:l+i,duration:t/s,timeline:o,time:e*t}}},as=function(r){var i=r.type,e=i===void 0?"static":i,t=r.duration,n=r.timescale,s=n===void 0?1:n,o=r.sourceDuration,u=np[e](r),l=u.start,c=u.end,f=tp(l,c).map(ap(r));if(e==="static"){var d=f.length-1;f[d].duration=o-t/s*d}return f},Cl=function(r){var i=r.baseUrl,e=r.initialization,t=e===void 0?{}:e,n=r.sourceDuration,s=r.timescale,o=s===void 0?1:s,u=r.indexRange,l=u===void 0?"":u,c=r.duration;if(!i)throw new Error(Ar.NO_BASE_URL);var f=hi({baseUrl:i,source:t.sourceURL,range:t.range}),d=hi({baseUrl:i,source:i,indexRange:l});if(d.map=f,c){var m=as(r);m.length&&(d.duration=m[0].duration,d.timeline=m[0].timeline)}else n&&(d.duration=n/o,d.timeline=0);return d.number=0,[d]},sp=function(r,i,e){for(var t=r.sidx.map?r.sidx.map:null,n=r.sidx.duration,s=r.timeline||0,o=r.sidx.byterange,u=o.offset+o.length,l=i.timescale,c=i.references.filter(function(U){return U.referenceType!==1}),f=[],d=u+i.firstOffset,m=0;m<c.length;m++){var _=i.references[m],b=_.referencedSize,A=_.subsegmentDuration,I=d+b-1,D=d+"-"+I,O={baseUrl:e,timescale:l,timeline:s,periodIndex:s,duration:A,sourceDuration:n,indexRange:D},M=Cl(O)[0];t&&(M.map=t),f.push(M),d+=b}return r.segments=f,r},kl=function(r){var i=ep(r.reduce(function(e,t){var n=t.attributes.id+(t.attributes.lang||"");if(e[n]){var s;t.segments[0]&&(t.segments[0].discontinuity=!0),(s=e[n].segments).push.apply(s,t.segments),t.attributes.contentProtection&&(e[n].attributes.contentProtection=t.attributes.contentProtection)}else e[n]=t;return e},{}));return i.map(function(e){return e.discontinuityStarts=rp(e.segments,"discontinuity"),e})},ss=function(r,i){if(i===void 0&&(i={}),!Object.keys(i).length)return r;for(var e in r){var t=r[e];if(t.sidx){var n=t.sidx.uri+"-"+ip(t.sidx.byterange),s=i[n]&&i[n].sidx;t.sidx&&s&&sp(t,s,t.sidx.resolvedUri)}}return r},op=function(r){var i,e=r.attributes,t=r.segments,n=r.sidx,s={attributes:(i={NAME:e.id,BANDWIDTH:e.bandwidth,CODECS:e.codecs},i["PROGRAM-ID"]=1,i),uri:"",endList:(e.type||"static")==="static",timeline:e.periodIndex,resolvedUri:"",targetDuration:e.duration,segments:t,mediaSequence:t.length?t[0].number:1};return e.contentProtection&&(s.contentProtection=e.contentProtection),n&&(s.sidx=n),s},up=function(r){var i,e=r.attributes,t=r.segments;return typeof t>"u"&&(t=[{uri:e.baseUrl,timeline:e.periodIndex,resolvedUri:e.baseUrl||"",duration:e.sourceDuration,number:0}],e.duration=e.sourceDuration),{attributes:(i={NAME:e.id,BANDWIDTH:e.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:(e.type||"static")==="static",timeline:e.periodIndex,resolvedUri:e.baseUrl||"",targetDuration:e.duration,segments:t,mediaSequence:t.length?t[0].number:1}},lp=function(r,i){i===void 0&&(i={});var e,t=r.reduce(function(s,o){var u=o.attributes.role&&o.attributes.role.value||"",l=o.attributes.lang||"",c="main";if(l){var f=u?" ("+u+")":"";c=""+o.attributes.lang+f}return s[c]&&s[c].playlists[0].attributes.BANDWIDTH>o.attributes.bandwidth||(s[c]={language:l,autoselect:!0,default:u==="main",playlists:ss([op(o)],i),uri:""},typeof e>"u"&&u==="main"&&(e=o,e.default=!0)),s},{});if(!e){var n=Object.keys(t)[0];t[n].default=!0}return t},cp=function(r,i){return i===void 0&&(i={}),r.reduce(function(e,t){var n=t.attributes.lang||"text";return e[n]||(e[n]={language:n,default:!1,autoselect:!1,playlists:ss([up(t)],i),uri:""}),e},{})},fp=function(r){var i,e=r.attributes,t=r.segments,n=r.sidx,s={attributes:(i={NAME:e.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:e.width,height:e.height},CODECS:e.codecs,BANDWIDTH:e.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:(e.type||"static")==="static",timeline:e.periodIndex,resolvedUri:"",targetDuration:e.duration,segments:t,mediaSequence:t.length?t[0].number:1};return e.contentProtection&&(s.contentProtection=e.contentProtection),n&&(s.sidx=n),s},hp=function(r,i){var e;if(i===void 0&&(i={}),!r.length)return{};var t=r[0].attributes,n=t.sourceDuration,s=t.type,o=s===void 0?"static":s,u=t.suggestedPresentationDelay,l=t.minimumUpdatePeriod,c=l===void 0?0:l,f=function(O){var M=O.attributes;return M.mimeType==="video/mp4"||M.contentType==="video"},d=function(O){var M=O.attributes;return M.mimeType==="audio/mp4"||M.contentType==="audio"},m=function(O){var M=O.attributes;return M.mimeType==="text/vtt"||M.contentType==="text"},_=kl(r.filter(f)).map(fp),b=kl(r.filter(d)),A=r.filter(m),I={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(e={AUDIO:{},VIDEO:{}},e["CLOSED-CAPTIONS"]={},e.SUBTITLES={},e),uri:"",duration:n,playlists:ss(_,i),minimumUpdatePeriod:c*1e3};return o==="dynamic"&&(I.suggestedPresentationDelay=u),b.length&&(I.mediaGroups.AUDIO.audio=lp(b,i)),A.length&&(I.mediaGroups.SUBTITLES.subs=cp(A,i)),I},dp=function(r,i,e){var t=r.NOW,n=r.clientOffset,s=r.availabilityStartTime,o=r.timescale,u=o===void 0?1:o,l=r.start,c=l===void 0?0:l,f=r.minimumUpdatePeriod,d=f===void 0?0:f,m=(t+n)/1e3,_=s+c,b=m+d,A=b-_;return Math.ceil((A*u-i)/e)},Al=function(r,i){for(var e=r.type,t=e===void 0?"static":e,n=r.minimumUpdatePeriod,s=n===void 0?0:n,o=r.media,u=o===void 0?"":o,l=r.sourceDuration,c=r.timescale,f=c===void 0?1:c,d=r.startNumber,m=d===void 0?1:d,_=r.periodIndex,b=[],A=-1,I=0;I<i.length;I++){var D=i[I],O=D.d,M=D.r||0,U=D.t||0;A<0&&(A=U),U&&U>A&&(A=U);var R=void 0;if(M<0){var j=I+1;j===i.length?t==="dynamic"&&s>0&&u.indexOf("$Number$")>0?R=dp(r,A,O):R=(l*f-A)/O:R=(i[j].t-A)/O}else R=M+1;for(var G=m+b.length+R,Q=m+b.length;Q<G;)b.push({number:Q,duration:O/f,time:A,timeline:_}),A+=O,Q++}return b},pp=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,mp=function(r){return function(i,e,t,n){if(i==="$$")return"$";if(typeof r[e]>"u")return i;var s=""+r[e];return e==="RepresentationID"||(t?n=parseInt(n,10):n=1,s.length>=n)?s:""+new Array(n-s.length+1).join("0")+s}},Pl=function(r,i){return r.replace(pp,mp(i))},vp=function(r,i){return!r.duration&&!i?[{number:r.startNumber||1,duration:r.sourceDuration,time:0,timeline:r.periodIndex}]:r.duration?as(r):Al(r,i)},gp=function(r,i){var e={RepresentationID:r.id,Bandwidth:r.bandwidth||0},t=r.initialization,n=t===void 0?{sourceURL:"",range:""}:t,s=hi({baseUrl:r.baseUrl,source:Pl(n.sourceURL,e),range:n.range}),o=vp(r,i);return o.map(function(u){e.Number=u.number,e.Time=u.time;var l=Pl(r.media||"",e);return{uri:l,timeline:u.timeline,duration:u.duration,resolvedUri:Ka(r.baseUrl||"",l),map:s,number:u.number}})},_p=function(r,i){var e=r.baseUrl,t=r.initialization,n=t===void 0?{}:t,s=hi({baseUrl:e,source:n.sourceURL,range:n.range}),o=hi({baseUrl:e,source:i.media,range:i.mediaRange});return o.map=s,o},yp=function(r,i){var e=r.duration,t=r.segmentUrls,n=t===void 0?[]:t;if(!e&&!i||e&&i)throw new Error(Ar.SEGMENT_TIME_UNSPECIFIED);var s=n.map(function(l){return _p(r,l)}),o;e&&(o=as(r)),i&&(o=Al(r,i));var u=o.map(function(l,c){if(s[c]){var f=s[c];return f.timeline=l.timeline,f.duration=l.duration,f.number=l.number,f}}).filter(function(l){return l});return u},Tp=function(r){var i=r.attributes,e=r.segmentInfo,t,n;e.template?(n=gp,t=Ge(i,e.template)):e.base?(n=Cl,t=Ge(i,e.base)):e.list&&(n=yp,t=Ge(i,e.list));var s={attributes:i};if(!n)return s;var o=n(t,e.timeline);if(t.duration){var u=t,l=u.duration,c=u.timescale,f=c===void 0?1:c;t.duration=l/f}else o.length?t.duration=o.reduce(function(d,m){return Math.max(d,Math.ceil(m.duration))},0):t.duration=0;return s.attributes=t,s.segments=o,e.base&&t.indexRange&&(s.sidx=o[0],s.segments=[]),s},bp=function(r){return r.map(Tp)},Ee=function(r,i){return El(r.childNodes).filter(function(e){var t=e.tagName;return t===i})},Il=function(r){return r.textContent.trim()},Pr=function(r){var i=31536e3,e=30*24*60*60,t=24*60*60,n=60*60,s=60,o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/,u=o.exec(r);if(!u)return 0;var l=u.slice(1),c=l[0],f=l[1],d=l[2],m=l[3],_=l[4],b=l[5];return parseFloat(c||0)*i+parseFloat(f||0)*e+parseFloat(d||0)*t+parseFloat(m||0)*n+parseFloat(_||0)*s+parseFloat(b||0)},xp=function(r){var i=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;return i.test(r)&&(r+="Z"),Date.parse(r)},Dl={mediaPresentationDuration:function(r){return Pr(r)},availabilityStartTime:function(r){return xp(r)/1e3},minimumUpdatePeriod:function(r){return Pr(r)},suggestedPresentationDelay:function(r){return Pr(r)},type:function(r){return r},timeShiftBufferDepth:function(r){return Pr(r)},start:function(r){return Pr(r)},width:function(r){return parseInt(r,10)},height:function(r){return parseInt(r,10)},bandwidth:function(r){return parseInt(r,10)},startNumber:function(r){return parseInt(r,10)},timescale:function(r){return parseInt(r,10)},duration:function(r){var i=parseInt(r,10);return isNaN(i)?Pr(r):i},d:function(r){return parseInt(r,10)},t:function(r){return parseInt(r,10)},r:function(r){return parseInt(r,10)},DEFAULT:function(r){return r}},Le=function(r){return r&&r.attributes?El(r.attributes).reduce(function(i,e){var t=Dl[e.name]||Dl.DEFAULT;return i[e.name]=t(e.value),i},{}):{}},Sp={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},an=function(r,i){return i.length?nn(r.map(function(e){return i.map(function(t){return Ka(e,Il(t))})})):r},os=function(r){var i=Ee(r,"SegmentTemplate")[0],e=Ee(r,"SegmentList")[0],t=e&&Ee(e,"SegmentURL").map(function(d){return Ge({tag:"SegmentURL"},Le(d))}),n=Ee(r,"SegmentBase")[0],s=e||i,o=s&&Ee(s,"SegmentTimeline")[0],u=e||n||i,l=u&&Ee(u,"Initialization")[0],c=i&&Le(i);c&&l?c.initialization=l&&Le(l):c&&c.initialization&&(c.initialization={sourceURL:c.initialization});var f={template:c,timeline:o&&Ee(o,"S").map(function(d){return Le(d)}),list:e&&Ge(Le(e),{segmentUrls:t,initialization:Le(l)}),base:n&&Ge(Le(n),{initialization:Le(l)})};return Object.keys(f).forEach(function(d){f[d]||delete f[d]}),f},Ep=function(r,i,e){return function(t){var n=Ee(t,"BaseURL"),s=an(i,n),o=Ge(r,Le(t)),u=os(t);return s.map(function(l){return{segmentInfo:Ge(e,u),attributes:Ge(o,{baseUrl:l})}})}},Cp=function(r){return r.reduce(function(i,e){var t=Le(e),n=Sp[t.schemeIdUri];if(n){i[n]={attributes:t};var s=Ee(e,"cenc:pssh")[0];if(s){var o=Il(s),u=o&&Ld(o);i[n].pssh=u}}return i},{})},kp=function(r,i,e){return function(t){var n=Le(t),s=an(i,Ee(t,"BaseURL")),o=Ee(t,"Role")[0],u={role:Le(o)},l=Ge(r,n,u),c=Cp(Ee(t,"ContentProtection"));Object.keys(c).length&&(l=Ge(l,{contentProtection:c}));var f=os(t),d=Ee(t,"Representation"),m=Ge(e,f);return nn(d.map(Ep(l,s,m)))}},Ap=function(r,i){return function(e,t){var n=an(i,Ee(e,"BaseURL")),s=Le(e),o=parseInt(s.id,10),u=S.isNaN(o)?t:o,l=Ge(r,{periodIndex:u}),c=Ee(e,"AdaptationSet"),f=os(e);return nn(c.map(kp(l,n,f)))}},Pp=function(r,i){i===void 0&&(i={});var e=i,t=e.manifestUri,n=t===void 0?"":t,s=e.NOW,o=s===void 0?Date.now():s,u=e.clientOffset,l=u===void 0?0:u,c=Ee(r,"Period");if(!c.length)throw new Error(Ar.INVALID_NUMBER_OF_PERIOD);var f=Le(r),d=an([n],Ee(r,"BaseURL"));return f.sourceDuration=f.mediaPresentationDuration||0,f.NOW=o,f.clientOffset=l,nn(c.map(Ap(f,d)))},wl=function(r){if(r==="")throw new Error(Ar.DASH_EMPTY_MANIFEST);var i=new Zd,e=i.parseFromString(r,"application/xml"),t=e&&e.documentElement.tagName==="MPD"?e.documentElement:null;if(!t||t&&t.getElementsByTagName("parsererror").length>0)throw new Error(Ar.DASH_INVALID_XML);return t},Ip=function(r){var i=Ee(r,"UTCTiming")[0];if(!i)return null;var e=Le(i);switch(e.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":e.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":e.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":e.method="DIRECT",e.value=Date.parse(e.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Ar.UNSUPPORTED_UTC_TIMING_SCHEME)}return e},Ol=function(r,i){return i===void 0&&(i={}),hp(bp(Pp(wl(r),i)),i.sidxMapping)},Dp=function(r){return Ip(wl(r))},wp=function(r){return r>>>0},Op=function(r){return("00"+r.toString(16)).slice(-2)},us={toUnsigned:wp,toHexString:Op},Re,ls,cs=us.toUnsigned,$e=function(r){return new Date(r*1e3-20828448e5)},Ll=function(r){return{isLeading:(r[0]&12)>>>2,dependsOn:r[0]&3,isDependedOn:(r[1]&192)>>>6,hasRedundancy:(r[1]&48)>>>4,paddingValue:(r[1]&14)>>>1,isNonSyncSample:r[1]&1,degradationPriority:r[2]<<8|r[3]}},Ir=function(r){var i="";return i+=String.fromCharCode(r[0]),i+=String.fromCharCode(r[1]),i+=String.fromCharCode(r[2]),i+=String.fromCharCode(r[3]),i},Lp=function a(r,i){var e=[],t,n,s,o,u;if(!i.length)return null;for(t=0;t<r.byteLength;)n=cs(r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3]),s=Ir(r.subarray(t+4,t+8)),o=n>1?t+n:r.byteLength,s===i[0]&&(i.length===1?e.push(r.subarray(t+8,o)):(u=a(r.subarray(t+8,o),i.slice(1)),u.length&&(e=e.concat(u)))),t=o;return e},Rp=function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e=[],t,n;for(t=0;t+4<r.length;t+=n){if(n=i.getUint32(t),t+=4,n<=0){e.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(r[t]&31){case 1:e.push("slice_layer_without_partitioning_rbsp");break;case 5:e.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:e.push("sei_rbsp");break;case 7:e.push("seq_parameter_set_rbsp");break;case 8:e.push("pic_parameter_set_rbsp");break;case 9:e.push("access_unit_delimiter_rbsp");break;default:e.push("UNKNOWN NAL - "+r[t]&31);break}}return e},Ot={avc1:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength);return{dataReferenceIndex:i.getUint16(6),width:i.getUint16(24),height:i.getUint16(26),horizresolution:i.getUint16(28)+i.getUint16(30)/16,vertresolution:i.getUint16(32)+i.getUint16(34)/16,frameCount:i.getUint16(40),depth:i.getUint16(74),config:Re(r.subarray(78,r.byteLength))}},avcC:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={configurationVersion:r[0],avcProfileIndication:r[1],profileCompatibility:r[2],avcLevelIndication:r[3],lengthSizeMinusOne:r[4]&3,sps:[],pps:[]},t=r[5]&31,n,s,o,u;for(o=6,u=0;u<t;u++)s=i.getUint16(o),o+=2,e.sps.push(new Uint8Array(r.subarray(o,o+s))),o+=s;for(n=r[o],o++,u=0;u<n;u++)s=i.getUint16(o),o+=2,e.pps.push(new Uint8Array(r.subarray(o,o+s))),o+=s;return e},btrt:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength);return{bufferSizeDB:i.getUint32(0),maxBitrate:i.getUint32(4),avgBitrate:i.getUint32(8)}},esds:function(r){return{version:r[0],flags:new Uint8Array(r.subarray(1,4)),esId:r[6]<<8|r[7],streamPriority:r[8]&31,decoderConfig:{objectProfileIndication:r[11],streamType:r[12]>>>2&63,bufferSize:r[13]<<16|r[14]<<8|r[15],maxBitrate:r[16]<<24|r[17]<<16|r[18]<<8|r[19],avgBitrate:r[20]<<24|r[21]<<16|r[22]<<8|r[23],decoderConfigDescriptor:{tag:r[24],length:r[25],audioObjectType:r[26]>>>3&31,samplingFrequencyIndex:(r[26]&7)<<1|r[27]>>>7&1,channelConfiguration:r[27]>>>3&15}}}},ftyp:function(r){for(var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={majorBrand:Ir(r.subarray(0,4)),minorVersion:i.getUint32(4),compatibleBrands:[]},t=8;t<r.byteLength;)e.compatibleBrands.push(Ir(r.subarray(t,t+4))),t+=4;return e},dinf:function(r){return{boxes:Re(r)}},dref:function(r){return{version:r[0],flags:new Uint8Array(r.subarray(1,4)),dataReferences:Re(r.subarray(8))}},hdlr:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={version:i.getUint8(0),flags:new Uint8Array(r.subarray(1,4)),handlerType:Ir(r.subarray(8,12)),name:""},t=8;for(t=24;t<r.byteLength;t++){if(r[t]===0){t++;break}e.name+=String.fromCharCode(r[t])}return e.name=decodeURIComponent(escape(e.name)),e},mdat:function(r){return{byteLength:r.byteLength,nals:Rp(r)}},mdhd:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e=4,t,n={version:i.getUint8(0),flags:new Uint8Array(r.subarray(1,4)),language:""};return n.version===1?(e+=4,n.creationTime=$e(i.getUint32(e)),e+=8,n.modificationTime=$e(i.getUint32(e)),e+=4,n.timescale=i.getUint32(e),e+=8,n.duration=i.getUint32(e)):(n.creationTime=$e(i.getUint32(e)),e+=4,n.modificationTime=$e(i.getUint32(e)),e+=4,n.timescale=i.getUint32(e),e+=4,n.duration=i.getUint32(e)),e+=4,t=i.getUint16(e),n.language+=String.fromCharCode((t>>10)+96),n.language+=String.fromCharCode(((t&992)>>5)+96),n.language+=String.fromCharCode((t&31)+96),n},mdia:function(r){return{boxes:Re(r)}},mfhd:function(r){return{version:r[0],flags:new Uint8Array(r.subarray(1,4)),sequenceNumber:r[4]<<24|r[5]<<16|r[6]<<8|r[7]}},minf:function(r){return{boxes:Re(r)}},mp4a:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={dataReferenceIndex:i.getUint16(6),channelcount:i.getUint16(16),samplesize:i.getUint16(18),samplerate:i.getUint16(24)+i.getUint16(26)/65536};return r.byteLength>28&&(e.streamDescriptor=Re(r.subarray(28))[0]),e},moof:function(r){return{boxes:Re(r)}},moov:function(r){return{boxes:Re(r)}},mvex:function(r){return{boxes:Re(r)}},mvhd:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e=4,t={version:i.getUint8(0),flags:new Uint8Array(r.subarray(1,4))};return t.version===1?(e+=4,t.creationTime=$e(i.getUint32(e)),e+=8,t.modificationTime=$e(i.getUint32(e)),e+=4,t.timescale=i.getUint32(e),e+=8,t.duration=i.getUint32(e)):(t.creationTime=$e(i.getUint32(e)),e+=4,t.modificationTime=$e(i.getUint32(e)),e+=4,t.timescale=i.getUint32(e),e+=4,t.duration=i.getUint32(e)),e+=4,t.rate=i.getUint16(e)+i.getUint16(e+2)/16,e+=4,t.volume=i.getUint8(e)+i.getUint8(e+1)/8,e+=2,e+=2,e+=2*4,t.matrix=new Uint32Array(r.subarray(e,e+9*4)),e+=9*4,e+=6*4,t.nextTrackId=i.getUint32(e),t},pdin:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength);return{version:i.getUint8(0),flags:new Uint8Array(r.subarray(1,4)),rate:i.getUint32(4),initialDelay:i.getUint32(8)}},sdtp:function(r){var i={version:r[0],flags:new Uint8Array(r.subarray(1,4)),samples:[]},e;for(e=4;e<r.byteLength;e++)i.samples.push({dependsOn:(r[e]&48)>>4,isDependedOn:(r[e]&12)>>2,hasRedundancy:r[e]&3});return i},sidx:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={version:r[0],flags:new Uint8Array(r.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},t=i.getUint16(22),n;for(n=24;t;n+=12,t--)e.references.push({referenceType:(r[n]&128)>>>7,referencedSize:i.getUint32(n)&2147483647,subsegmentDuration:i.getUint32(n+4),startsWithSap:!!(r[n+8]&128),sapType:(r[n+8]&112)>>>4,sapDeltaTime:i.getUint32(n+8)&268435455});return e},smhd:function(r){return{version:r[0],flags:new Uint8Array(r.subarray(1,4)),balance:r[4]+r[5]/256}},stbl:function(r){return{boxes:Re(r)}},stco:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={version:r[0],flags:new Uint8Array(r.subarray(1,4)),chunkOffsets:[]},t=i.getUint32(4),n;for(n=8;t;n+=4,t--)e.chunkOffsets.push(i.getUint32(n));return e},stsc:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e=i.getUint32(4),t={version:r[0],flags:new Uint8Array(r.subarray(1,4)),sampleToChunks:[]},n;for(n=8;e;n+=12,e--)t.sampleToChunks.push({firstChunk:i.getUint32(n),samplesPerChunk:i.getUint32(n+4),sampleDescriptionIndex:i.getUint32(n+8)});return t},stsd:function(r){return{version:r[0],flags:new Uint8Array(r.subarray(1,4)),sampleDescriptions:Re(r.subarray(8))}},stsz:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={version:r[0],flags:new Uint8Array(r.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]},t;for(t=12;t<r.byteLength;t+=4)e.entries.push(i.getUint32(t));return e},stts:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={version:r[0],flags:new Uint8Array(r.subarray(1,4)),timeToSamples:[]},t=i.getUint32(4),n;for(n=8;t;n+=8,t--)e.timeToSamples.push({sampleCount:i.getUint32(n),sampleDelta:i.getUint32(n+4)});return e},styp:function(r){return Ot.ftyp(r)},tfdt:function(r){var i={version:r[0],flags:new Uint8Array(r.subarray(1,4)),baseMediaDecodeTime:cs(r[4]<<24|r[5]<<16|r[6]<<8|r[7])};return i.version===1&&(i.baseMediaDecodeTime*=Math.pow(2,32),i.baseMediaDecodeTime+=cs(r[8]<<24|r[9]<<16|r[10]<<8|r[11])),i},tfhd:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e={version:r[0],flags:new Uint8Array(r.subarray(1,4)),trackId:i.getUint32(4)},t=e.flags[2]&1,n=e.flags[2]&2,s=e.flags[2]&8,o=e.flags[2]&16,u=e.flags[2]&32,l=e.flags[0]&65536,c=e.flags[0]&131072,f;return f=8,t&&(f+=4,e.baseDataOffset=i.getUint32(12),f+=4),n&&(e.sampleDescriptionIndex=i.getUint32(f),f+=4),s&&(e.defaultSampleDuration=i.getUint32(f),f+=4),o&&(e.defaultSampleSize=i.getUint32(f),f+=4),u&&(e.defaultSampleFlags=i.getUint32(f)),l&&(e.durationIsEmpty=!0),!t&&c&&(e.baseDataOffsetIsMoof=!0),e},tkhd:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength),e=4,t={version:i.getUint8(0),flags:new Uint8Array(r.subarray(1,4))};return t.version===1?(e+=4,t.creationTime=$e(i.getUint32(e)),e+=8,t.modificationTime=$e(i.getUint32(e)),e+=4,t.trackId=i.getUint32(e),e+=4,e+=8,t.duration=i.getUint32(e)):(t.creationTime=$e(i.getUint32(e)),e+=4,t.modificationTime=$e(i.getUint32(e)),e+=4,t.trackId=i.getUint32(e),e+=4,e+=4,t.duration=i.getUint32(e)),e+=4,e+=2*4,t.layer=i.getUint16(e),e+=2,t.alternateGroup=i.getUint16(e),e+=2,t.volume=i.getUint8(e)+i.getUint8(e+1)/8,e+=2,e+=2,t.matrix=new Uint32Array(r.subarray(e,e+9*4)),e+=9*4,t.width=i.getUint16(e)+i.getUint16(e+2)/16,e+=4,t.height=i.getUint16(e)+i.getUint16(e+2)/16,t},traf:function(r){return{boxes:Re(r)}},trak:function(r){return{boxes:Re(r)}},trex:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength);return{version:r[0],flags:new Uint8Array(r.subarray(1,4)),trackId:i.getUint32(4),defaultSampleDescriptionIndex:i.getUint32(8),defaultSampleDuration:i.getUint32(12),defaultSampleSize:i.getUint32(16),sampleDependsOn:r[20]&3,sampleIsDependedOn:(r[21]&192)>>6,sampleHasRedundancy:(r[21]&48)>>4,samplePaddingValue:(r[21]&14)>>1,sampleIsDifferenceSample:!!(r[21]&1),sampleDegradationPriority:i.getUint16(22)}},trun:function(r){var i={version:r[0],flags:new Uint8Array(r.subarray(1,4)),samples:[]},e=new DataView(r.buffer,r.byteOffset,r.byteLength),t=i.flags[2]&1,n=i.flags[2]&4,s=i.flags[1]&1,o=i.flags[1]&2,u=i.flags[1]&4,l=i.flags[1]&8,c=e.getUint32(4),f=8,d;for(t&&(i.dataOffset=e.getInt32(f),f+=4),n&&c&&(d={flags:Ll(r.subarray(f,f+4))},f+=4,s&&(d.duration=e.getUint32(f),f+=4),o&&(d.size=e.getUint32(f),f+=4),l&&(d.compositionTimeOffset=e.getUint32(f),f+=4),i.samples.push(d),c--);c--;)d={},s&&(d.duration=e.getUint32(f),f+=4),o&&(d.size=e.getUint32(f),f+=4),u&&(d.flags=Ll(r.subarray(f,f+4)),f+=4),l&&(d.compositionTimeOffset=e.getUint32(f),f+=4),i.samples.push(d);return i},"url ":function(r){return{version:r[0],flags:new Uint8Array(r.subarray(1,4))}},vmhd:function(r){var i=new DataView(r.buffer,r.byteOffset,r.byteLength);return{version:r[0],flags:new Uint8Array(r.subarray(1,4)),graphicsmode:i.getUint16(4),opcolor:new Uint16Array([i.getUint16(6),i.getUint16(8),i.getUint16(10)])}}};Re=function(r){for(var i=0,e=[],t,n,s,o,u,l=new ArrayBuffer(r.length),c=new Uint8Array(l),f=0;f<r.length;++f)c[f]=r[f];for(t=new DataView(l);i<r.byteLength;)n=t.getUint32(i),s=Ir(r.subarray(i+4,i+8)),o=n>1?i+n:r.byteLength,u=(Ot[s]||function(d){return{data:d}})(r.subarray(i+8,o)),u.size=n,u.type=s,e.push(u),i=o;return e},ls=function(r,i){var e;return i=i||0,e=new Array(i*2+1).join(" "),r.map(function(t,n){return e+t.type+`
`+Object.keys(t).filter(function(s){return s!=="type"&&s!=="boxes"}).map(function(s){var o=e+"  "+s+": ",u=t[s];if(u instanceof Uint8Array||u instanceof Uint32Array){var l=Array.prototype.slice.call(new Uint8Array(u.buffer,u.byteOffset,u.byteLength)).map(function(c){return" "+("00"+c.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return l?l.length===1?o+"<"+l.join("").slice(1)+">":o+`<
`+l.map(function(c){return e+"  "+c}).join(`
`)+`
`+e+"  >":o+"<>"}return o+JSON.stringify(u,null,2).split(`
`).map(function(c,f){return f===0?c:e+"  "+c}).join(`
`)}).join(`
`)+(t.boxes?`
`+ls(t.boxes,i+1):"")}).join(`
`)};var se={inspect:Re,textify:ls,parseType:Ir,findBox:Lp,parseTraf:Ot.traf,parseTfdt:Ot.tfdt,parseHdlr:Ot.hdlr,parseTfhd:Ot.tfhd,parseTrun:Ot.trun,parseSidx:Ot.sidx},Dr=us.toUnsigned,di=us.toHexString,Rl,Nl,Ml,Ul,Fl;Rl=function(r){var i={},e=se.findBox(r,["moov","trak"]);return e.reduce(function(t,n){var s,o,u,l,c;return s=se.findBox(n,["tkhd"])[0],!s||(o=s[0],u=o===0?12:20,l=Dr(s[u]<<24|s[u+1]<<16|s[u+2]<<8|s[u+3]),c=se.findBox(n,["mdia","mdhd"])[0],!c)?null:(o=c[0],u=o===0?12:20,t[l]=Dr(c[u]<<24|c[u+1]<<16|c[u+2]<<8|c[u+3]),t)},i)},Nl=function(r,i){var e,t,n;return e=se.findBox(i,["moof","traf"]),t=[].concat.apply([],e.map(function(s){return se.findBox(s,["tfhd"]).map(function(o){var u,l,c;return u=Dr(o[4]<<24|o[5]<<16|o[6]<<8|o[7]),l=r[u]||9e4,c=se.findBox(s,["tfdt"]).map(function(f){var d,m;return d=f[0],m=Dr(f[4]<<24|f[5]<<16|f[6]<<8|f[7]),d===1&&(m*=Math.pow(2,32),m+=Dr(f[8]<<24|f[9]<<16|f[10]<<8|f[11])),m})[0],c=c||1/0,c/l})})),n=Math.min.apply(null,t),isFinite(n)?n:0},Ml=function(r,i){var e=se.findBox(i,["moof","traf"]),t=0,n=0,s;if(e&&e.length)for(var o=se.parseTraf(e[0]),u=0;u<o.boxes.length;u++)o.boxes[u].type==="tfhd"?s=o.boxes[u].trackId:o.boxes[u].type==="tfdt"?t=o.boxes[u].baseMediaDecodeTime:o.boxes[u].type==="trun"&&o.boxes[u].samples.length&&(n=o.boxes[u].samples[0].compositionTimeOffset||0);var l=r[s]||9e4;return(t+n)/l},Ul=function(r){var i=se.findBox(r,["moov","trak"]),e=[];return i.forEach(function(t){var n=se.findBox(t,["mdia","hdlr"]),s=se.findBox(t,["tkhd"]);n.forEach(function(o,u){var l=se.parseType(o.subarray(8,12)),c=s[u],f,d,m;l==="vide"&&(f=new DataView(c.buffer,c.byteOffset,c.byteLength),d=f.getUint8(0),m=d===0?f.getUint32(12):f.getUint32(20),e.push(m))})}),e},Fl=function(r){var i=se.findBox(r,["moov","trak"]),e=[];return i.forEach(function(t){var n={},s=se.findBox(t,["tkhd"])[0],o,u;s&&(o=new DataView(s.buffer,s.byteOffset,s.byteLength),u=o.getUint8(0),n.id=u===0?o.getUint32(12):o.getUint32(20));var l=se.findBox(t,["mdia","hdlr"])[0];if(l){var c=se.parseType(l.subarray(8,12));c==="vide"?n.type="video":c==="soun"?n.type="audio":n.type=c}var f=se.findBox(t,["mdia","minf","stbl","stsd"])[0];if(f){var d=f.subarray(8);n.codec=se.parseType(d.subarray(4,8));var m=se.findBox(d,[n.codec])[0],_,b;m&&(/^[a-z]vc[1-9]$/i.test(n.codec)?(_=m.subarray(78),b=se.parseType(_.subarray(4,8)),b==="avcC"&&_.length>11?(n.codec+=".",n.codec+=di(_[9]),n.codec+=di(_[10]),n.codec+=di(_[11])):n.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(n.codec)&&(_=m.subarray(28),b=se.parseType(_.subarray(4,8)),b==="esds"&&_.length>20&&_[19]!==0?(n.codec+="."+di(_[19]),n.codec+="."+di(_[20]>>>2&63).replace(/^0/,"")):n.codec="mp4a.40.2"))}var A=se.findBox(t,["mdia","mdhd"])[0];if(A&&s){var I=u===0?12:20;n.timescale=Dr(A[I]<<24|A[I+1]<<16|A[I+2]<<8|A[I+3])}e.push(n)}),e};var bt={findBox:se.findBox,parseType:se.parseType,timescale:Rl,startTime:Nl,compositionStartTime:Ml,videoTrackIds:Ul,tracks:Fl},Bl=4,Np=128,Mp=function(r){for(var i=0,e={payloadType:-1,payloadSize:0},t=0,n=0;i<r.byteLength&&r[i]!==Np;){for(;r[i]===255;)t+=255,i++;for(t+=r[i++];r[i]===255;)n+=255,i++;if(n+=r[i++],!e.payload&&t===Bl){e.payloadType=t,e.payloadSize=n,e.payload=r.subarray(i,i+n);break}i+=n,t=0,n=0}return e},Up=function(r){return r.payload[0]!==181||(r.payload[1]<<8|r.payload[2])!==49||String.fromCharCode(r.payload[3],r.payload[4],r.payload[5],r.payload[6])!=="GA94"||r.payload[7]!==3?null:r.payload.subarray(8,r.payload.length-1)},Fp=function(r,i){var e=[],t,n,s,o;if(!(i[0]&64))return e;for(n=i[0]&31,t=0;t<n;t++)s=t*3,o={type:i[s+2]&3,pts:r},i[s+2]&4&&(o.ccData=i[s+3]<<8|i[s+4],e.push(o));return e},Bp=function(r){for(var i=r.byteLength,e=[],t=1,n,s;t<i-2;)r[t]===0&&r[t+1]===0&&r[t+2]===3?(e.push(t+2),t+=2):t++;if(e.length===0)return r;n=i-e.length,s=new Uint8Array(n);var o=0;for(t=0;t<n;o++,t++)o===e[0]&&(o++,e.shift()),s[t]=r[o];return s},pi={parseSei:Mp,parseUserData:Up,parseCaptionPackets:Fp,discardEmulationPreventionBytes:Bp,USER_DATA_REGISTERED_ITU_T_T35:Bl},qt=function(){this.init=function(){var r={};this.on=function(i,e){r[i]||(r[i]=[]),r[i]=r[i].concat(e)},this.off=function(i,e){var t;return r[i]?(t=r[i].indexOf(e),r[i]=r[i].slice(),r[i].splice(t,1),t>-1):!1},this.trigger=function(i){var e,t,n,s;if(e=r[i],!!e)if(arguments.length===2)for(n=e.length,t=0;t<n;++t)e[t].call(this,arguments[1]);else{for(s=[],t=arguments.length,t=1;t<arguments.length;++t)s.push(arguments[t]);for(n=e.length,t=0;t<n;++t)e[t].apply(this,s)}},this.dispose=function(){r={}}}};qt.prototype.pipe=function(a){return this.on("data",function(r){a.push(r)}),this.on("done",function(r){a.flush(r)}),this.on("partialdone",function(r){a.partialFlush(r)}),this.on("endedtimeline",function(r){a.endTimeline(r)}),this.on("reset",function(r){a.reset(r)}),a},qt.prototype.push=function(a){this.trigger("data",a)},qt.prototype.flush=function(a){this.trigger("done",a)},qt.prototype.partialFlush=function(a){this.trigger("partialdone",a)},qt.prototype.endTimeline=function(a){this.trigger("endedtimeline",a)},qt.prototype.reset=function(a){this.trigger("reset",a)};var fs=qt,Ye=function a(){a.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new pe(0,0),new pe(0,1),new pe(1,0),new pe(1,1)],this.reset(),this.ccStreams_.forEach(function(r){r.on("data",this.trigger.bind(this,"data")),r.on("partialdone",this.trigger.bind(this,"partialdone")),r.on("done",this.trigger.bind(this,"done"))},this)};Ye.prototype=new fs,Ye.prototype.push=function(a){var r,i,e;if(a.nalUnitType==="sei_rbsp"&&(r=pi.parseSei(a.escapedRBSP),r.payloadType===pi.USER_DATA_REGISTERED_ITU_T_T35&&(i=pi.parseUserData(r),!!i))){if(a.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(a.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}e=pi.parseCaptionPackets(a.pts,i),this.captionPackets_=this.captionPackets_.concat(e),this.latestDts_!==a.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=a.dts}},Ye.prototype.flushCCStreams=function(a){this.ccStreams_.forEach(function(r){return a==="flush"?r.flush():r.partialFlush()},this)},Ye.prototype.flushStream=function(a){if(!this.captionPackets_.length){this.flushCCStreams(a);return}this.captionPackets_.forEach(function(r,i){r.presortIndex=i}),this.captionPackets_.sort(function(r,i){return r.pts===i.pts?r.presortIndex-i.presortIndex:r.pts-i.pts}),this.captionPackets_.forEach(function(r){r.type<2&&this.dispatchCea608Packet(r)},this),this.captionPackets_.length=0,this.flushCCStreams(a)},Ye.prototype.flush=function(){return this.flushStream("flush")},Ye.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Ye.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(a){a.reset()})},Ye.prototype.dispatchCea608Packet=function(a){this.setsTextOrXDSActive(a)?this.activeCea608Channel_[a.type]=null:this.setsChannel1Active(a)?this.activeCea608Channel_[a.type]=0:this.setsChannel2Active(a)&&(this.activeCea608Channel_[a.type]=1),this.activeCea608Channel_[a.type]!==null&&this.ccStreams_[(a.type<<1)+this.activeCea608Channel_[a.type]].push(a)},Ye.prototype.setsChannel1Active=function(a){return(a.ccData&30720)===4096},Ye.prototype.setsChannel2Active=function(a){return(a.ccData&30720)===6144},Ye.prototype.setsTextOrXDSActive=function(a){return(a.ccData&28928)===256||(a.ccData&30974)===4138||(a.ccData&30974)===6186};var jp={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},sn=function(r){return r===null?"":(r=jp[r]||r,String.fromCharCode(r))},on=14,Vp=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],zt=function(){for(var r=[],i=on+1;i--;)r.push("");return r},pe=function a(r,i){a.prototype.init.call(this),this.field_=r||0,this.dataChannel_=i||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(e){var t,n,s,o,u;if(t=e.ccData&32639,t===this.lastControlCode_){this.lastControlCode_=null;return}if((t&61440)===4096?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),s=t>>>8,o=t&255,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=zt();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=zt();else if(t===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(e.pts),this.displayed_=zt()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(s,o))s=(s&3)<<8,u=sn(s|o),this[this.mode_](e.pts,u),this.column_++;else if(this.isExtCharacter(s,o))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),s=(s&3)<<8,u=sn(s|o),this[this.mode_](e.pts,u),this.column_++;else if(this.isMidRowCode(s,o))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,(o&14)===14&&this.addFormatting(e.pts,["i"]),(o&1)===1&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(s,o))this.column_+=o&3;else if(this.isPAC(s,o)){var l=Vp.indexOf(t&7968);this.mode_==="rollUp"&&(l-this.rollUpRows_+1<0&&(l=this.rollUpRows_-1),this.setRollUp(e.pts,l)),l!==this.row_&&(this.clearFormatting(e.pts),this.row_=l),o&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(e.pts,["u"]),(t&16)===16&&(this.column_=((t&14)>>1)*4),this.isColorPAC(o)&&(o&14)===14&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(s)&&(o===0&&(o=null),u=sn(s),u+=sn(o),this[this.mode_](e.pts,u),this.column_+=u.length)}};pe.prototype=new fs,pe.prototype.flushDisplayed=function(a){var r=this.displayed_.map(function(i){try{return i.trim()}catch{return console.error("Skipping malformed caption."),""}}).join(`
`).replace(/^\n+|\n+$/g,"");r.length&&this.trigger("data",{startPts:this.startPts_,endPts:a,text:r,stream:this.name_})},pe.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=zt(),this.nonDisplayed_=zt(),this.lastControlCode_=null,this.column_=0,this.row_=on,this.rollUpRows_=2,this.formatting_=[]},pe.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},pe.prototype.isSpecialCharacter=function(a,r){return a===this.EXT_&&r>=48&&r<=63},pe.prototype.isExtCharacter=function(a,r){return(a===this.EXT_+1||a===this.EXT_+2)&&r>=32&&r<=63},pe.prototype.isMidRowCode=function(a,r){return a===this.EXT_&&r>=32&&r<=47},pe.prototype.isOffsetControlCode=function(a,r){return a===this.OFFSET_&&r>=33&&r<=35},pe.prototype.isPAC=function(a,r){return a>=this.BASE_&&a<this.BASE_+8&&r>=64&&r<=127},pe.prototype.isColorPAC=function(a){return a>=64&&a<=79||a>=96&&a<=127},pe.prototype.isNormalChar=function(a){return a>=32&&a<=127},pe.prototype.setRollUp=function(a,r){if(this.mode_!=="rollUp"&&(this.row_=on,this.mode_="rollUp",this.flushDisplayed(a),this.nonDisplayed_=zt(),this.displayed_=zt()),r!==void 0&&r!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[r-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";r===void 0&&(r=this.row_),this.topRow_=r-this.rollUpRows_+1},pe.prototype.addFormatting=function(a,r){this.formatting_=this.formatting_.concat(r);var i=r.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](a,i)},pe.prototype.clearFormatting=function(a){if(this.formatting_.length){var r=this.formatting_.reverse().reduce(function(i,e){return i+"</"+e+">"},"");this.formatting_=[],this[this.mode_](a,r)}},pe.prototype.popOn=function(a,r){var i=this.nonDisplayed_[this.row_];i+=r,this.nonDisplayed_[this.row_]=i},pe.prototype.rollUp=function(a,r){var i=this.displayed_[this.row_];i+=r,this.displayed_[this.row_]=i},pe.prototype.shiftRowsUp_=function(){var a;for(a=0;a<this.topRow_;a++)this.displayed_[a]="";for(a=this.row_+1;a<on+1;a++)this.displayed_[a]="";for(a=this.topRow_;a<this.row_;a++)this.displayed_[a]=this.displayed_[a+1];this.displayed_[this.row_]=""},pe.prototype.paintOn=function(a,r){var i=this.displayed_[this.row_];i+=r,this.displayed_[this.row_]=i};var Hp={CaptionStream:Ye,Cea608Stream:pe},Wp=pi.discardEmulationPreventionBytes,Gp=Hp.CaptionStream,qp=function(r,i){for(var e=r,t=0;t<i.length;t++){var n=i[t];if(e<n.size)return n;e-=n.size}return null},zp=function(r,i,e){var t=new DataView(r.buffer,r.byteOffset,r.byteLength),n=[],s,o,u,l;for(o=0;o+4<r.length;o+=u)if(u=t.getUint32(o),o+=4,!(u<=0))switch(r[o]&31){case 6:var c=r.subarray(o+1,o+1+u),f=qp(o,i);s={nalUnitType:"sei_rbsp",size:u,data:c,escapedRBSP:Wp(c),trackId:e},f?(s.pts=f.pts,s.dts=f.dts,l=f):(s.pts=l.pts,s.dts=l.dts),n.push(s);break}return n},Kp=function(r,i,e){var t=i,n=e.defaultSampleDuration||0,s=e.defaultSampleSize||0,o=e.trackId,u=[];return r.forEach(function(l){var c=se.parseTrun(l),f=c.samples;f.forEach(function(d){d.duration===void 0&&(d.duration=n),d.size===void 0&&(d.size=s),d.trackId=o,d.dts=t,d.compositionTimeOffset===void 0&&(d.compositionTimeOffset=0),d.pts=t+d.compositionTimeOffset,t+=d.duration}),u=u.concat(f)}),u},Xp=function(r,i){var e=bt.findBox(r,["moof","traf"]),t=bt.findBox(r,["mdat"]),n={},s=[];return t.forEach(function(o,u){var l=e[u];s.push({mdat:o,traf:l})}),s.forEach(function(o){var u=o.mdat,l=o.traf,c=bt.findBox(l,["tfhd"]),f=se.parseTfhd(c[0]),d=f.trackId,m=bt.findBox(l,["tfdt"]),_=m.length>0?se.parseTfdt(m[0]).baseMediaDecodeTime:0,b=bt.findBox(l,["trun"]),A,I;i===d&&b.length>0&&(A=Kp(b,_,f),I=zp(u,A,d),n[d]||(n[d]=[]),n[d]=n[d].concat(I))}),n},$p=function(r,i,e){var t;return i===null?null:(t=Xp(r,i),{seiNals:t[i],timescale:e})},Yp=function(){var r=!1,i,e,t,n,s,o;this.isInitialized=function(){return r},this.init=function(u){i=new Gp,r=!0,o=u?u.isPartial:!1,i.on("data",function(l){l.startTime=l.startPts/n,l.endTime=l.endPts/n,s.captions.push(l),s.captionStreams[l.stream]=!0})},this.isNewInit=function(u,l){return u&&u.length===0||l&&typeof l=="object"&&Object.keys(l).length===0?!1:t!==u[0]||n!==l[t]},this.parse=function(u,l,c){var f;if(this.isInitialized()){if(!l||!c)return null;if(this.isNewInit(l,c))t=l[0],n=c[t];else if(t===null||!n)return e.push(u),null}else return null;for(;e.length>0;){var d=e.shift();this.parse(d,l,c)}return f=$p(u,t,n),f===null||!f.seiNals?null:(this.pushNals(f.seiNals),this.flushStream(),s)},this.pushNals=function(u){if(!this.isInitialized()||!u||u.length===0)return null;u.forEach(function(l){i.push(l)})},this.flushStream=function(){if(!this.isInitialized())return null;o?i.partialFlush():i.flush()},this.clearParsedCaptions=function(){s.captions=[],s.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;i.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){e=[],t=null,n=null,s?this.clearParsedCaptions():s={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()},Qp=Yp,mi={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Jp=8589934592,Zp=4294967296,jl="shared",hs=function(r,i){var e=1;for(r>i&&(e=-1);Math.abs(i-r)>Zp;)r+=e*Jp;return r},Vl=function a(r){var i,e;a.prototype.init.call(this),this.type_=r||jl,this.push=function(t){this.type_!==jl&&t.type!==this.type_||(e===void 0&&(e=t.dts),t.dts=hs(t.dts,e),t.pts=hs(t.pts,e),i=t.dts,this.trigger("data",t))},this.flush=function(){e=i,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){e=void 0,i=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Vl.prototype=new fs;var em={TimestampRolloverStream:Vl,handleRollover:hs},Hl=function(r){var i=r[1]&31;return i<<=8,i|=r[2],i},un=function(r){return!!(r[1]&64)},ln=function(r){var i=0;return(r[3]&48)>>>4>1&&(i+=r[4]+1),i},tm=function(r,i){var e=Hl(r);return e===0?"pat":e===i?"pmt":i?"pes":null},rm=function(r){var i=un(r),e=4+ln(r);return i&&(e+=r[e]+1),(r[e+10]&31)<<8|r[e+11]},im=function(r){var i={},e=un(r),t=4+ln(r);if(e&&(t+=r[t]+1),!!(r[t+5]&1)){var n,s,o;n=(r[t+1]&15)<<8|r[t+2],s=3+n-4,o=(r[t+10]&15)<<8|r[t+11];for(var u=12+o;u<s;){var l=t+u;i[(r[l+1]&31)<<8|r[l+2]]=r[l],u+=((r[l+3]&15)<<8|r[l+4])+5}return i}},nm=function(r,i){var e=Hl(r),t=i[e];switch(t){case mi.H264_STREAM_TYPE:return"video";case mi.ADTS_STREAM_TYPE:return"audio";case mi.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},am=function(r){var i=un(r);if(!i)return null;var e=4+ln(r);if(e>=r.byteLength)return null;var t=null,n;return n=r[e+7],n&192&&(t={},t.pts=(r[e+9]&14)<<27|(r[e+10]&255)<<20|(r[e+11]&254)<<12|(r[e+12]&255)<<5|(r[e+13]&254)>>>3,t.pts*=4,t.pts+=(r[e+13]&6)>>>1,t.dts=t.pts,n&64&&(t.dts=(r[e+14]&14)<<27|(r[e+15]&255)<<20|(r[e+16]&254)<<12|(r[e+17]&255)<<5|(r[e+18]&254)>>>3,t.dts*=4,t.dts+=(r[e+18]&6)>>>1)),t},ds=function(r){switch(r){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},sm=function(r){for(var i=4+ln(r),e=r.subarray(i),t=0,n=0,s=!1,o;n<e.byteLength-3;n++)if(e[n+2]===1){t=n+5;break}for(;t<e.byteLength;)switch(e[t]){case 0:if(e[t-1]!==0){t+=2;break}else if(e[t-2]!==0){t++;break}n+3!==t-2&&(o=ds(e[n+3]&31),o==="slice_layer_without_partitioning_rbsp_idr"&&(s=!0));do t++;while(e[t]!==1&&t<e.length);n=t-2,t+=3;break;case 1:if(e[t-1]!==0||e[t-2]!==0){t+=3;break}o=ds(e[n+3]&31),o==="slice_layer_without_partitioning_rbsp_idr"&&(s=!0),n=t-2,t+=3;break;default:t+=3;break}return e=e.subarray(n),t-=n,n=0,e&&e.byteLength>3&&(o=ds(e[n+3]&31),o==="slice_layer_without_partitioning_rbsp_idr"&&(s=!0)),s},om={parseType:tm,parsePat:rm,parsePmt:im,parsePayloadUnitStartIndicator:un,parsePesType:nm,parsePesTime:am,videoPacketContainsKeyFrame:sm},um=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],lm=function(r){return r[0]==="I".charCodeAt(0)&&r[1]==="D".charCodeAt(0)&&r[2]==="3".charCodeAt(0)},Wl=function(r){return r[0]<<21|r[1]<<14|r[2]<<7|r[3]},cm=function(r,i,e){var t,n="";for(t=i;t<e;t++)n+="%"+("00"+r[t].toString(16)).slice(-2);return n},fm=function(r,i,e){return unescape(cm(r,i,e))},hm=function(r,i){var e=r[i+6]<<21|r[i+7]<<14|r[i+8]<<7|r[i+9],t=r[i+5],n=(t&16)>>4;return n?e+20:e+10},dm=function(r,i){var e=(r[i+5]&224)>>5,t=r[i+4]<<3,n=r[i+3]&6144;return n|t|e},pm=function(r,i){return r[i]==="I".charCodeAt(0)&&r[i+1]==="D".charCodeAt(0)&&r[i+2]==="3".charCodeAt(0)?"timed-metadata":r[i]&!0&&(r[i+1]&240)===240?"audio":null},mm=function(r){for(var i=0;i+5<r.length;){if(r[i]!==255||(r[i+1]&246)!==240){i++;continue}return um[(r[i+2]&60)>>>2]}return null},vm=function(r){var i,e,t,n;i=10,r[5]&64&&(i+=4,i+=Wl(r.subarray(10,14)));do{if(e=Wl(r.subarray(i+4,i+8)),e<1)return null;if(n=String.fromCharCode(r[i],r[i+1],r[i+2],r[i+3]),n==="PRIV"){t=r.subarray(i+10,i+e+10);for(var s=0;s<t.byteLength;s++)if(t[s]===0){var o=fm(t,0,s);if(o==="com.apple.streaming.transportStreamTimestamp"){var u=t.subarray(s+1),l=(u[3]&1)<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;return l*=4,l+=u[7]&3,l}break}}i+=10,i+=e}while(i<r.byteLength);return null},gm={isLikelyAacData:lm,parseId3TagSize:hm,parseAdtsSize:dm,parseType:pm,parseSampleRate:mm,parseAacTimestamp:vm},ps=9e4,ms,vs,cn,gs,Gl,ql,zl;ms=function(r){return r*ps},vs=function(r,i){return r*i},cn=function(r){return r/ps},gs=function(r,i){return r/i},Gl=function(r,i){return ms(gs(r,i))},ql=function(r,i){return vs(cn(r),i)},zl=function(r,i,e){return cn(e?r:r-i)};var _m={ONE_SECOND_IN_TS:ps,secondsToVideoTs:ms,secondsToAudioTs:vs,videoTsToSeconds:cn,audioTsToSeconds:gs,audioTsToVideoTs:Gl,videoTsToAudioTs:ql,metadataTsToSeconds:zl},wr=em.handleRollover,ne={};ne.ts=om,ne.aac=gm;var Kt=_m.ONE_SECOND_IN_TS,Ne=188,ut=71,ym=function(r,i){for(var e=0,t=Ne,n,s;t<r.byteLength;){if(r[e]===ut&&r[t]===ut){switch(n=r.subarray(e,t),s=ne.ts.parseType(n,i.pid),s){case"pat":i.pid||(i.pid=ne.ts.parsePat(n));break;case"pmt":i.table||(i.table=ne.ts.parsePmt(n));break}if(i.pid&&i.table)return;e+=Ne,t+=Ne;continue}e++,t++}},Kl=function(r,i,e){for(var t=0,n=Ne,s,o,u,l,c,f=!1;n<=r.byteLength;){if(r[t]===ut&&(r[n]===ut||n===r.byteLength)){switch(s=r.subarray(t,n),o=ne.ts.parseType(s,i.pid),o){case"pes":u=ne.ts.parsePesType(s,i.table),l=ne.ts.parsePayloadUnitStartIndicator(s),u==="audio"&&l&&(c=ne.ts.parsePesTime(s),c&&(c.type="audio",e.audio.push(c),f=!0));break}if(f)break;t+=Ne,n+=Ne;continue}t++,n++}for(n=r.byteLength,t=n-Ne,f=!1;t>=0;){if(r[t]===ut&&(r[n]===ut||n===r.byteLength)){switch(s=r.subarray(t,n),o=ne.ts.parseType(s,i.pid),o){case"pes":u=ne.ts.parsePesType(s,i.table),l=ne.ts.parsePayloadUnitStartIndicator(s),u==="audio"&&l&&(c=ne.ts.parsePesTime(s),c&&(c.type="audio",e.audio.push(c),f=!0));break}if(f)break;t-=Ne,n-=Ne;continue}t--,n--}},Tm=function(r,i,e){for(var t=0,n=Ne,s,o,u,l,c,f,d,m,_=!1,b={data:[],size:0};n<r.byteLength;){if(r[t]===ut&&r[n]===ut){switch(s=r.subarray(t,n),o=ne.ts.parseType(s,i.pid),o){case"pes":if(u=ne.ts.parsePesType(s,i.table),l=ne.ts.parsePayloadUnitStartIndicator(s),u==="video"&&(l&&!_&&(c=ne.ts.parsePesTime(s),c&&(c.type="video",e.video.push(c),_=!0)),!e.firstKeyFrame)){if(l&&b.size!==0){for(f=new Uint8Array(b.size),d=0;b.data.length;)m=b.data.shift(),f.set(m,d),d+=m.byteLength;if(ne.ts.videoPacketContainsKeyFrame(f)){var A=ne.ts.parsePesTime(f);A?(e.firstKeyFrame=A,e.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}b.size=0}b.data.push(s),b.size+=s.byteLength}break}if(_&&e.firstKeyFrame)break;t+=Ne,n+=Ne;continue}t++,n++}for(n=r.byteLength,t=n-Ne,_=!1;t>=0;){if(r[t]===ut&&r[n]===ut){switch(s=r.subarray(t,n),o=ne.ts.parseType(s,i.pid),o){case"pes":u=ne.ts.parsePesType(s,i.table),l=ne.ts.parsePayloadUnitStartIndicator(s),u==="video"&&l&&(c=ne.ts.parsePesTime(s),c&&(c.type="video",e.video.push(c),_=!0));break}if(_)break;t-=Ne,n-=Ne;continue}t--,n--}},bm=function(r,i){if(r.audio&&r.audio.length){var e=i;typeof e>"u"&&(e=r.audio[0].dts),r.audio.forEach(function(s){s.dts=wr(s.dts,e),s.pts=wr(s.pts,e),s.dtsTime=s.dts/Kt,s.ptsTime=s.pts/Kt})}if(r.video&&r.video.length){var t=i;if(typeof t>"u"&&(t=r.video[0].dts),r.video.forEach(function(s){s.dts=wr(s.dts,t),s.pts=wr(s.pts,t),s.dtsTime=s.dts/Kt,s.ptsTime=s.pts/Kt}),r.firstKeyFrame){var n=r.firstKeyFrame;n.dts=wr(n.dts,t),n.pts=wr(n.pts,t),n.dtsTime=n.dts/Kt,n.ptsTime=n.dts/Kt}}},xm=function(r){for(var i=!1,e=0,t=null,n=null,s=0,o=0,u;r.length-o>=3;){var l=ne.aac.parseType(r,o);switch(l){case"timed-metadata":if(r.length-o<10){i=!0;break}if(s=ne.aac.parseId3TagSize(r,o),s>r.length){i=!0;break}n===null&&(u=r.subarray(o,o+s),n=ne.aac.parseAacTimestamp(u)),o+=s;break;case"audio":if(r.length-o<7){i=!0;break}if(s=ne.aac.parseAdtsSize(r,o),s>r.length){i=!0;break}t===null&&(u=r.subarray(o,o+s),t=ne.aac.parseSampleRate(u)),e++,o+=s;break;default:o++;break}if(i)return null}if(t===null||n===null)return null;var c=Kt/t,f={audio:[{type:"audio",dts:n,pts:n},{type:"audio",dts:n+e*1024*c,pts:n+e*1024*c}]};return f},Sm=function(r){var i={pid:null,table:null},e={};ym(r,i);for(var t in i.table)if(i.table.hasOwnProperty(t)){var n=i.table[t];switch(n){case mi.H264_STREAM_TYPE:e.video=[],Tm(r,i,e),e.video.length===0&&delete e.video;break;case mi.ADTS_STREAM_TYPE:e.audio=[],Kl(r,i,e),e.audio.length===0&&delete e.audio;break}}return e},Em=function(r,i){var e=ne.aac.isLikelyAacData(r),t;return e?t=xm(r):t=Sm(r),!t||!t.audio&&!t.video?null:(bm(t,i),t)},Cm={inspect:Em,parseAudioPes_:Kl};function km(a){return a.subarray(0,a.byteLength-a[a.byteLength-1])}var fn=function(r,i){if(!(r instanceof i))throw new TypeError("Cannot call a class as a function")},Am=function(){function a(r,i){for(var e=0;e<i.length;e++){var t=i[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}return function(r,i,e){return i&&a(r.prototype,i),e&&a(r,e),r}}(),Pm=function(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof i);r.prototype=Object.create(i&&i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(r,i):r.__proto__=i)},Im=function(r,i){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i&&(typeof i=="object"||typeof i=="function")?i:r},Dm=function(){var r=[[[],[],[],[],[]],[[],[],[],[],[]]],i=r[0],e=r[1],t=i[4],n=e[4],s=void 0,o=void 0,u=void 0,l=[],c=[],f=void 0,d=void 0,m=void 0,_=void 0,b=void 0,A=void 0;for(s=0;s<256;s++)c[(l[s]=s<<1^(s>>7)*283)^s]=s;for(o=u=0;!t[o];o^=f||1,u=c[u]||1)for(_=u^u<<1^u<<2^u<<3^u<<4,_=_>>8^_&255^99,t[o]=_,n[_]=o,m=l[d=l[f=l[o]]],A=m*16843009^d*65537^f*257^o*16843008,b=l[_]*257^_*16843008,s=0;s<4;s++)i[s][o]=b=b<<24^b>>>8,e[s][_]=A=A<<24^A>>>8;for(s=0;s<5;s++)i[s]=i[s].slice(0),e[s]=e[s].slice(0);return r},Qe=null,wm=function(){function a(r){fn(this,a),Qe||(Qe=Dm()),this._tables=[[Qe[0][0].slice(),Qe[0][1].slice(),Qe[0][2].slice(),Qe[0][3].slice(),Qe[0][4].slice()],[Qe[1][0].slice(),Qe[1][1].slice(),Qe[1][2].slice(),Qe[1][3].slice(),Qe[1][4].slice()]];var i=void 0,e=void 0,t=void 0,n=void 0,s=void 0,o=this._tables[0][4],u=this._tables[1],l=r.length,c=1;if(l!==4&&l!==6&&l!==8)throw new Error("Invalid aes key size");for(n=r.slice(0),s=[],this._key=[n,s],i=l;i<4*l+28;i++)t=n[i-1],(i%l===0||l===8&&i%l===4)&&(t=o[t>>>24]<<24^o[t>>16&255]<<16^o[t>>8&255]<<8^o[t&255],i%l===0&&(t=t<<8^t>>>24^c<<24,c=c<<1^(c>>7)*283)),n[i]=n[i-l]^t;for(e=0;i;e++,i--)t=n[e&3?i:i-4],i<=4||e<4?s[e]=t:s[e]=u[0][o[t>>>24]]^u[1][o[t>>16&255]]^u[2][o[t>>8&255]]^u[3][o[t&255]]}return a.prototype.decrypt=function(i,e,t,n,s,o){var u=this._key[1],l=i^u[0],c=n^u[1],f=t^u[2],d=e^u[3],m=void 0,_=void 0,b=void 0,A=u.length/4-2,I=void 0,D=4,O=this._tables[1],M=O[0],U=O[1],R=O[2],j=O[3],G=O[4];for(I=0;I<A;I++)m=M[l>>>24]^U[c>>16&255]^R[f>>8&255]^j[d&255]^u[D],_=M[c>>>24]^U[f>>16&255]^R[d>>8&255]^j[l&255]^u[D+1],b=M[f>>>24]^U[d>>16&255]^R[l>>8&255]^j[c&255]^u[D+2],d=M[d>>>24]^U[l>>16&255]^R[c>>8&255]^j[f&255]^u[D+3],D+=4,l=m,c=_,f=b;for(I=0;I<4;I++)s[(3&-I)+o]=G[l>>>24]<<24^G[c>>16&255]<<16^G[f>>8&255]<<8^G[d&255]^u[D++],m=l,l=c,c=f,f=d,d=m},a}(),Xl=function(){function a(){fn(this,a),this.listeners={}}return a.prototype.on=function(i,e){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(e)},a.prototype.off=function(i,e){if(!this.listeners[i])return!1;var t=this.listeners[i].indexOf(e);return this.listeners[i].splice(t,1),t>-1},a.prototype.trigger=function(i){var e=this.listeners[i];if(e)if(arguments.length===2)for(var t=e.length,n=0;n<t;++n)e[n].call(this,arguments[1]);else for(var s=Array.prototype.slice.call(arguments,1),o=e.length,u=0;u<o;++u)e[u].apply(this,s)},a.prototype.dispose=function(){this.listeners={}},a.prototype.pipe=function(i){this.on("data",function(e){i.push(e)})},a}(),$l=function(a){Pm(r,a);function r(){fn(this,r);var i=Im(this,a.call(this,Xl));return i.jobs=[],i.delay=1,i.timeout_=null,i}return r.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},r.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},r}(Xl),Je=function(r){return r<<24|(r&65280)<<8|(r&16711680)>>8|r>>>24},Yl=function(r,i,e){var t=new Int32Array(r.buffer,r.byteOffset,r.byteLength>>2),n=new wm(Array.prototype.slice.call(i)),s=new Uint8Array(r.byteLength),o=new Int32Array(s.buffer),u=void 0,l=void 0,c=void 0,f=void 0,d=void 0,m=void 0,_=void 0,b=void 0,A=void 0;for(u=e[0],l=e[1],c=e[2],f=e[3],A=0;A<t.length;A+=4)d=Je(t[A]),m=Je(t[A+1]),_=Je(t[A+2]),b=Je(t[A+3]),n.decrypt(d,m,_,b,o,A),o[A]=Je(o[A]^u),o[A+1]=Je(o[A+1]^l),o[A+2]=Je(o[A+2]^c),o[A+3]=Je(o[A+3]^f),u=d,l=m,c=_,f=b;return s},Om=function(){function a(r,i,e,t){fn(this,a);var n=a.STEP,s=new Int32Array(r.buffer),o=new Uint8Array(r.byteLength),u=0;for(this.asyncStream_=new $l,this.asyncStream_.push(this.decryptChunk_(s.subarray(u,u+n),i,e,o)),u=n;u<s.length;u+=n)e=new Uint32Array([Je(s[u-4]),Je(s[u-3]),Je(s[u-2]),Je(s[u-1])]),this.asyncStream_.push(this.decryptChunk_(s.subarray(u,u+n),i,e,o));this.asyncStream_.push(function(){t(null,km(o))})}return a.prototype.decryptChunk_=function(i,e,t,n){return function(){var s=Yl(i,e,t);n.set(s,i.byteOffset)}},Am(a,null,[{key:"STEP",get:function(){return 32e3}}]),a}();/**
 * @videojs/http-streaming
 * @version 1.13.2
 * @copyright 2020 Brightcove, Inc
 * @license Apache-2.0
 */var Xt=function(r,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(r)||(r=Wa.buildAbsoluteURL(S.location.href,r)),Wa.buildAbsoluteURL(r,i))},hn=function(r,i,e){return r&&e.responseURL&&i!==e.responseURL?e.responseURL:i},Ze=function(r,i){if(!(r instanceof i))throw new TypeError("Cannot call a class as a function")},it=function(){function a(r,i){for(var e=0;e<i.length;e++){var t=i[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}return function(r,i,e){return i&&a(r.prototype,i),e&&a(r,e),r}}(),Lm=function a(r,i,e){r===null&&(r=Function.prototype);var t=Object.getOwnPropertyDescriptor(r,i);if(t===void 0){var n=Object.getPrototypeOf(r);return n===null?void 0:a(n,i,e)}else{if("value"in t)return t.value;var s=t.get;return s===void 0?void 0:s.call(e)}},xt=function(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof i);r.prototype=Object.create(i&&i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(r,i):r.__proto__=i)},lt=function(r,i){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i&&(typeof i=="object"||typeof i=="function")?i:r},Rm=function(){function a(r,i){var e=[],t=!0,n=!1,s=void 0;try{for(var o=r[Symbol.iterator](),u;!(t=(u=o.next()).done)&&(e.push(u.value),!(i&&e.length===i));t=!0);}catch(l){n=!0,s=l}finally{try{!t&&o.return&&o.return()}finally{if(n)throw s}}return e}return function(r,i){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return a(r,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_s=k.mergeOptions,Nm=k.EventTarget,Mm=k.log,dn=function(r,i){["AUDIO","SUBTITLES"].forEach(function(e){for(var t in r.mediaGroups[e])for(var n in r.mediaGroups[e][t]){var s=r.mediaGroups[e][t][n];i(s,e,t,n)}})},Um=function(r,i,e){var t=i.slice();e=e||0;for(var n=Math.min(r.length,i.length+e),s=e;s<n;s++)t[s-e]=_s(r[s],t[s-e]);return t},Fm=function(r,i){r.resolvedUri||(r.resolvedUri=Xt(i,r.uri)),r.key&&!r.key.resolvedUri&&(r.key.resolvedUri=Xt(i,r.key.uri)),r.map&&!r.map.resolvedUri&&(r.map.resolvedUri=Xt(i,r.map.uri))},ys=function(r,i){var e=_s(r,{}),t=e.playlists[i.id];if(!t||t.segments&&i.segments&&t.segments.length===i.segments.length&&t.endList===i.endList&&t.mediaSequence===i.mediaSequence)return null;var n=_s(t,i);t.segments&&(n.segments=Um(t.segments,i.segments,i.mediaSequence-t.mediaSequence)),n.segments.forEach(function(o){Fm(o,n.resolvedUri)});for(var s=0;s<e.playlists.length;s++)e.playlists[s].id===i.id&&(e.playlists[s]=n);return e.playlists[i.id]=n,e.playlists[i.uri]=n,e},Ts=function(r,i){return r+"-"+i},Ql=function(r){for(var i=r.playlists.length;i--;){var e=r.playlists[i];e.resolvedUri=Xt(r.uri,e.uri),e.id=Ts(i,e.uri),r.playlists[e.id]=e,r.playlists[e.uri]=e,e.attributes||(e.attributes={},Mm.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},Jl=function(r){dn(r,function(i){i.uri&&(i.resolvedUri=Xt(r.uri,i.uri))})},Zl=function(r,i){var e=r.segments[r.segments.length-1],t=void 0;return i&&e&&e.duration?t=e.duration*1e3:t=(r.targetDuration||10)*500,t},pn=function(a){xt(r,a);function r(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ze(this,r);var n=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),s=t.withCredentials,o=s===void 0?!1:s,u=t.handleManifestRedirects,l=u===void 0?!1:u;n.srcUrl=i,n.hls_=e,n.withCredentials=o,n.handleManifestRedirects=l;var c=e.options_;if(n.customTagParsers=c&&c.customTagParsers||[],n.customTagMappers=c&&c.customTagMappers||[],!n.srcUrl)throw new Error("A non-empty playlist URL is required");return n.state="HAVE_NOTHING",n.on("mediaupdatetimeout",function(){n.state==="HAVE_METADATA"&&(n.state="HAVE_CURRENT_METADATA",n.request=n.hls_.xhr({uri:Xt(n.master.uri,n.media().uri),withCredentials:n.withCredentials},function(f,d){if(n.request){if(f)return n.playlistRequestError(n.request,n.media(),"HAVE_METADATA");n.haveMetadata(n.request,n.media().uri,n.media().id)}}))}),n}return it(r,[{key:"playlistRequestError",value:function(e,t,n){var s=t.uri,o=t.id;this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[o],status:e.status,message:"HLS playlist request error at URL: "+s+".",responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(e,t,n){var s=this;this.request=null,this.state="HAVE_METADATA";var o=new Hu;this.customTagParsers.forEach(function(l){return o.addParser(l)}),this.customTagMappers.forEach(function(l){return o.addTagMapper(l)}),o.push(e.responseText),o.end(),o.manifest.uri=t,o.manifest.id=n,o.manifest.attributes=o.manifest.attributes||{};var u=ys(this.master,o.manifest);this.targetDuration=o.manifest.targetDuration,u?(this.master=u,this.media_=this.master.playlists[n]):this.trigger("playlistunchanged"),this.media().endList||(S.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=S.setTimeout(function(){s.trigger("mediaupdatetimeout")},Zl(this.media(),!!u))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.trigger("dispose"),this.stopRequest(),S.clearTimeout(this.mediaUpdateTimeout),S.clearTimeout(this.finalRenditionTimeout),this.off()}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"media",value:function(e,t){var n=this;if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}if(S.clearTimeout(this.finalRenditionTimeout),t){var s=e.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=S.setTimeout(this.media.bind(this,e,!1),s);return}var o=this.state,u=!this.media_||e.id!==this.media_.id;if(this.master.playlists[e.id].endList){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,u&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}if(u){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},function(l,c){if(n.request){if(e.resolvedUri=hn(n.handleManifestRedirects,e.resolvedUri,c),l)return n.playlistRequestError(n.request,e,o);n.haveMetadata(c,e.uri,e.id),o==="HAVE_MASTER"?n.trigger("loadedmetadata"):n.trigger("mediachange")}})}}},{key:"pause",value:function(){this.stopRequest(),S.clearTimeout(this.mediaUpdateTimeout),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}},{key:"load",value:function(e){var t=this;S.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(e){var s=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=S.setTimeout(function(){return t.load()},s);return}if(!this.started){this.start();return}n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}},{key:"start",value:function(){var e=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"HLS playlist request error at URL: "+e.srcUrl+".",responseText:n.responseText,code:2},e.state==="HAVE_NOTHING"&&(e.started=!1),e.trigger("error");var s=new Hu;if(e.customTagParsers.forEach(function(u){return s.addParser(u)}),e.customTagMappers.forEach(function(u){return s.addTagMapper(u)}),s.push(n.responseText),s.end(),e.state="HAVE_MASTER",e.srcUrl=hn(e.handleManifestRedirects,e.srcUrl,n),s.manifest.uri=e.srcUrl,s.manifest.playlists){e.master=s.manifest,Ql(e.master),Jl(e.master),e.trigger("loadedplaylist"),e.request||e.media(s.manifest.playlists[0]);return}var o=Ts(0,e.srcUrl);return e.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:S.location.href,playlists:[{uri:e.srcUrl,id:o,resolvedUri:e.srcUrl,attributes:{}}]},e.master.playlists[o]=e.master.playlists[0],e.master.playlists[e.srcUrl]=e.master.playlists[0],e.haveMetadata(n,e.srcUrl,o),e.trigger("loadedmetadata")}})}}]),r}(Nm),ec=k.createTimeRange,Bm=function(r,i){var e=0,t=i-r.mediaSequence,n=r.segments[t];if(n){if(typeof n.start<"u")return{result:n.start,precise:!0};if(typeof n.end<"u")return{result:n.end-n.duration,precise:!0}}for(;t--;){if(n=r.segments[t],typeof n.end<"u")return{result:e+n.end,precise:!0};if(e+=n.duration,typeof n.start<"u")return{result:e+n.start,precise:!0}}return{result:e,precise:!1}},jm=function(r,i){for(var e=0,t=void 0,n=i-r.mediaSequence;n<r.segments.length;n++){if(t=r.segments[n],typeof t.start<"u")return{result:t.start-e,precise:!0};if(e+=t.duration,typeof t.end<"u")return{result:t.end-e,precise:!0}}return{result:-1,precise:!1}},tc=function(r,i,e){var t=void 0,n=void 0;return typeof i>"u"&&(i=r.mediaSequence+r.segments.length),i<r.mediaSequence?0:(t=Bm(r,i),t.precise?t.result:(n=jm(r,i),n.precise?n.result:t.result+e))},rc=function(r,i,e){if(!r)return 0;if(typeof e!="number"&&(e=0),typeof i>"u"){if(r.totalDuration)return r.totalDuration;if(!r.endList)return S.Infinity}return tc(r,i,e)},vi=function(r,i,e){var t=0;if(i>e){var n=[e,i];i=n[0],e=n[1]}if(i<0){for(var s=i;s<Math.min(0,e);s++)t+=r.targetDuration;i=0}for(var o=i;o<e;o++)t+=r.segments[o].duration;return t},ic=function(r,i){if(!r.segments.length)return 0;var e=r.segments.length,t=r.segments[e-1].duration||r.targetDuration,n=typeof i=="number"?i:t+r.targetDuration*2;if(n===0)return e;for(var s=0;e--&&(s+=r.segments[e].duration,!(s>=n)););return Math.max(0,e)},nc=function(r,i,e,t){if(!r||!r.segments)return null;if(r.endList)return rc(r);if(i===null)return null;i=i||0;var n=e?ic(r,t):r.segments.length;return tc(r,r.mediaSequence+n,i)},Vm=function(r,i,e){var t=!0,n=i||0,s=nc(r,i,t,e);return s===null?ec():ec(n,s)},ac=function(r){return r-Math.floor(r)===0},sc=function(r,i){if(ac(i))return i+r*.1;for(var e=i.toString().split(".")[1].length,t=1;t<=e;t++){var n=Math.pow(10,t),s=i*n;if(ac(s)||t===e)return(s+r)/n}},Hm=sc.bind(null,1),Wm=sc.bind(null,-1),Gm=function(r,i,e,t){var n=void 0,s=void 0,o=r.segments.length,u=i-t;if(u<0){if(e>0){for(n=e-1;n>=0;n--)if(s=r.segments[n],u+=Wm(s.duration),u>0)return{mediaIndex:n,startTime:t-vi(r,e,n)}}return{mediaIndex:0,startTime:i}}if(e<0){for(n=e;n<0;n++)if(u-=r.targetDuration,u<0)return{mediaIndex:0,startTime:i};e=0}for(n=e;n<o;n++)if(s=r.segments[n],u-=Hm(s.duration),u<0)return{mediaIndex:n,startTime:t+vi(r,e,n)};return{mediaIndex:o-1,startTime:i}},oc=function(r){return r.excludeUntil&&r.excludeUntil>Date.now()},bs=function(r){return r.excludeUntil&&r.excludeUntil===1/0},mn=function(r){var i=oc(r);return!r.disabled&&!i},qm=function(r){return r.disabled},zm=function(r){for(var i=0;i<r.segments.length;i++)if(r.segments[i].key)return!0;return!1},Km=function(r){for(var i=0;i<r.segments.length;i++)if(r.segments[i].map)return!0;return!1},uc=function(r,i){return i.attributes&&i.attributes[r]},Xm=function(r,i,e){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(!uc("BANDWIDTH",e))return NaN;var n=r*e.attributes.BANDWIDTH;return(n-t*8)/i},xs=function(r,i){if(r.playlists.length===1)return!0;var e=i.attributes.BANDWIDTH||Number.MAX_VALUE;return r.playlists.filter(function(t){return mn(t)?(t.attributes.BANDWIDTH||0)<e:!1}).length===0},Be={duration:rc,seekable:Vm,safeLiveIndex:ic,getMediaInfoForTime:Gm,isEnabled:mn,isDisabled:qm,isBlacklisted:oc,isIncompatible:bs,playlistEnd:nc,isAes:zm,isFmp4:Km,hasAttribute:uc,estimateSegmentRequestTime:Xm,isLowestEnabledRendition:xs},$m=k.xhr,Ym=k.mergeOptions,lc=function(){var r=function i(e,t){e=Ym({timeout:45e3},e);var n=i.beforeRequest||k.Hls.xhr.beforeRequest;if(n&&typeof n=="function"){var s=n(e);s&&(e=s)}var o=$m(e,function(l,c){var f=o.response;!l&&f&&(o.responseTime=Date.now(),o.roundTripTime=o.responseTime-o.requestTime,o.bytesReceived=f.byteLength||f.length,o.bandwidth||(o.bandwidth=Math.floor(o.bytesReceived/o.roundTripTime*8*1e3))),c.headers&&(o.responseHeaders=c.headers),l&&l.code==="ETIMEDOUT"&&(o.timedout=!0),!l&&!o.aborted&&c.statusCode!==200&&c.statusCode!==206&&c.statusCode!==0&&(l=new Error("XHR Failed with a response of: "+(o&&(f||o.responseText)))),t(l,o)}),u=o.abort;return o.abort=function(){return o.aborted=!0,u.apply(o,arguments)},o.uri=e.uri,o.requestTime=Date.now(),o};return r},Qm=function(r){var i=void 0,e=void 0;return e=r.offset+r.length-1,i=r.offset,"bytes="+i+"-"+e},Ss=function(r){var i={};return r.byterange&&(i.Range=Qm(r.byterange)),i},Jm=function(r,i){return r.start(i)+"-"+r.end(i)},Zm=function(r,i){var e=r.toString(16);return"00".substring(0,2-e.length)+e+(i%2?" ":"")},ev=function(r){return r>=32&&r<126?String.fromCharCode(r):"."},cc=function(r){var i={};return Object.keys(r).forEach(function(e){var t=r[e];ArrayBuffer.isView(t)?i[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:i[e]=t}),i},vn=function(r){var i=r.byterange||{length:1/0,offset:0};return[i.length,i.offset,r.resolvedUri].join(",")},fc=function(r){return r.resolvedUri},hc=function(r){for(var i=Array.prototype.slice.call(r),e=16,t="",n=void 0,s=void 0,o=0;o<i.length/e;o++)n=i.slice(o*e,o*e+e).map(Zm).join(""),s=i.slice(o*e,o*e+e).map(ev).join(""),t+=n+" "+s+`
`;return t},tv=function(r){var i=r.bytes;return hc(i)},rv=function(r){var i="",e=void 0;for(e=0;e<r.length;e++)i+=Jm(r,e)+" ";return i},iv=Object.freeze({createTransferableMessage:cc,initSegmentId:vn,segmentKeyId:fc,hexDump:hc,tagDump:tv,textRanges:rv}),dc=.25,nv=function(r,i){if(!i.dateTimeObject)return null;var e=i.videoTimingInfo.transmuxerPrependedSeconds,t=i.videoTimingInfo.transmuxedPresentationStart,n=t+e,s=r-n;return new Date(i.dateTimeObject.getTime()+s*1e3)},av=function(r){return r.transmuxedPresentationEnd-r.transmuxedPresentationStart-r.transmuxerPrependedSeconds},sv=function(r,i){var e=void 0;try{e=new Date(r)}catch{return null}if(!i||!i.segments||i.segments.length===0)return null;var t=i.segments[0];if(e<t.dateTimeObject)return null;for(var n=0;n<i.segments.length-1;n++){t=i.segments[n];var s=i.segments[n+1].dateTimeObject;if(e<s)break}var o=i.segments[i.segments.length-1],u=o.dateTimeObject,l=o.videoTimingInfo?av(o.videoTimingInfo):o.duration+o.duration*dc,c=new Date(u.getTime()+l*1e3);return e>c?null:(e>u&&(t=o),{segment:t,estimatedStart:t.videoTimingInfo?t.videoTimingInfo.transmuxedPresentationStart:Be.duration(i,i.mediaSequence+i.segments.indexOf(t)),type:t.videoTimingInfo?"accurate":"estimate"})},ov=function(r,i){if(!i||!i.segments||i.segments.length===0)return null;for(var e=0,t=void 0,n=0;n<i.segments.length&&(t=i.segments[n],e=t.videoTimingInfo?t.videoTimingInfo.transmuxedPresentationEnd:e+t.duration,!(r<=e));n++);var s=i.segments[i.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<r)return null;if(r>e){if(r>e+s.duration*dc)return null;t=s}return{segment:t,estimatedStart:t.videoTimingInfo?t.videoTimingInfo.transmuxedPresentationStart:e-t.duration,type:t.videoTimingInfo?"accurate":"estimate"}},uv=function(r,i){var e=void 0,t=void 0;try{e=new Date(r),t=new Date(i)}catch{}var n=e.getTime(),s=t.getTime();return(s-n)/1e3},lv=function(r){if(!r.segments||r.segments.length===0)return!1;for(var i=0;i<r.segments.length;i++){var e=r.segments[i];if(!e.dateTimeObject)return!1}return!0},cv=function(r){var i=r.playlist,e=r.time,t=e===void 0?void 0:e,n=r.callback;if(!n)throw new Error("getProgramTime: callback must be provided");if(!i||t===void 0)return n({message:"getProgramTime: playlist and time must be provided"});var s=ov(t,i);if(!s)return n({message:"valid programTime was not found"});if(s.type==="estimate")return n({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:s.estimatedStart});var o={mediaSeconds:t},u=nv(t,s.segment);return u&&(o.programDateTime=u.toISOString()),n(null,o)},fv=function a(r){var i=r.programTime,e=r.playlist,t=r.retryCount,n=t===void 0?2:t,s=r.seekTo,o=r.pauseAfterSeek,u=o===void 0?!0:o,l=r.tech,c=r.callback;if(!c)throw new Error("seekToProgramTime: callback must be provided");if(typeof i>"u"||!e||!s)return c({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!l.hasStarted_)return c({message:"player must be playing a live stream to start buffering"});if(!lv(e))return c({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});var f=sv(i,e);if(!f)return c({message:i+" was not found in the stream"});var d=f.segment,m=uv(d.dateTimeObject,i);if(f.type==="estimate"){if(n===0)return c({message:i+" is not buffered yet. Try again"});s(f.estimatedStart+m),l.one("seeked",function(){a({programTime:i,playlist:e,retryCount:n-1,seekTo:s,pauseAfterSeek:u,tech:l,callback:c})});return}var _=d.start+m,b=function(){return c(null,l.currentTime())};l.one("seeked",b),u&&l.pause(),s(_)},gn=1/30,St=gn*3,pc=function(r,i){var e=[],t=void 0;if(r&&r.length)for(t=0;t<r.length;t++)i(r.start(t),r.end(t))&&e.push([r.start(t),r.end(t)]);return k.createTimeRanges(e)},mc=function(r,i){return pc(r,function(e,t){return e-St<=i&&t+St>=i})},vc=function(r,i){return pc(r,function(e){return e-gn>=i})},hv=function(r){if(r.length<2)return k.createTimeRanges();for(var i=[],e=1;e<r.length;e++){var t=r.end(e-1),n=r.start(e);i.push([t,n])}return k.createTimeRanges(i)},Es=function(r){var i=[];if(!r||!r.length)return"";for(var e=0;e<r.length;e++)i.push(r.start(e)+" => "+r.end(e));return i.join(", ")},dv=function(r,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,t=r.length?r.end(r.length-1):0;return(t-i)/e},gc=function(r){for(var i=[],e=0;e<r.length;e++)i.push({start:r.start(e),end:r.end(e)});return i},pv=function(r,i,e){var t=i.player_;if(e.captions&&e.captions.length){r.inbandTextTracks_||(r.inbandTextTracks_={});for(var n in e.captionStreams)if(!r.inbandTextTracks_[n]){t.tech_.trigger({type:"usage",name:"hls-608"});var s=t.textTracks().getTrackById(n);s?r.inbandTextTracks_[n]=s:r.inbandTextTracks_[n]=t.addRemoteTextTrack({kind:"captions",id:n,label:n},!1).track}}e.metadata&&e.metadata.length&&!r.metadataTrack_&&(r.metadataTrack_=t.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,r.metadataTrack_.inBandMetadataTrackDispatchType=e.metadata.dispatchType)},Or=function(r,i,e){var t=void 0,n=void 0;if(e&&e.cues)for(t=e.cues.length;t--;)n=e.cues[t],n.startTime<=i&&n.endTime>=r&&e.removeCue(n)},mv=function(r){Object.defineProperties(r.frame,{id:{get:function(){return k.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),r.value.key}},value:{get:function(){return k.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),r.value.data}},privateData:{get:function(){return k.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),r.value.data}}})},_c=function(r){var i=void 0;return isNaN(r)||Math.abs(r)===1/0?i=Number.MAX_VALUE:i=r,i},vv=function(r,i,e){var t=S.WebKitDataCue||S.VTTCue;if(i&&i.forEach(function(f){var d=f.stream;this.inbandTextTracks_[d].addCue(new t(f.startTime+this.timestampOffset,f.endTime+this.timestampOffset,f.text))},r),e){var n=_c(r.mediaSource_.duration);if(e.forEach(function(f){var d=f.cueTime+this.timestampOffset;typeof d!="number"||S.isNaN(d)||d<0||!(d<1/0)||f.frames.forEach(function(m){var _=new t(d,d,m.value||m.url||m.data||"");_.frame=m,_.value=m,mv(_),this.metadataTrack_.addCue(_)},this)},r),r.metadataTrack_&&r.metadataTrack_.cues&&r.metadataTrack_.cues.length){for(var s=r.metadataTrack_.cues,o=[],u=0;u<s.length;u++)s[u]&&o.push(s[u]);var l=o.reduce(function(f,d){var m=f[d.startTime]||[];return m.push(d),f[d.startTime]=m,f},{}),c=Object.keys(l).sort(function(f,d){return Number(f)-Number(d)});c.forEach(function(f,d){var m=l[f],_=Number(c[d+1])||n;m.forEach(function(b){b.endTime=_})})}}},$t=typeof window<"u"?window:{},Cs=typeof Symbol>"u"?"__target":Symbol(),gv="application/javascript",_v=$t.BlobBuilder||$t.WebKitBlobBuilder||$t.MozBlobBuilder||$t.MSBlobBuilder,Lr=$t.URL||$t.webkitURL||Lr&&Lr.msURL,Rr=$t.Worker;function yc(a,r){return function(e){var t=this;if(r)if(Rr&&!e){var n=r.toString().replace(/^function.+?{/,"").slice(0,-1),s=xc(n);return this[Cs]=new Rr(s),yv(this[Cs],s),this[Cs]}else{var o={postMessage:function(l){t.onmessage&&setTimeout(function(){t.onmessage({data:l,target:o})})}};r.call(o),this.postMessage=function(u){setTimeout(function(){o.onmessage({data:u,target:t})})},this.isThisThread=!0}else return new Rr(a)}}if(Rr){var _n,Tc=xc("self.onmessage = function () {}"),bc=new Uint8Array(1);try{_n=new Rr(Tc),_n.postMessage(bc,[bc.buffer])}catch{Rr=null}finally{Lr.revokeObjectURL(Tc),_n&&_n.terminate()}}function xc(a){try{return Lr.createObjectURL(new Blob([a],{type:gv}))}catch{var r=new _v;return r.append(a),Lr.createObjectURL(r.getBlob(type))}}function yv(a,r){if(!(!a||!r)){var i=a.terminate;a.objURL=r,a.terminate=function(){a.objURL&&Lr.revokeObjectURL(a.objURL),i.call(a)}}}var Tv=new yc("./transmuxer-worker.worker.js",function(a,r){var i=this,e=function(){var t=function(){this.init=function(){var h={};this.on=function(p,v){h[p]||(h[p]=[]),h[p]=h[p].concat(v)},this.off=function(p,v){var g;return h[p]?(g=h[p].indexOf(v),h[p]=h[p].slice(),h[p].splice(g,1),g>-1):!1},this.trigger=function(p){var v,g,y,T;if(v=h[p],!!v)if(arguments.length===2)for(y=v.length,g=0;g<y;++g)v[g].call(this,arguments[1]);else{for(T=[],g=arguments.length,g=1;g<arguments.length;++g)T.push(arguments[g]);for(y=v.length,g=0;g<y;++g)v[g].apply(this,T)}},this.dispose=function(){h={}}}};t.prototype.pipe=function(x){return this.on("data",function(h){x.push(h)}),this.on("done",function(h){x.flush(h)}),this.on("partialdone",function(h){x.partialFlush(h)}),this.on("endedtimeline",function(h){x.endTimeline(h)}),this.on("reset",function(h){x.reset(h)}),x},t.prototype.push=function(x){this.trigger("data",x)},t.prototype.flush=function(x){this.trigger("done",x)},t.prototype.partialFlush=function(x){this.trigger("partialdone",x)},t.prototype.endTimeline=function(x){this.trigger("endedtimeline",x)},t.prototype.reset=function(x){this.trigger("reset",x)};var n=t,s=Math.pow(2,32)-1,o,u,l,c,f,d,m,_,b,A,I,D,O,M,U,R,j,G,Q,$,z,K,V,oe,ve,ee,ue,_e,Ve,ce,ct,Et,ft,Yt,Qt,Jt;(function(){var x;if(V={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(x in V)V.hasOwnProperty(x)&&(V[x]=[x.charCodeAt(0),x.charCodeAt(1),x.charCodeAt(2),x.charCodeAt(3)]);oe=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),ee=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),ve=new Uint8Array([0,0,0,1]),ue=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),_e=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Ve={video:ue,audio:_e},Et=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ct=new Uint8Array([0,0,0,0,0,0,0,0]),ft=new Uint8Array([0,0,0,0,0,0,0,0]),Yt=ft,Qt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Jt=ft,ce=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),o=function(h){var p=[],v=0,g,y,T;for(g=1;g<arguments.length;g++)p.push(arguments[g]);for(g=p.length;g--;)v+=p[g].byteLength;for(y=new Uint8Array(v+8),T=new DataView(y.buffer,y.byteOffset,y.byteLength),T.setUint32(0,y.byteLength),y.set(h,4),g=0,v=8;g<p.length;g++)y.set(p[g],v),v+=p[g].byteLength;return y},u=function(){return o(V.dinf,o(V.dref,Et))},l=function(h){return o(V.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,h.audioobjecttype<<3|h.samplingfrequencyindex>>>1,h.samplingfrequencyindex<<7|h.channelcount<<3,6,1,2]))},c=function(){return o(V.ftyp,oe,ve,oe,ee)},R=function(h){return o(V.hdlr,Ve[h])},f=function(h){return o(V.mdat,h)},U=function(h){var p=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,h.duration>>>24&255,h.duration>>>16&255,h.duration>>>8&255,h.duration&255,85,196,0,0]);return h.samplerate&&(p[12]=h.samplerate>>>24&255,p[13]=h.samplerate>>>16&255,p[14]=h.samplerate>>>8&255,p[15]=h.samplerate&255),o(V.mdhd,p)},M=function(h){return o(V.mdia,U(h),R(h.type),m(h))},d=function(h){return o(V.mfhd,new Uint8Array([0,0,0,0,(h&4278190080)>>24,(h&16711680)>>16,(h&65280)>>8,h&255]))},m=function(h){return o(V.minf,h.type==="video"?o(V.vmhd,ce):o(V.smhd,ct),u(),G(h))},_=function(h,p){for(var v=[],g=p.length;g--;)v[g]=$(p[g]);return o.apply(null,[V.moof,d(h)].concat(v))},b=function(h){for(var p=h.length,v=[];p--;)v[p]=D(h[p]);return o.apply(null,[V.moov,I(4294967295)].concat(v).concat(A(h)))},A=function(h){for(var p=h.length,v=[];p--;)v[p]=z(h[p]);return o.apply(null,[V.mvex].concat(v))},I=function(h){var p=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(h&4278190080)>>24,(h&16711680)>>16,(h&65280)>>8,h&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o(V.mvhd,p)},j=function(h){var p=h.samples||[],v=new Uint8Array(4+p.length),g,y;for(y=0;y<p.length;y++)g=p[y].flags,v[y+4]=g.dependsOn<<4|g.isDependedOn<<2|g.hasRedundancy;return o(V.sdtp,v)},G=function(h){return o(V.stbl,Q(h),o(V.stts,Jt),o(V.stsc,Yt),o(V.stsz,Qt),o(V.stco,ft))},function(){var x,h;Q=function(v){return o(V.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),v.type==="video"?x(v):h(v))},x=function(v){var g=v.sps||[],y=v.pps||[],T=[],C=[],E,P;for(E=0;E<g.length;E++)T.push((g[E].byteLength&65280)>>>8),T.push(g[E].byteLength&255),T=T.concat(Array.prototype.slice.call(g[E]));for(E=0;E<y.length;E++)C.push((y[E].byteLength&65280)>>>8),C.push(y[E].byteLength&255),C=C.concat(Array.prototype.slice.call(y[E]));if(P=[V.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(v.width&65280)>>8,v.width&255,(v.height&65280)>>8,v.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o(V.avcC,new Uint8Array([1,v.profileIdc,v.profileCompatibility,v.levelIdc,255].concat([g.length],T,[y.length],C))),o(V.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],v.sarRatio){var w=v.sarRatio[0],B=v.sarRatio[1];P.push(o(V.pasp,new Uint8Array([(w&4278190080)>>24,(w&16711680)>>16,(w&65280)>>8,w&255,(B&4278190080)>>24,(B&16711680)>>16,(B&65280)>>8,B&255])))}return o.apply(null,P)},h=function(v){return o(V.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(v.channelcount&65280)>>8,v.channelcount&255,(v.samplesize&65280)>>8,v.samplesize&255,0,0,0,0,(v.samplerate&65280)>>8,v.samplerate&255,0,0]),l(v))}}(),O=function(h){var p=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(h.id&4278190080)>>24,(h.id&16711680)>>16,(h.id&65280)>>8,h.id&255,0,0,0,0,(h.duration&4278190080)>>24,(h.duration&16711680)>>16,(h.duration&65280)>>8,h.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(h.width&65280)>>8,h.width&255,0,0,(h.height&65280)>>8,h.height&255,0,0]);return o(V.tkhd,p)},$=function(h){var p,v,g,y,T,C,E;return p=o(V.tfhd,new Uint8Array([0,0,0,58,(h.id&4278190080)>>24,(h.id&16711680)>>16,(h.id&65280)>>8,h.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),C=Math.floor(h.baseMediaDecodeTime/(s+1)),E=Math.floor(h.baseMediaDecodeTime%(s+1)),v=o(V.tfdt,new Uint8Array([1,0,0,0,C>>>24&255,C>>>16&255,C>>>8&255,C&255,E>>>24&255,E>>>16&255,E>>>8&255,E&255])),T=32+20+8+16+8+8,h.type==="audio"?(g=K(h,T),o(V.traf,p,v,g)):(y=j(h),g=K(h,y.length+T),o(V.traf,p,v,g,y))},D=function(h){return h.duration=h.duration||4294967295,o(V.trak,O(h),M(h))},z=function(h){var p=new Uint8Array([0,0,0,0,(h.id&4278190080)>>24,(h.id&16711680)>>16,(h.id&65280)>>8,h.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return h.type!=="video"&&(p[p.length-1]=0),o(V.trex,p)},function(){var x,h,p;p=function(g,y){var T=0,C=0,E=0,P=0;return g.length&&(g[0].duration!==void 0&&(T=1),g[0].size!==void 0&&(C=2),g[0].flags!==void 0&&(E=4),g[0].compositionTimeOffset!==void 0&&(P=8)),[0,0,T|C|E|P,1,(g.length&4278190080)>>>24,(g.length&16711680)>>>16,(g.length&65280)>>>8,g.length&255,(y&4278190080)>>>24,(y&16711680)>>>16,(y&65280)>>>8,y&255]},h=function(g,y){var T,C,E,P;for(C=g.samples||[],y+=8+12+16*C.length,T=p(C,y),P=0;P<C.length;P++)E=C[P],T=T.concat([(E.duration&4278190080)>>>24,(E.duration&16711680)>>>16,(E.duration&65280)>>>8,E.duration&255,(E.size&4278190080)>>>24,(E.size&16711680)>>>16,(E.size&65280)>>>8,E.size&255,E.flags.isLeading<<2|E.flags.dependsOn,E.flags.isDependedOn<<6|E.flags.hasRedundancy<<4|E.flags.paddingValue<<1|E.flags.isNonSyncSample,E.flags.degradationPriority&61440,E.flags.degradationPriority&15,(E.compositionTimeOffset&4278190080)>>>24,(E.compositionTimeOffset&16711680)>>>16,(E.compositionTimeOffset&65280)>>>8,E.compositionTimeOffset&255]);return o(V.trun,new Uint8Array(T))},x=function(g,y){var T,C,E,P;for(C=g.samples||[],y+=8+12+8*C.length,T=p(C,y),P=0;P<C.length;P++)E=C[P],T=T.concat([(E.duration&4278190080)>>>24,(E.duration&16711680)>>>16,(E.duration&65280)>>>8,E.duration&255,(E.size&4278190080)>>>24,(E.size&16711680)>>>16,(E.size&65280)>>>8,E.size&255]);return o(V.trun,new Uint8Array(T))},K=function(g,y){return g.type==="audio"?x(g,y):h(g,y)}}();var ht={ftyp:c,mdat:f,moof:_,moov:b,initSegment:function(h){var p=c(),v=b(h),g;return g=new Uint8Array(p.byteLength+v.byteLength),g.set(p),g.set(v,p.byteLength),g}},Ur=function(h){var p,v,g=[],y=[];for(y.byteLength=0,y.nalCount=0,y.duration=0,g.byteLength=0,p=0;p<h.length;p++)v=h[p],v.nalUnitType==="access_unit_delimiter_rbsp"?(g.length&&(g.duration=v.dts-g.dts,y.byteLength+=g.byteLength,y.nalCount+=g.length,y.duration+=g.duration,y.push(g)),g=[v],g.byteLength=v.data.byteLength,g.pts=v.pts,g.dts=v.dts):(v.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(g.keyFrame=!0),g.duration=v.dts-g.dts,g.byteLength+=v.data.byteLength,g.push(v));return y.length&&(!g.duration||g.duration<=0)&&(g.duration=y[y.length-1].duration),y.byteLength+=g.byteLength,y.nalCount+=g.length,y.duration+=g.duration,y.push(g),y},Rg=function(h){var p,v,g=[],y=[];for(g.byteLength=0,g.nalCount=0,g.duration=0,g.pts=h[0].pts,g.dts=h[0].dts,y.byteLength=0,y.nalCount=0,y.duration=0,y.pts=h[0].pts,y.dts=h[0].dts,p=0;p<h.length;p++)v=h[p],v.keyFrame?(g.length&&(y.push(g),y.byteLength+=g.byteLength,y.nalCount+=g.nalCount,y.duration+=g.duration),g=[v],g.nalCount=v.length,g.byteLength=v.byteLength,g.pts=v.pts,g.dts=v.dts,g.duration=v.duration):(g.duration+=v.duration,g.nalCount+=v.length,g.byteLength+=v.byteLength,g.push(v));return y.length&&g.duration<=0&&(g.duration=y[y.length-1].duration),y.byteLength+=g.byteLength,y.nalCount+=g.nalCount,y.duration+=g.duration,y.push(g),y},Ng=function(h){var p;return!h[0][0].keyFrame&&h.length>1&&(p=h.shift(),h.byteLength-=p.byteLength,h.nalCount-=p.nalCount,h[0][0].dts=p.dts,h[0][0].pts=p.pts,h[0][0].duration+=p.duration),h},Mg=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},Kc=function(h,p){var v=Mg();return v.dataOffset=p,v.compositionTimeOffset=h.pts-h.dts,v.duration=h.duration,v.size=4*h.length,v.size+=h.byteLength,h.keyFrame&&(v.flags.dependsOn=2,v.flags.isNonSyncSample=0),v},Ug=function(h,p){var v,g,y,T,C,E=p||0,P=[];for(v=0;v<h.length;v++)for(T=h[v],g=0;g<T.length;g++)C=T[g],y=Kc(C,E),E+=y.size,P.push(y);return P},Fg=function(h){var p,v,g,y,T,C,E=0,P=h.byteLength,w=h.nalCount,B=P+4*w,q=new Uint8Array(B),X=new DataView(q.buffer);for(p=0;p<h.length;p++)for(y=h[p],v=0;v<y.length;v++)for(T=y[v],g=0;g<T.length;g++)C=T[g],X.setUint32(E,C.data.byteLength),E+=4,q.set(C.data,E),E+=C.data.byteLength;return q},Bg=function(h,p){var v,g=p||0,y=[];return v=Kc(h,g),y.push(v),y},jg=function(h){var p,v,g=0,y=h.byteLength,T=h.length,C=y+4*T,E=new Uint8Array(C),P=new DataView(E.buffer);for(p=0;p<h.length;p++)v=h[p],P.setUint32(g,v.data.byteLength),g+=4,E.set(v.data,g),g+=v.data.byteLength;return E},bi={groupNalsIntoFrames:Ur,groupFramesIntoGops:Rg,extendFirstKeyFrame:Ng,generateSampleTable:Ug,concatenateNalData:Fg,generateSampleTableForFrame:Bg,concatenateNalDataForFrame:jg},Nt=[33,16,5,32,164,27],Fs=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ae=function(h){for(var p=[];h--;)p.push(0);return p},Vg=function(h){return Object.keys(h).reduce(function(p,v){return p[v]=new Uint8Array(h[v].reduce(function(g,y){return g.concat(y)},[])),p},{})},Hg={96e3:[Nt,[227,64],ae(154),[56]],88200:[Nt,[231],ae(170),[56]],64e3:[Nt,[248,192],ae(240),[56]],48e3:[Nt,[255,192],ae(268),[55,148,128],ae(54),[112]],44100:[Nt,[255,192],ae(268),[55,163,128],ae(84),[112]],32e3:[Nt,[255,192],ae(268),[55,234],ae(226),[112]],24e3:[Nt,[255,192],ae(268),[55,255,128],ae(268),[111,112],ae(126),[224]],16e3:[Nt,[255,192],ae(268),[55,255,128],ae(268),[111,255],ae(269),[223,108],ae(195),[1,192]],12e3:[Fs,ae(268),[3,127,248],ae(268),[6,255,240],ae(268),[13,255,224],ae(268),[27,253,128],ae(259),[56]],11025:[Fs,ae(268),[3,127,248],ae(268),[6,255,240],ae(268),[13,255,224],ae(268),[27,255,192],ae(268),[55,175,128],ae(108),[112]],8e3:[Fs,ae(268),[3,121,16],ae(47),[7]]},Wg=Vg(Hg),Bs=9e4,js,Vs,bn,Hs,Xc,$c,Yc;js=function(h){return h*Bs},Vs=function(h,p){return h*p},bn=function(h){return h/Bs},Hs=function(h,p){return h/p},Xc=function(h,p){return js(Hs(h,p))},$c=function(h,p){return Vs(bn(h),p)},Yc=function(h,p,v){return bn(v?h:h-p)};var dt={ONE_SECOND_IN_TS:Bs,secondsToVideoTs:js,secondsToAudioTs:Vs,videoTsToSeconds:bn,audioTsToSeconds:Hs,audioTsToVideoTs:Xc,videoTsToAudioTs:$c,metadataTsToSeconds:Yc},Gg=function(h){var p,v,g=0;for(p=0;p<h.length;p++)v=h[p],g+=v.data.byteLength;return g},qg=function(h,p,v,g){var y,T=0,C=0,E=0,P=0,w,B,q;if(p.length&&(y=dt.audioTsToVideoTs(h.baseMediaDecodeTime,h.samplerate),T=Math.ceil(dt.ONE_SECOND_IN_TS/(h.samplerate/1024)),v&&g&&(C=y-Math.max(v,g),E=Math.floor(C/T),P=E*T),!(E<1||P>dt.ONE_SECOND_IN_TS/2))){for(w=Wg[h.samplerate],w||(w=p[0].data),B=0;B<E;B++)q=p[0],p.splice(0,0,{data:w,dts:q.dts-T,pts:q.pts-T});h.baseMediaDecodeTime-=Math.floor(dt.videoTsToAudioTs(P,h.samplerate))}},zg=function(h,p,v){return p.minSegmentDts>=v?h:(p.minSegmentDts=1/0,h.filter(function(g){return g.dts>=v?(p.minSegmentDts=Math.min(p.minSegmentDts,g.dts),p.minSegmentPts=p.minSegmentDts,!0):!1}))},Kg=function(h){var p,v,g=[];for(p=0;p<h.length;p++)v=h[p],g.push({size:v.data.byteLength,duration:1024});return g},Xg=function(h){var p,v,g=0,y=new Uint8Array(Gg(h));for(p=0;p<h.length;p++)v=h[p],y.set(v.data,g),g+=v.data.byteLength;return y},xn={prefixWithSilence:qg,trimAdtsFramesByEarliestDts:zg,generateSampleTable:Kg,concatenateFrameData:Xg},$g=dt.ONE_SECOND_IN_TS,Yg=function(h,p){typeof p.pts=="number"&&(h.timelineStartInfo.pts===void 0&&(h.timelineStartInfo.pts=p.pts),h.minSegmentPts===void 0?h.minSegmentPts=p.pts:h.minSegmentPts=Math.min(h.minSegmentPts,p.pts),h.maxSegmentPts===void 0?h.maxSegmentPts=p.pts:h.maxSegmentPts=Math.max(h.maxSegmentPts,p.pts)),typeof p.dts=="number"&&(h.timelineStartInfo.dts===void 0&&(h.timelineStartInfo.dts=p.dts),h.minSegmentDts===void 0?h.minSegmentDts=p.dts:h.minSegmentDts=Math.min(h.minSegmentDts,p.dts),h.maxSegmentDts===void 0?h.maxSegmentDts=p.dts:h.maxSegmentDts=Math.max(h.maxSegmentDts,p.dts))},Qg=function(h){delete h.minSegmentDts,delete h.maxSegmentDts,delete h.minSegmentPts,delete h.maxSegmentPts},Jg=function(h,p){var v,g,y=h.minSegmentDts;return p||(y-=h.timelineStartInfo.dts),v=h.timelineStartInfo.baseMediaDecodeTime,v+=y,v=Math.max(0,v),h.type==="audio"&&(g=h.samplerate/$g,v*=g,v=Math.floor(v)),v},nt={clearDtsInfo:Qg,calculateTrackBaseMediaDecodeTime:Jg,collectDtsInfo:Yg},Qc=4,Zg=128,e0=function(h){for(var p=0,v={payloadType:-1,payloadSize:0},g=0,y=0;p<h.byteLength&&h[p]!==Zg;){for(;h[p]===255;)g+=255,p++;for(g+=h[p++];h[p]===255;)y+=255,p++;if(y+=h[p++],!v.payload&&g===Qc){v.payloadType=g,v.payloadSize=y,v.payload=h.subarray(p,p+y);break}p+=y,g=0,y=0}return v},t0=function(h){return h.payload[0]!==181||(h.payload[1]<<8|h.payload[2])!==49||String.fromCharCode(h.payload[3],h.payload[4],h.payload[5],h.payload[6])!=="GA94"||h.payload[7]!==3?null:h.payload.subarray(8,h.payload.length-1)},r0=function(h,p){var v=[],g,y,T,C;if(!(p[0]&64))return v;for(y=p[0]&31,g=0;g<y;g++)T=g*3,C={type:p[T+2]&3,pts:h},p[T+2]&4&&(C.ccData=p[T+3]<<8|p[T+4],v.push(C));return v},i0=function(h){for(var p=h.byteLength,v=[],g=1,y,T;g<p-2;)h[g]===0&&h[g+1]===0&&h[g+2]===3?(v.push(g+2),g+=2):g++;if(v.length===0)return h;y=p-v.length,T=new Uint8Array(y);var C=0;for(g=0;g<y;C++,g++)C===v[0]&&(C++,v.shift()),T[g]=h[C];return T},Sn={parseSei:e0,parseUserData:t0,parseCaptionPackets:r0,discardEmulationPreventionBytes:i0,USER_DATA_REGISTERED_ITU_T_T35:Qc},et=function x(){x.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new me(0,0),new me(0,1),new me(1,0),new me(1,1)],this.reset(),this.ccStreams_.forEach(function(h){h.on("data",this.trigger.bind(this,"data")),h.on("partialdone",this.trigger.bind(this,"partialdone")),h.on("done",this.trigger.bind(this,"done"))},this)};et.prototype=new n,et.prototype.push=function(x){var h,p,v;if(x.nalUnitType==="sei_rbsp"&&(h=Sn.parseSei(x.escapedRBSP),h.payloadType===Sn.USER_DATA_REGISTERED_ITU_T_T35&&(p=Sn.parseUserData(h),!!p))){if(x.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(x.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}v=Sn.parseCaptionPackets(x.pts,p),this.captionPackets_=this.captionPackets_.concat(v),this.latestDts_!==x.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=x.dts}},et.prototype.flushCCStreams=function(x){this.ccStreams_.forEach(function(h){return x==="flush"?h.flush():h.partialFlush()},this)},et.prototype.flushStream=function(x){if(!this.captionPackets_.length){this.flushCCStreams(x);return}this.captionPackets_.forEach(function(h,p){h.presortIndex=p}),this.captionPackets_.sort(function(h,p){return h.pts===p.pts?h.presortIndex-p.presortIndex:h.pts-p.pts}),this.captionPackets_.forEach(function(h){h.type<2&&this.dispatchCea608Packet(h)},this),this.captionPackets_.length=0,this.flushCCStreams(x)},et.prototype.flush=function(){return this.flushStream("flush")},et.prototype.partialFlush=function(){return this.flushStream("partialFlush")},et.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(x){x.reset()})},et.prototype.dispatchCea608Packet=function(x){this.setsTextOrXDSActive(x)?this.activeCea608Channel_[x.type]=null:this.setsChannel1Active(x)?this.activeCea608Channel_[x.type]=0:this.setsChannel2Active(x)&&(this.activeCea608Channel_[x.type]=1),this.activeCea608Channel_[x.type]!==null&&this.ccStreams_[(x.type<<1)+this.activeCea608Channel_[x.type]].push(x)},et.prototype.setsChannel1Active=function(x){return(x.ccData&30720)===4096},et.prototype.setsChannel2Active=function(x){return(x.ccData&30720)===6144},et.prototype.setsTextOrXDSActive=function(x){return(x.ccData&28928)===256||(x.ccData&30974)===4138||(x.ccData&30974)===6186};var n0={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},En=function(h){return h===null?"":(h=n0[h]||h,String.fromCharCode(h))},Cn=14,a0=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Zt=function(){for(var h=[],p=Cn+1;p--;)h.push("");return h},me=function x(h,p){x.prototype.init.call(this),this.field_=h||0,this.dataChannel_=p||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(v){var g,y,T,C,E;if(g=v.ccData&32639,g===this.lastControlCode_){this.lastControlCode_=null;return}if((g&61440)===4096?this.lastControlCode_=g:g!==this.PADDING_&&(this.lastControlCode_=null),T=g>>>8,C=g&255,g!==this.PADDING_)if(g===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(g===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(v.pts),this.flushDisplayed(v.pts),y=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=y,this.startPts_=v.pts;else if(g===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(v.pts);else if(g===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(v.pts);else if(g===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(v.pts);else if(g===this.CARRIAGE_RETURN_)this.clearFormatting(v.pts),this.flushDisplayed(v.pts),this.shiftRowsUp_(),this.startPts_=v.pts;else if(g===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(g===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(v.pts),this.displayed_=Zt();else if(g===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Zt();else if(g===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(v.pts),this.displayed_=Zt()),this.mode_="paintOn",this.startPts_=v.pts;else if(this.isSpecialCharacter(T,C))T=(T&3)<<8,E=En(T|C),this[this.mode_](v.pts,E),this.column_++;else if(this.isExtCharacter(T,C))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),T=(T&3)<<8,E=En(T|C),this[this.mode_](v.pts,E),this.column_++;else if(this.isMidRowCode(T,C))this.clearFormatting(v.pts),this[this.mode_](v.pts," "),this.column_++,(C&14)===14&&this.addFormatting(v.pts,["i"]),(C&1)===1&&this.addFormatting(v.pts,["u"]);else if(this.isOffsetControlCode(T,C))this.column_+=C&3;else if(this.isPAC(T,C)){var P=a0.indexOf(g&7968);this.mode_==="rollUp"&&(P-this.rollUpRows_+1<0&&(P=this.rollUpRows_-1),this.setRollUp(v.pts,P)),P!==this.row_&&(this.clearFormatting(v.pts),this.row_=P),C&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(v.pts,["u"]),(g&16)===16&&(this.column_=((g&14)>>1)*4),this.isColorPAC(C)&&(C&14)===14&&this.addFormatting(v.pts,["i"])}else this.isNormalChar(T)&&(C===0&&(C=null),E=En(T),E+=En(C),this[this.mode_](v.pts,E),this.column_+=E.length)}};me.prototype=new n,me.prototype.flushDisplayed=function(x){var h=this.displayed_.map(function(p){try{return p.trim()}catch{return console.error("Skipping malformed caption."),""}}).join(`
`).replace(/^\n+|\n+$/g,"");h.length&&this.trigger("data",{startPts:this.startPts_,endPts:x,text:h,stream:this.name_})},me.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Zt(),this.nonDisplayed_=Zt(),this.lastControlCode_=null,this.column_=0,this.row_=Cn,this.rollUpRows_=2,this.formatting_=[]},me.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},me.prototype.isSpecialCharacter=function(x,h){return x===this.EXT_&&h>=48&&h<=63},me.prototype.isExtCharacter=function(x,h){return(x===this.EXT_+1||x===this.EXT_+2)&&h>=32&&h<=63},me.prototype.isMidRowCode=function(x,h){return x===this.EXT_&&h>=32&&h<=47},me.prototype.isOffsetControlCode=function(x,h){return x===this.OFFSET_&&h>=33&&h<=35},me.prototype.isPAC=function(x,h){return x>=this.BASE_&&x<this.BASE_+8&&h>=64&&h<=127},me.prototype.isColorPAC=function(x){return x>=64&&x<=79||x>=96&&x<=127},me.prototype.isNormalChar=function(x){return x>=32&&x<=127},me.prototype.setRollUp=function(x,h){if(this.mode_!=="rollUp"&&(this.row_=Cn,this.mode_="rollUp",this.flushDisplayed(x),this.nonDisplayed_=Zt(),this.displayed_=Zt()),h!==void 0&&h!==this.row_)for(var p=0;p<this.rollUpRows_;p++)this.displayed_[h-p]=this.displayed_[this.row_-p],this.displayed_[this.row_-p]="";h===void 0&&(h=this.row_),this.topRow_=h-this.rollUpRows_+1},me.prototype.addFormatting=function(x,h){this.formatting_=this.formatting_.concat(h);var p=h.reduce(function(v,g){return v+"<"+g+">"},"");this[this.mode_](x,p)},me.prototype.clearFormatting=function(x){if(this.formatting_.length){var h=this.formatting_.reverse().reduce(function(p,v){return p+"</"+v+">"},"");this.formatting_=[],this[this.mode_](x,h)}},me.prototype.popOn=function(x,h){var p=this.nonDisplayed_[this.row_];p+=h,this.nonDisplayed_[this.row_]=p},me.prototype.rollUp=function(x,h){var p=this.displayed_[this.row_];p+=h,this.displayed_[this.row_]=p},me.prototype.shiftRowsUp_=function(){var x;for(x=0;x<this.topRow_;x++)this.displayed_[x]="";for(x=this.row_+1;x<Cn+1;x++)this.displayed_[x]="";for(x=this.topRow_;x<this.row_;x++)this.displayed_[x]=this.displayed_[x+1];this.displayed_[this.row_]=""},me.prototype.paintOn=function(x,h){var p=this.displayed_[this.row_];p+=h,this.displayed_[this.row_]=p};var Jc={CaptionStream:et,Cea608Stream:me},ze={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},s0=8589934592,o0=4294967296,Zc="shared",Ws=function(h,p){var v=1;for(h>p&&(v=-1);Math.abs(p-h)>o0;)h+=v*s0;return h},ef=function x(h){var p,v;x.prototype.init.call(this),this.type_=h||Zc,this.push=function(g){this.type_!==Zc&&g.type!==this.type_||(v===void 0&&(v=g.dts),g.dts=Ws(g.dts,v),g.pts=Ws(g.pts,v),p=g.dts,this.trigger("data",g))},this.flush=function(){v=p,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){v=void 0,p=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};ef.prototype=new n;var u0={TimestampRolloverStream:ef,handleRollover:Ws},tf=function(h,p,v){var g,y="";for(g=p;g<v;g++)y+="%"+("00"+h[g].toString(16)).slice(-2);return y},kn=function(h,p,v){return decodeURIComponent(tf(h,p,v))},l0=function(h,p,v){return unescape(tf(h,p,v))},An=function(h){return h[0]<<21|h[1]<<14|h[2]<<7|h[3]},rf={TXXX:function(h){var p;if(h.data[0]===3){for(p=1;p<h.data.length;p++)if(h.data[p]===0){h.description=kn(h.data,1,p),h.value=kn(h.data,p+1,h.data.length).replace(/\0*$/,"");break}h.data=h.value}},WXXX:function(h){var p;if(h.data[0]===3){for(p=1;p<h.data.length;p++)if(h.data[p]===0){h.description=kn(h.data,1,p),h.url=kn(h.data,p+1,h.data.length);break}}},PRIV:function(h){var p;for(p=0;p<h.data.length;p++)if(h.data[p]===0){h.owner=l0(h.data,0,p);break}h.privateData=h.data.subarray(p+1),h.data=h.privateData}},Pn;Pn=function(h){var p={debug:!!(h&&h.debug),descriptor:h&&h.descriptor},v=0,g=[],y=0,T;if(Pn.prototype.init.call(this),this.dispatchType=ze.METADATA_STREAM_TYPE.toString(16),p.descriptor)for(T=0;T<p.descriptor.length;T++)this.dispatchType+=("00"+p.descriptor[T].toString(16)).slice(-2);this.push=function(C){var E,P,w,B,q,X;if(C.type==="timed-metadata"){if(C.dataAlignmentIndicator&&(y=0,g.length=0),g.length===0&&(C.data.length<10||C.data[0]!=="I".charCodeAt(0)||C.data[1]!=="D".charCodeAt(0)||C.data[2]!=="3".charCodeAt(0))){p.debug&&console.log("Skipping unrecognized metadata packet");return}if(g.push(C),y+=C.data.byteLength,g.length===1&&(v=An(C.data.subarray(6,10)),v+=10),!(y<v)){for(E={data:new Uint8Array(v),frames:[],pts:g[0].pts,dts:g[0].dts},q=0;q<v;)E.data.set(g[0].data.subarray(0,v-q),q),q+=g[0].data.byteLength,y-=g[0].data.byteLength,g.shift();P=10,E.data[5]&64&&(P+=4,P+=An(E.data.subarray(10,14)),v-=An(E.data.subarray(16,20)));do{if(w=An(E.data.subarray(P+4,P+8)),w<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(X=String.fromCharCode(E.data[P],E.data[P+1],E.data[P+2],E.data[P+3]),B={id:X,data:E.data.subarray(P+10,P+w+10)},B.key=B.id,rf[B.id]&&(rf[B.id](B),B.owner==="com.apple.streaming.transportStreamTimestamp")){var Z=B.data,ie=(Z[3]&1)<<30|Z[4]<<22|Z[5]<<14|Z[6]<<6|Z[7]>>>2;ie*=4,ie+=Z[7]&3,B.timeStamp=ie,E.pts===void 0&&E.dts===void 0&&(E.pts=B.timeStamp,E.dts=B.timeStamp),this.trigger("timestamp",B)}E.frames.push(B),P+=10,P+=w}while(P<v);this.trigger("data",E)}}}},Pn.prototype=new n;var c0=Pn,f0=u0.TimestampRolloverStream,In,xi,Dn,Fr=188,Gs=71;In=function(){var h=new Uint8Array(Fr),p=0;In.prototype.init.call(this),this.push=function(v){var g=0,y=Fr,T;for(p?(T=new Uint8Array(v.byteLength+p),T.set(h.subarray(0,p)),T.set(v,p),p=0):T=v;y<T.byteLength;){if(T[g]===Gs&&T[y]===Gs){this.trigger("data",T.subarray(g,y)),g+=Fr,y+=Fr;continue}g++,y++}g<T.byteLength&&(h.set(T.subarray(g),0),p=T.byteLength-g)},this.flush=function(){p===Fr&&h[0]===Gs&&(this.trigger("data",h),p=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){p=0,this.trigger("reset")}},In.prototype=new n,xi=function(){var h,p,v,g;xi.prototype.init.call(this),g=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,h=function(T,C){var E=0;C.payloadUnitStartIndicator&&(E+=T[E]+1),C.type==="pat"?p(T.subarray(E),C):v(T.subarray(E),C)},p=function(T,C){C.section_number=T[7],C.last_section_number=T[8],g.pmtPid=(T[10]&31)<<8|T[11],C.pmtPid=g.pmtPid},v=function(T,C){var E,P,w,B;if(T[5]&1){for(g.programMapTable={video:null,audio:null,"timed-metadata":{}},E=(T[1]&15)<<8|T[2],P=3+E-4,w=(T[10]&15)<<8|T[11],B=12+w;B<P;){var q=T[B],X=(T[B+1]&31)<<8|T[B+2];q===ze.H264_STREAM_TYPE&&g.programMapTable.video===null?g.programMapTable.video=X:q===ze.ADTS_STREAM_TYPE&&g.programMapTable.audio===null?g.programMapTable.audio=X:q===ze.METADATA_STREAM_TYPE&&(g.programMapTable["timed-metadata"][X]=q),B+=((T[B+3]&15)<<8|T[B+4])+5}C.programMapTable=g.programMapTable}},this.push=function(y){var T={},C=4;if(T.payloadUnitStartIndicator=!!(y[1]&64),T.pid=y[1]&31,T.pid<<=8,T.pid|=y[2],(y[3]&48)>>>4>1&&(C+=y[C]+1),T.pid===0)T.type="pat",h(y.subarray(C),T),this.trigger("data",T);else if(T.pid===this.pmtPid)for(T.type="pmt",h(y.subarray(C),T),this.trigger("data",T);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([y,C,T]):this.processPes_(y,C,T)},this.processPes_=function(y,T,C){C.pid===this.programMapTable.video?C.streamType=ze.H264_STREAM_TYPE:C.pid===this.programMapTable.audio?C.streamType=ze.ADTS_STREAM_TYPE:C.streamType=this.programMapTable["timed-metadata"][C.pid],C.type="pes",C.data=y.subarray(T),this.trigger("data",C)}},xi.prototype=new n,xi.STREAM_TYPES={h264:27,adts:15},Dn=function(){var h=this,p={data:[],size:0},v={data:[],size:0},g={data:[],size:0},y,T=function(P,w){var B;w.packetLength=6+(P[4]<<8|P[5]),w.dataAlignmentIndicator=(P[6]&4)!==0,B=P[7],B&192&&(w.pts=(P[9]&14)<<27|(P[10]&255)<<20|(P[11]&254)<<12|(P[12]&255)<<5|(P[13]&254)>>>3,w.pts*=4,w.pts+=(P[13]&6)>>>1,w.dts=w.pts,B&64&&(w.dts=(P[14]&14)<<27|(P[15]&255)<<20|(P[16]&254)<<12|(P[17]&255)<<5|(P[18]&254)>>>3,w.dts*=4,w.dts+=(P[18]&6)>>>1)),w.data=P.subarray(9+P[8])},C=function(P,w,B){var q=new Uint8Array(P.size),X={type:w},Z=0,ie=0,F=!1,Ae;if(!(!P.data.length||P.size<9)){for(X.trackId=P.data[0].pid,Z=0;Z<P.data.length;Z++)Ae=P.data[Z],q.set(Ae.data,ie),ie+=Ae.data.byteLength;T(q,X),F=w==="video"||X.packetLength<=P.size,(B||F)&&(P.size=0,P.data.length=0),F&&h.trigger("data",X)}};Dn.prototype.init.call(this),this.push=function(E){({pat:function(){},pes:function(){var w,B;switch(E.streamType){case ze.H264_STREAM_TYPE:case ze.H264_STREAM_TYPE:w=p,B="video";break;case ze.ADTS_STREAM_TYPE:w=v,B="audio";break;case ze.METADATA_STREAM_TYPE:w=g,B="timed-metadata";break;default:return}E.payloadUnitStartIndicator&&C(w,B,!0),w.data.push(E),w.size+=E.data.byteLength},pmt:function(){var w={type:"metadata",tracks:[]};y=E.programMapTable,y.video!==null&&w.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+y.video,codec:"avc",type:"video"}),y.audio!==null&&w.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+y.audio,codec:"adts",type:"audio"}),h.trigger("data",w)}})[E.type]()},this.reset=function(){p.size=0,p.data.length=0,v.size=0,v.data.length=0,this.trigger("reset")},this.flushStreams_=function(){C(p,"video"),C(v,"audio"),C(g,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}},Dn.prototype=new n;var nf={PAT_PID:0,MP2T_PACKET_LENGTH:Fr,TransportPacketStream:In,TransportParseStream:xi,ElementaryStream:Dn,TimestampRolloverStream:f0,CaptionStream:Jc.CaptionStream,Cea608Stream:Jc.Cea608Stream,MetadataStream:c0};for(var qs in ze)ze.hasOwnProperty(qs)&&(nf[qs]=ze[qs]);var Ct=nf,h0=dt.ONE_SECOND_IN_TS,wn,af=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];wn=function(h){var p,v=0;wn.prototype.init.call(this),this.push=function(g){var y=0,T,C,E,P,w,B;if(h||(v=0),g.type==="audio")for(p?(P=p,p=new Uint8Array(P.byteLength+g.data.byteLength),p.set(P),p.set(g.data,P.byteLength)):p=g.data;y+5<p.length;){if(p[y]!==255||(p[y+1]&246)!==240){y++;continue}if(C=(~p[y+1]&1)*2,T=(p[y+3]&3)<<11|p[y+4]<<3|(p[y+5]&224)>>5,w=((p[y+6]&3)+1)*1024,B=w*h0/af[(p[y+2]&60)>>>2],E=y+T,p.byteLength<E)return;if(this.trigger("data",{pts:g.pts+v*B,dts:g.dts+v*B,sampleCount:w,audioobjecttype:(p[y+2]>>>6&3)+1,channelcount:(p[y+2]&1)<<2|(p[y+3]&192)>>>6,samplerate:af[(p[y+2]&60)>>>2],samplingfrequencyindex:(p[y+2]&60)>>>2,samplesize:16,data:p.subarray(y+7+C,E)}),v++,p.byteLength===E){p=void 0;return}p=p.subarray(E)}},this.flush=function(){v=0,this.trigger("done")},this.reset=function(){p=void 0,this.trigger("reset")},this.endTimeline=function(){p=void 0,this.trigger("endedtimeline")}},wn.prototype=new n;var sf=wn,of;of=function(h){var p=h.byteLength,v=0,g=0;this.length=function(){return 8*p},this.bitsAvailable=function(){return 8*p+g},this.loadWord=function(){var y=h.byteLength-p,T=new Uint8Array(4),C=Math.min(4,p);if(C===0)throw new Error("no bytes available");T.set(h.subarray(y,y+C)),v=new DataView(T.buffer).getUint32(0),g=C*8,p-=C},this.skipBits=function(y){var T;g>y?(v<<=y,g-=y):(y-=g,T=Math.floor(y/8),y-=T*8,p-=T,this.loadWord(),v<<=y,g-=y)},this.readBits=function(y){var T=Math.min(g,y),C=v>>>32-T;return g-=T,g>0?v<<=T:p>0&&this.loadWord(),T=y-T,T>0?C<<T|this.readBits(T):C},this.skipLeadingZeros=function(){var y;for(y=0;y<g;++y)if(v&2147483648>>>y)return v<<=y,g-=y,y;return this.loadWord(),y+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var y=this.skipLeadingZeros();return this.readBits(y+1)-1},this.readExpGolomb=function(){var y=this.readUnsignedExpGolomb();return 1&y?1+y>>>1:-1*(y>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var d0=of,On,Si,uf;Si=function(){var h=0,p,v;Si.prototype.init.call(this),this.push=function(g){var y;v?(y=new Uint8Array(v.byteLength+g.data.byteLength),y.set(v),y.set(g.data,v.byteLength),v=y):v=g.data;for(var T=v.byteLength;h<T-3;h++)if(v[h+2]===1){p=h+5;break}for(;p<T;)switch(v[p]){case 0:if(v[p-1]!==0){p+=2;break}else if(v[p-2]!==0){p++;break}h+3!==p-2&&this.trigger("data",v.subarray(h+3,p-2));do p++;while(v[p]!==1&&p<T);h=p-2,p+=3;break;case 1:if(v[p-1]!==0||v[p-2]!==0){p+=3;break}this.trigger("data",v.subarray(h+3,p-2)),h=p-2,p+=3;break;default:p+=3;break}v=v.subarray(h),p-=h,h=0},this.reset=function(){v=null,h=0,this.trigger("reset")},this.flush=function(){v&&v.byteLength>3&&this.trigger("data",v.subarray(h+3)),v=null,h=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},Si.prototype=new n,uf={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},On=function(){var h=new Si,p,v,g,y,T,C,E;On.prototype.init.call(this),p=this,this.push=function(P){P.type==="video"&&(v=P.trackId,g=P.pts,y=P.dts,h.push(P))},h.on("data",function(P){var w={trackId:v,pts:g,dts:y,data:P};switch(P[0]&31){case 5:w.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:w.nalUnitType="sei_rbsp",w.escapedRBSP=T(P.subarray(1));break;case 7:w.nalUnitType="seq_parameter_set_rbsp",w.escapedRBSP=T(P.subarray(1)),w.config=C(w.escapedRBSP);break;case 8:w.nalUnitType="pic_parameter_set_rbsp";break;case 9:w.nalUnitType="access_unit_delimiter_rbsp";break}p.trigger("data",w)}),h.on("done",function(){p.trigger("done")}),h.on("partialdone",function(){p.trigger("partialdone")}),h.on("reset",function(){p.trigger("reset")}),h.on("endedtimeline",function(){p.trigger("endedtimeline")}),this.flush=function(){h.flush()},this.partialFlush=function(){h.partialFlush()},this.reset=function(){h.reset()},this.endTimeline=function(){h.endTimeline()},E=function(w,B){var q=8,X=8,Z,ie;for(Z=0;Z<w;Z++)X!==0&&(ie=B.readExpGolomb(),X=(q+ie+256)%256),q=X===0?q:X},T=function(w){for(var B=w.byteLength,q=[],X=1,Z,ie;X<B-2;)w[X]===0&&w[X+1]===0&&w[X+2]===3?(q.push(X+2),X+=2):X++;if(q.length===0)return w;Z=B-q.length,ie=new Uint8Array(Z);var F=0;for(X=0;X<Z;F++,X++)F===q[0]&&(F++,q.shift()),ie[X]=w[F];return ie},C=function(w){var B=0,q=0,X=0,Z=0,ie=1,F,Ae,at,jr,$s,Ys,df,pf,mf,Qs,vf,ye,gf,tr;if(F=new d0(w),Ae=F.readUnsignedByte(),jr=F.readUnsignedByte(),at=F.readUnsignedByte(),F.skipUnsignedExpGolomb(),uf[Ae]&&($s=F.readUnsignedExpGolomb(),$s===3&&F.skipBits(1),F.skipUnsignedExpGolomb(),F.skipUnsignedExpGolomb(),F.skipBits(1),F.readBoolean()))for(vf=$s!==3?8:12,tr=0;tr<vf;tr++)F.readBoolean()&&(tr<6?E(16,F):E(64,F));if(F.skipUnsignedExpGolomb(),Ys=F.readUnsignedExpGolomb(),Ys===0)F.readUnsignedExpGolomb();else if(Ys===1)for(F.skipBits(1),F.skipExpGolomb(),F.skipExpGolomb(),df=F.readUnsignedExpGolomb(),tr=0;tr<df;tr++)F.skipExpGolomb();if(F.skipUnsignedExpGolomb(),F.skipBits(1),pf=F.readUnsignedExpGolomb(),mf=F.readUnsignedExpGolomb(),Qs=F.readBits(1),Qs===0&&F.skipBits(1),F.skipBits(1),F.readBoolean()&&(B=F.readUnsignedExpGolomb(),q=F.readUnsignedExpGolomb(),X=F.readUnsignedExpGolomb(),Z=F.readUnsignedExpGolomb()),F.readBoolean()&&F.readBoolean()){switch(gf=F.readUnsignedByte(),gf){case 1:ye=[1,1];break;case 2:ye=[12,11];break;case 3:ye=[10,11];break;case 4:ye=[16,11];break;case 5:ye=[40,33];break;case 6:ye=[24,11];break;case 7:ye=[20,11];break;case 8:ye=[32,11];break;case 9:ye=[80,33];break;case 10:ye=[18,11];break;case 11:ye=[15,11];break;case 12:ye=[64,33];break;case 13:ye=[160,99];break;case 14:ye=[4,3];break;case 15:ye=[3,2];break;case 16:ye=[2,1];break;case 255:{ye=[F.readUnsignedByte()<<8|F.readUnsignedByte(),F.readUnsignedByte()<<8|F.readUnsignedByte()];break}}ye&&(ie=ye[0]/ye[1])}return{profileIdc:Ae,levelIdc:at,profileCompatibility:jr,width:Math.ceil(((pf+1)*16-B*2-q*2)*ie),height:(2-Qs)*(mf+1)*16-X*2-Z*2,sarRatio:ye}}},On.prototype=new n;var p0={H264Stream:On,NalByteStream:Si},m0=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],v0=function(h){return h[0]==="I".charCodeAt(0)&&h[1]==="D".charCodeAt(0)&&h[2]==="3".charCodeAt(0)},lf=function(h){return h[0]<<21|h[1]<<14|h[2]<<7|h[3]},g0=function(h,p,v){var g,y="";for(g=p;g<v;g++)y+="%"+("00"+h[g].toString(16)).slice(-2);return y},_0=function(h,p,v){return unescape(g0(h,p,v))},y0=function(h,p){var v=h[p+6]<<21|h[p+7]<<14|h[p+8]<<7|h[p+9],g=h[p+5],y=(g&16)>>4;return y?v+20:v+10},T0=function(h,p){var v=(h[p+5]&224)>>5,g=h[p+4]<<3,y=h[p+3]&6144;return y|g|v},b0=function(h,p){return h[p]==="I".charCodeAt(0)&&h[p+1]==="D".charCodeAt(0)&&h[p+2]==="3".charCodeAt(0)?"timed-metadata":h[p]&!0&&(h[p+1]&240)===240?"audio":null},x0=function(h){for(var p=0;p+5<h.length;){if(h[p]!==255||(h[p+1]&246)!==240){p++;continue}return m0[(h[p+2]&60)>>>2]}return null},S0=function(h){var p,v,g,y;p=10,h[5]&64&&(p+=4,p+=lf(h.subarray(10,14)));do{if(v=lf(h.subarray(p+4,p+8)),v<1)return null;if(y=String.fromCharCode(h[p],h[p+1],h[p+2],h[p+3]),y==="PRIV"){g=h.subarray(p+10,p+v+10);for(var T=0;T<g.byteLength;T++)if(g[T]===0){var C=_0(g,0,T);if(C==="com.apple.streaming.transportStreamTimestamp"){var E=g.subarray(T+1),P=(E[3]&1)<<30|E[4]<<22|E[5]<<14|E[6]<<6|E[7]>>>2;return P*=4,P+=E[7]&3,P}break}}p+=10,p+=v}while(p<h.byteLength);return null},zs={isLikelyAacData:v0,parseId3TagSize:y0,parseAdtsSize:T0,parseType:b0,parseSampleRate:x0,parseAacTimestamp:S0},Ln;Ln=function(){var h=new Uint8Array,p=0;Ln.prototype.init.call(this),this.setTimestamp=function(v){p=v},this.push=function(v){var g=0,y=0,T,C,E,P;for(h.length?(P=h.length,h=new Uint8Array(v.byteLength+P),h.set(h.subarray(0,P)),h.set(v,P)):h=v;h.length-y>=3;){if(h[y]==="I".charCodeAt(0)&&h[y+1]==="D".charCodeAt(0)&&h[y+2]==="3".charCodeAt(0)){if(h.length-y<10||(g=zs.parseId3TagSize(h,y),y+g>h.length))break;C={type:"timed-metadata",data:h.subarray(y,y+g)},this.trigger("data",C),y+=g;continue}else if((h[y]&255)===255&&(h[y+1]&240)===240){if(h.length-y<7||(g=zs.parseAdtsSize(h,y),y+g>h.length))break;E={type:"audio",data:h.subarray(y,y+g),pts:p,dts:p},this.trigger("data",E),y+=g;continue}y++}T=h.length-y,T>0?h=h.subarray(y):h=new Uint8Array},this.reset=function(){h=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){h=new Uint8Array,this.trigger("endedtimeline")}},Ln.prototype=new n;var E0=Ln,C0=p0.H264Stream,k0=zs.isLikelyAacData,A0=dt.ONE_SECOND_IN_TS,Ks=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Xs=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Ei,Br,Rn,er,cf=function(h,p){var v;if(h.length!==p.length)return!1;for(v=0;v<h.length;v++)if(h[v]!==p[v])return!1;return!0},ff=function(h,p,v,g,y,T){var C=v-p,E=g-p,P=y-v;return{start:{dts:h,pts:h+C},end:{dts:h+E,pts:h+P},prependedContentDuration:T,baseMediaDecodeTime:h}};Br=function(h,p){var v=[],g=0,y=0,T=0,C=1/0;p=p||{},Br.prototype.init.call(this),this.push=function(E){nt.collectDtsInfo(h,E),h&&Ks.forEach(function(P){h[P]=E[P]}),v.push(E)},this.setEarliestDts=function(E){y=E-h.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(E){C=E},this.setAudioAppendStart=function(E){T=E},this.flush=function(){var E,P,w,B,q;if(v.length===0){this.trigger("done","AudioSegmentStream");return}E=xn.trimAdtsFramesByEarliestDts(v,h,y),h.baseMediaDecodeTime=nt.calculateTrackBaseMediaDecodeTime(h,p.keepOriginalTimestamps),xn.prefixWithSilence(h,E,T,C),h.samples=xn.generateSampleTable(E),w=ht.mdat(xn.concatenateFrameData(E)),v=[],P=ht.moof(g,[h]),B=new Uint8Array(P.byteLength+w.byteLength),g++,B.set(P),B.set(w,P.byteLength),nt.clearDtsInfo(h),q=Math.ceil(A0*1024/h.samplerate),E.length&&this.trigger("timingInfo",{start:E[0].pts,end:E[0].pts+E.length*q}),this.trigger("data",{track:h,boxes:B}),this.trigger("done","AudioSegmentStream")},this.reset=function(){nt.clearDtsInfo(h),v=[],this.trigger("reset")}},Br.prototype=new n,Ei=function(h,p){var v=0,g=[],y=[],T,C;p=p||{},Ei.prototype.init.call(this),delete h.minPTS,this.gopCache_=[],this.push=function(E){nt.collectDtsInfo(h,E),E.nalUnitType==="seq_parameter_set_rbsp"&&!T&&(T=E.config,h.sps=[E.data],Xs.forEach(function(P){h[P]=T[P]},this)),E.nalUnitType==="pic_parameter_set_rbsp"&&!C&&(C=E.data,h.pps=[E.data]),g.push(E)},this.flush=function(){for(var E,P,w,B,q,X,Z=0,ie,F;g.length&&g[0].nalUnitType!=="access_unit_delimiter_rbsp";)g.shift();if(g.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(E=bi.groupNalsIntoFrames(g),w=bi.groupFramesIntoGops(E),w[0][0].keyFrame||(P=this.getGopForFusion_(g[0],h),P?(Z=P.duration,w.unshift(P),w.byteLength+=P.byteLength,w.nalCount+=P.nalCount,w.pts=P.pts,w.dts=P.dts,w.duration+=P.duration):w=bi.extendFirstKeyFrame(w)),y.length){var Ae;if(p.alignGopsAtEnd?Ae=this.alignGopsAtEnd_(w):Ae=this.alignGopsAtStart_(w),!Ae){this.gopCache_.unshift({gop:w.pop(),pps:h.pps,sps:h.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),g=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}nt.clearDtsInfo(h),w=Ae}nt.collectDtsInfo(h,w),h.samples=bi.generateSampleTable(w),q=ht.mdat(bi.concatenateNalData(w)),h.baseMediaDecodeTime=nt.calculateTrackBaseMediaDecodeTime(h,p.keepOriginalTimestamps),this.trigger("processedGopsInfo",w.map(function(at){return{pts:at.pts,dts:at.dts,byteLength:at.byteLength}})),ie=w[0],F=w[w.length-1],this.trigger("segmentTimingInfo",ff(h.baseMediaDecodeTime,ie.dts,ie.pts,F.dts+F.duration,F.pts+F.duration,Z)),this.trigger("timingInfo",{start:w[0].pts,end:w[w.length-1].pts+w[w.length-1].duration}),this.gopCache_.unshift({gop:w.pop(),pps:h.pps,sps:h.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),g=[],this.trigger("baseMediaDecodeTime",h.baseMediaDecodeTime),this.trigger("timelineStartInfo",h.timelineStartInfo),B=ht.moof(v,[h]),X=new Uint8Array(B.byteLength+q.byteLength),v++,X.set(B),X.set(q,B.byteLength),this.trigger("data",{track:h,boxes:X}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),g=[],this.gopCache_.length=0,y.length=0,this.trigger("reset")},this.resetStream_=function(){nt.clearDtsInfo(h),T=void 0,C=void 0},this.getGopForFusion_=function(E){var P=45e3,w=1e4,B=1/0,q,X,Z,ie,F;for(F=0;F<this.gopCache_.length;F++)ie=this.gopCache_[F],Z=ie.gop,!(!(h.pps&&cf(h.pps[0],ie.pps[0]))||!(h.sps&&cf(h.sps[0],ie.sps[0])))&&(Z.dts<h.timelineStartInfo.dts||(q=E.dts-Z.dts-Z.duration,q>=-w&&q<=P&&(!X||B>q)&&(X=ie,B=q)));return X?X.gop:null},this.alignGopsAtStart_=function(E){var P,w,B,q,X,Z,ie,F;for(X=E.byteLength,Z=E.nalCount,ie=E.duration,P=w=0;P<y.length&&w<E.length&&(B=y[P],q=E[w],B.pts!==q.pts);){if(q.pts>B.pts){P++;continue}w++,X-=q.byteLength,Z-=q.nalCount,ie-=q.duration}return w===0?E:w===E.length?null:(F=E.slice(w),F.byteLength=X,F.duration=ie,F.nalCount=Z,F.pts=F[0].pts,F.dts=F[0].dts,F)},this.alignGopsAtEnd_=function(E){var P,w,B,q,X,Z;for(P=y.length-1,w=E.length-1,X=null,Z=!1;P>=0&&w>=0;){if(B=y[P],q=E[w],B.pts===q.pts){Z=!0;break}if(B.pts>q.pts){P--;continue}P===y.length-1&&(X=w),w--}if(!Z&&X===null)return null;var ie;if(Z?ie=w:ie=X,ie===0)return E;var F=E.slice(ie),Ae=F.reduce(function(at,jr){return at.byteLength+=jr.byteLength,at.duration+=jr.duration,at.nalCount+=jr.nalCount,at},{byteLength:0,duration:0,nalCount:0});return F.byteLength=Ae.byteLength,F.duration=Ae.duration,F.nalCount=Ae.nalCount,F.pts=F[0].pts,F.dts=F[0].dts,F},this.alignGopsWith=function(E){y=E}},Ei.prototype=new n,er=function(h,p){this.numberOfTracks=0,this.metadataStream=p,h=h||{},typeof h.remux<"u"?this.remuxTracks=!!h.remux:this.remuxTracks=!0,typeof h.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=h.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,er.prototype.init.call(this),this.push=function(v){if(v.text)return this.pendingCaptions.push(v);if(v.frames)return this.pendingMetadata.push(v);this.pendingTracks.push(v.track),this.pendingBytes+=v.boxes.byteLength,v.track.type==="video"&&(this.videoTrack=v.track,this.pendingBoxes.push(v.boxes)),v.track.type==="audio"&&(this.audioTrack=v.track,this.pendingBoxes.unshift(v.boxes))}},er.prototype=new n,er.prototype.flush=function(x){var h=0,p={captions:[],captionStreams:{},metadata:[],info:{}},v,g,y,T=0,C;if(this.pendingTracks.length<this.numberOfTracks){if(x!=="VideoSegmentStream"&&x!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(T=this.videoTrack.timelineStartInfo.pts,Xs.forEach(function(E){p.info[E]=this.videoTrack[E]},this)):this.audioTrack&&(T=this.audioTrack.timelineStartInfo.pts,Ks.forEach(function(E){p.info[E]=this.audioTrack[E]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?p.type=this.pendingTracks[0].type:p.type="combined",this.emittedTracks+=this.pendingTracks.length,y=ht.initSegment(this.pendingTracks),p.initSegment=new Uint8Array(y.byteLength),p.initSegment.set(y),p.data=new Uint8Array(this.pendingBytes),C=0;C<this.pendingBoxes.length;C++)p.data.set(this.pendingBoxes[C],h),h+=this.pendingBoxes[C].byteLength;for(C=0;C<this.pendingCaptions.length;C++)v=this.pendingCaptions[C],v.startTime=dt.metadataTsToSeconds(v.startPts,T,this.keepOriginalTimestamps),v.endTime=dt.metadataTsToSeconds(v.endPts,T,this.keepOriginalTimestamps),p.captionStreams[v.stream]=!0,p.captions.push(v);for(C=0;C<this.pendingMetadata.length;C++)g=this.pendingMetadata[C],g.cueTime=dt.metadataTsToSeconds(g.pts,T,this.keepOriginalTimestamps),p.metadata.push(g);for(p.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",p),C=0;C<p.captions.length;C++)v=p.captions[C],this.trigger("caption",v);for(C=0;C<p.metadata.length;C++)g=p.metadata[C],this.trigger("id3Frame",g)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},er.prototype.setRemux=function(x){this.remuxTracks=x},Rn=function(h){var p=this,v=!0,g,y;Rn.prototype.init.call(this),h=h||{},this.baseMediaDecodeTime=h.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var T={};this.transmuxPipeline_=T,T.type="aac",T.metadataStream=new Ct.MetadataStream,T.aacStream=new E0,T.audioTimestampRolloverStream=new Ct.TimestampRolloverStream("audio"),T.timedMetadataTimestampRolloverStream=new Ct.TimestampRolloverStream("timed-metadata"),T.adtsStream=new sf,T.coalesceStream=new er(h,T.metadataStream),T.headOfPipeline=T.aacStream,T.aacStream.pipe(T.audioTimestampRolloverStream).pipe(T.adtsStream),T.aacStream.pipe(T.timedMetadataTimestampRolloverStream).pipe(T.metadataStream).pipe(T.coalesceStream),T.metadataStream.on("timestamp",function(C){T.aacStream.setTimestamp(C.timeStamp)}),T.aacStream.on("data",function(C){C.type==="timed-metadata"&&!T.audioSegmentStream&&(y=y||{timelineStartInfo:{baseMediaDecodeTime:p.baseMediaDecodeTime},codec:"adts",type:"audio"},T.coalesceStream.numberOfTracks++,T.audioSegmentStream=new Br(y,h),T.audioSegmentStream.on("timingInfo",p.trigger.bind(p,"audioTimingInfo")),T.adtsStream.pipe(T.audioSegmentStream).pipe(T.coalesceStream)),p.trigger("trackinfo",{hasAudio:!!y,hasVideo:!!g})}),T.coalesceStream.on("data",this.trigger.bind(this,"data")),T.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var T={};this.transmuxPipeline_=T,T.type="ts",T.metadataStream=new Ct.MetadataStream,T.packetStream=new Ct.TransportPacketStream,T.parseStream=new Ct.TransportParseStream,T.elementaryStream=new Ct.ElementaryStream,T.timestampRolloverStream=new Ct.TimestampRolloverStream,T.adtsStream=new sf,T.h264Stream=new C0,T.captionStream=new Ct.CaptionStream,T.coalesceStream=new er(h,T.metadataStream),T.headOfPipeline=T.packetStream,T.packetStream.pipe(T.parseStream).pipe(T.elementaryStream).pipe(T.timestampRolloverStream),T.timestampRolloverStream.pipe(T.h264Stream),T.timestampRolloverStream.pipe(T.adtsStream),T.timestampRolloverStream.pipe(T.metadataStream).pipe(T.coalesceStream),T.h264Stream.pipe(T.captionStream).pipe(T.coalesceStream),T.elementaryStream.on("data",function(C){var E;if(C.type==="metadata"){for(E=C.tracks.length;E--;)!g&&C.tracks[E].type==="video"?(g=C.tracks[E],g.timelineStartInfo.baseMediaDecodeTime=p.baseMediaDecodeTime):!y&&C.tracks[E].type==="audio"&&(y=C.tracks[E],y.timelineStartInfo.baseMediaDecodeTime=p.baseMediaDecodeTime);g&&!T.videoSegmentStream&&(T.coalesceStream.numberOfTracks++,T.videoSegmentStream=new Ei(g,h),T.videoSegmentStream.on("timelineStartInfo",function(P){y&&(y.timelineStartInfo=P,T.audioSegmentStream.setEarliestDts(P.dts))}),T.videoSegmentStream.on("processedGopsInfo",p.trigger.bind(p,"gopInfo")),T.videoSegmentStream.on("segmentTimingInfo",p.trigger.bind(p,"videoSegmentTimingInfo")),T.videoSegmentStream.on("baseMediaDecodeTime",function(P){y&&T.audioSegmentStream.setVideoBaseMediaDecodeTime(P)}),T.videoSegmentStream.on("timingInfo",p.trigger.bind(p,"videoTimingInfo")),T.h264Stream.pipe(T.videoSegmentStream).pipe(T.coalesceStream)),y&&!T.audioSegmentStream&&(T.coalesceStream.numberOfTracks++,T.audioSegmentStream=new Br(y,h),T.audioSegmentStream.on("timingInfo",p.trigger.bind(p,"audioTimingInfo")),T.adtsStream.pipe(T.audioSegmentStream).pipe(T.coalesceStream)),p.trigger("trackinfo",{hasAudio:!!y,hasVideo:!!g})}}),T.coalesceStream.on("data",this.trigger.bind(this,"data")),T.coalesceStream.on("id3Frame",function(C){C.dispatchType=T.metadataStream.dispatchType,p.trigger("id3Frame",C)}),T.coalesceStream.on("caption",this.trigger.bind(this,"caption")),T.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(T){var C=this.transmuxPipeline_;h.keepOriginalTimestamps||(this.baseMediaDecodeTime=T),y&&(y.timelineStartInfo.dts=void 0,y.timelineStartInfo.pts=void 0,nt.clearDtsInfo(y),h.keepOriginalTimestamps||(y.timelineStartInfo.baseMediaDecodeTime=T),C.audioTimestampRolloverStream&&C.audioTimestampRolloverStream.discontinuity()),g&&(C.videoSegmentStream&&(C.videoSegmentStream.gopCache_=[]),g.timelineStartInfo.dts=void 0,g.timelineStartInfo.pts=void 0,nt.clearDtsInfo(g),C.captionStream.reset(),h.keepOriginalTimestamps||(g.timelineStartInfo.baseMediaDecodeTime=T)),C.timestampRolloverStream&&C.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(T){y&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(T)},this.setRemux=function(T){var C=this.transmuxPipeline_;h.remux=T,C&&C.coalesceStream&&C.coalesceStream.setRemux(T)},this.alignGopsWith=function(T){g&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(T)},this.push=function(T){if(v){var C=k0(T);C&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!C&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),v=!1}this.transmuxPipeline_.headOfPipeline.push(T)},this.flush=function(){v=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Rn.prototype=new n;var P0={Transmuxer:Rn,VideoSegmentStream:Ei,AudioSegmentStream:Br,AUDIO_PROPERTIES:Ks,VIDEO_PROPERTIES:Xs,generateVideoSegmentTimingInfo:ff},I0=function(h,p){if(!(h instanceof p))throw new TypeError("Cannot call a class as a function")},D0=function(){function x(h,p){for(var v=0;v<p.length;v++){var g=p[v];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(h,g.key,g)}}return function(h,p,v){return p&&x(h.prototype,p),v&&x(h,v),h}}(),w0=function(h,p){p.on("data",function(v){var g=v.initSegment;v.initSegment={data:g.buffer,byteOffset:g.byteOffset,byteLength:g.byteLength};var y=v.data;v.data=y.buffer,h.postMessage({action:"data",segment:v,byteOffset:y.byteOffset,byteLength:y.byteLength},[v.data])}),p.captionStream&&p.captionStream.on("data",function(v){h.postMessage({action:"caption",data:v})}),p.on("done",function(v){h.postMessage({action:"done"})}),p.on("gopInfo",function(v){h.postMessage({action:"gopInfo",gopInfo:v})}),p.on("videoSegmentTimingInfo",function(v){h.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:v})})},hf=function(){function x(h,p){I0(this,x),this.options=p||{},this.self=h,this.init()}return D0(x,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new P0.Transmuxer(this.options),w0(this.self,this.transmuxer)}},{key:"push",value:function(p){var v=new Uint8Array(p.data,p.byteOffset,p.byteLength);this.transmuxer.push(v)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(p){var v=p.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(v*9e4))}},{key:"setAudioAppendStart",value:function(p){this.transmuxer.setAudioAppendStart(Math.ceil(p.appendStart*9e4))}},{key:"flush",value:function(p){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(p){this.transmuxer.alignGopsWith(p.gopsToAlignWith.slice())}}]),x}(),O0=function(h){h.onmessage=function(p){if(p.data.action==="init"&&p.data.options){this.messageHandlers=new hf(h,p.data.options);return}this.messageHandlers||(this.messageHandlers=new hf(h)),p.data&&p.data.action&&p.data.action!=="init"&&this.messageHandlers[p.data.action]&&this.messageHandlers[p.data.action](p.data)}},L0=new O0(i);return L0}()}),Sc={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},Ec=function(r){return r.map(function(i){return i.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,n){var s=("00"+Number(t).toString(16)).slice(-2),o=("00"+Number(n).toString(16)).slice(-2);return"avc1."+s+"00"+o})})},gi=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i={codecCount:0},e=void 0;return i.codecCount=r.split(",").length,i.codecCount=i.codecCount||2,e=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(r),e&&(i.videoCodec=e[2],i.videoObjectTypeIndicator=e[3]),i.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(r),i.audioProfile=i.audioProfile&&i.audioProfile[2],i},bv=function(r){return r.replace(/avc1\.(\d+)\.(\d+)/i,function(i){return Ec([i])[0]})},ks=function(r,i,e){return r+"/"+i+'; codecs="'+e.filter(function(t){return!!t}).join(", ")+'"'},xv=function(r){return r.segments&&r.segments.length&&r.segments[0].map?"mp4":"mp2t"},Sv=function(r){var i=r.attributes||{};return i.CODECS?gi(i.CODECS):Sc},Ev=function(r,i){if(!r.mediaGroups.AUDIO||!i)return null;var e=r.mediaGroups.AUDIO[i];if(!e)return null;for(var t in e){var n=e[t];if(n.default&&n.playlists)return gi(n.playlists[0].attributes.CODECS).audioProfile}return null},Cv=function(r,i){var e=xv(i),t=Sv(i),n=i.attributes||{},s=!0,o=!1;if(!i)return[];if(r.mediaGroups.AUDIO&&n.AUDIO){var u=r.mediaGroups.AUDIO[n.AUDIO];if(u){o=!0,s=!1;for(var l in u)if(!u[l].uri&&!u[l].playlists){s=!0;break}}}o&&!t.audioProfile&&(s||(t.audioProfile=Ev(r,n.AUDIO)),t.audioProfile||(k.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),t.audioProfile=Sc.audioProfile));var c={};t.videoCodec&&(c.video=""+t.videoCodec+t.videoObjectTypeIndicator),t.audioProfile&&(c.audio="mp4a.40."+t.audioProfile);var f=ks("audio",e,[c.audio]),d=ks("video",e,[c.video]),m=ks("video",e,[c.video,c.audio]);return o?!s&&c.video?[d,f]:!s&&!c.video?[f,f]:[m,f]:c.video?[m]:[f]},Cc=function(r){var i={type:"",parameters:{}},e=r.trim().split(";");return i.type=e.shift().trim(),e.forEach(function(t){var n=t.trim().split("=");if(n.length>1){var s=n[0].replace(/"/g,"").trim(),o=n[1].replace(/"/g,"").trim();i.parameters[s]=o}}),i},As=function(r){return/mp4a\.\d+.\d+/i.test(r)},Ps=function(r){return/avc1\.[\da-f]+/i.test(r)},kv=function(r,i,e){if(typeof i>"u"||i===null||!r.length)return[];var t=Math.ceil((i-e+3)*9e4),n=void 0;for(n=0;n<r.length&&!(r[n].pts>t);n++);return r.slice(n)},Av=function(r,i,e){if(!i.length)return r;if(e)return i.slice();var t=i[0].pts,n=0;for(n;n<r.length&&!(r[n].pts>=t);n++);return r.slice(0,n).concat(i)},Pv=function(r,i,e,t){for(var n=Math.ceil((i-t)*9e4),s=Math.ceil((e-t)*9e4),o=r.slice(),u=r.length;u--&&!(r[u].pts<=s););if(u===-1)return o;for(var l=u+1;l--&&!(r[l].pts<=n););return l=Math.max(l,0),o.splice(l,u-l+1),o},Iv=function(r,i,e){var t=null,n=null,s=0,o=[],u=[];if(!r&&!i)return k.createTimeRange();if(!r)return i.buffered;if(!i||e)return r.buffered;if(r.buffered.length===0&&i.buffered.length===0)return k.createTimeRange();for(var l=r.buffered,c=i.buffered,f=l.length;f--;)o.push({time:l.start(f),type:"start"}),o.push({time:l.end(f),type:"end"});for(f=c.length;f--;)o.push({time:c.start(f),type:"start"}),o.push({time:c.end(f),type:"end"});for(o.sort(function(d,m){return d.time-m.time}),f=0;f<o.length;f++)o[f].type==="start"?(s++,s===2&&(t=o[f].time)):o[f].type==="end"&&(s--,s===1&&(n=o[f].time)),t!==null&&n!==null&&(u.push([t,n]),t=null,n=null);return k.createTimeRanges(u)},Nr=9e4,Dv=function(r,i){var e=r.addSourceBuffer(i),t=Object.create(null);t.updating=!1,t.realBuffer_=e;var n=function(u){typeof e[u]=="function"?t[u]=function(){return e[u].apply(e,arguments)}:typeof t[u]>"u"&&Object.defineProperty(t,u,{get:function(){return e[u]},set:function(c){return e[u]=c}})};for(var s in e)n(s);return t},wv=function(a){xt(r,a);function r(i,e){Ze(this,r);var t=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,k.EventTarget));t.timestampOffset_=0,t.pendingBuffers_=[],t.bufferUpdating_=!1,t.mediaSource_=i,t.codecs_=e,t.audioCodec_=null,t.videoCodec_=null,t.audioDisabled_=!1,t.appendAudioInitSegment_=!0,t.gopBuffer_=[],t.timeMapping_=0,t.safeAppend_=k.browser.IE_VERSION>=11;var n={remux:!1,alignGopsAtEnd:t.safeAppend_};return t.codecs_.forEach(function(s){As(s)?t.audioCodec_=s:Ps(s)&&(t.videoCodec_=s)}),t.transmuxer_=new Tv,t.transmuxer_.postMessage({action:"init",options:n}),t.transmuxer_.onmessage=function(s){if(s.data.action==="data")return t.data_(s);if(s.data.action==="done")return t.done_(s);if(s.data.action==="gopInfo")return t.appendGopInfo_(s);if(s.data.action==="videoSegmentTimingInfo")return t.videoSegmentTimingInfo_(s.data.videoSegmentTimingInfo)},Object.defineProperty(t,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(o){typeof o=="number"&&o>=0&&(this.timestampOffset_=o,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:o}))}}),Object.defineProperty(t,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(o){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=o),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=o)}}),Object.defineProperty(t,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(t,"buffered",{get:function(){return Iv(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),t}return it(r,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),pv(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){if(this.mediaSource_.readyState==="closed"){this.pendingBuffers_.length=0;return}this.processPendingSegments_()}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/Nr,presentation:e.start.pts/Nr},end:{decode:e.end.dts/Nr,presentation:e.end.pts/Nr},baseMediaDecodeTime:e.baseMediaDecodeTime/Nr};e.prependedContentDuration&&(t.prependedContentDuration=e.prependedContentDuration/Nr),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach(function(n){if(e[n+"Codec_"]&&!e[n+"Buffer_"]){var s=null;if(e.mediaSource_[n+"Buffer_"])s=e.mediaSource_[n+"Buffer_"],s.updating=!1;else{var o=n+"Codec_",u=n+'/mp4;codecs="'+e[o]+'"';s=Dv(e.mediaSource_.nativeMediaSource_,u),e.mediaSource_[n+"Buffer_"]=s}e[n+"Buffer_"]=s,["update","updatestart","updateend"].forEach(function(l){s.addEventListener(l,function(){if(!(n==="audio"&&e.audioDisabled_)){l==="updateend"&&(e[n+"Buffer_"].updating=!1);var c=t.every(function(f){return f==="audio"&&e.audioDisabled_?!0:!(n!==f&&e[f+"Buffer_"]&&e[f+"Buffer_"].updating)});if(c)return e.trigger(l)}})})}})}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:kv(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=Av(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=Pv(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),Or(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)Or(e,t,this.inbandTextTracks_[n])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};if(!this.pendingBuffers_.length){this.trigger("updateend"),this.bufferUpdating_=!1;return}e=this.pendingBuffers_.reduce(function(n,s){var o=s.type,u=s.data,l=s.initSegment;return n[o].segments.push(u),n[o].bytes+=u.byteLength,n[o].initSegment=l,s.captions&&(n.captions=n.captions.concat(s.captions)),s.info&&(n[o].info=s.info),s.metadata&&(n.metadata=n.metadata.concat(s.metadata)),n},e),!this.videoBuffer_&&!this.audioBuffer_&&(e.video.bytes===0&&(this.videoCodec_=null),e.audio.bytes===0&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_)):this.videoBuffer_&&(this.audioDisabled_||!this.audioBuffer_)&&(t=!0),vv(this,e.captions,e.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var n=0,s=void 0;if(e.bytes){s=new Uint8Array(e.bytes),e.segments.forEach(function(o){s.set(o,n),n+=o.byteLength});try{t.updating=!0,t.appendBuffer(s)}catch(o){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:o.message,originalError:o})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}},{key:"dispose",value:function(){this.transmuxer_&&this.transmuxer_.terminate(),this.trigger("dispose"),this.off()}}]),r}(k.EventTarget),Is=function(a){xt(r,a);function r(){Ze(this,r);var i=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),e=void 0;i.nativeMediaSource_=new S.MediaSource;for(e in i.nativeMediaSource_)!(e in r.prototype)&&typeof i.nativeMediaSource_[e]=="function"&&(i[e]=i.nativeMediaSource_[e].bind(i.nativeMediaSource_));return i.duration_=NaN,Object.defineProperty(i,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(n){if(this.duration_=n,n!==1/0){this.nativeMediaSource_.duration=n;return}}}),Object.defineProperty(i,"seekable",{get:function(){return this.duration_===1/0?k.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(i,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(i,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),i.sourceBuffers=[],i.activeSourceBuffers_=[],i.updateActiveSourceBuffers_=function(){if(i.activeSourceBuffers_.length=0,i.sourceBuffers.length===1){var t=i.sourceBuffers[0];t.appendAudioInitSegment_=!0,t.audioDisabled_=!t.audioCodec_,i.activeSourceBuffers_.push(t);return}for(var n=!1,s=!0,o=0;o<i.player_.audioTracks().length;o++){var u=i.player_.audioTracks()[o];if(u.enabled&&u.kind!=="main"){n=!0,s=!1;break}}i.sourceBuffers.forEach(function(l,c){if(l.appendAudioInitSegment_=!0,l.videoCodec_&&l.audioCodec_)l.audioDisabled_=n;else if(l.videoCodec_&&!l.audioCodec_)l.audioDisabled_=!0,s=!1;else if(!l.videoCodec_&&l.audioCodec_&&(l.audioDisabled_=c?s:!s,l.audioDisabled_))return;i.activeSourceBuffers_.push(l)})},i.onPlayerMediachange_=function(){i.sourceBuffers.forEach(function(t){t.appendAudioInitSegment_=!0})},i.onHlsReset_=function(){i.sourceBuffers.forEach(function(t){t.transmuxer_&&t.transmuxer_.postMessage({action:"resetCaptions"})})},i.onHlsSegmentTimeMapping_=function(t){i.sourceBuffers.forEach(function(n){return n.timeMapping_=t.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(t){this.nativeMediaSource_.addEventListener(t,this.trigger.bind(this))},i),i.on("sourceopen",function(t){var n=N.querySelector('[src="'+i.url_+'"]');n&&(i.player_=k(n.parentNode),i.player_&&(i.player_.tech_.on("hls-reset",i.onHlsReset_),i.player_.tech_.on("hls-segment-time-mapping",i.onHlsSegmentTimeMapping_),i.player_.audioTracks&&i.player_.audioTracks()&&(i.player_.audioTracks().on("change",i.updateActiveSourceBuffers_),i.player_.audioTracks().on("addtrack",i.updateActiveSourceBuffers_),i.player_.audioTracks().on("removetrack",i.updateActiveSourceBuffers_)),i.player_.on("mediachange",i.onPlayerMediachange_)))}),i.on("sourceended",function(t){for(var n=_c(i.duration),s=0;s<i.sourceBuffers.length;s++){var o=i.sourceBuffers[s],u=o.metadataTrack_&&o.metadataTrack_.cues;u&&u.length&&(u[u.length-1].endTime=n)}}),i.on("sourceclose",function(t){this.sourceBuffers.forEach(function(n){n.transmuxer_&&n.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))}),i}return it(r,[{key:"addSeekableRange_",value:function(e,t){var n=void 0;if(this.duration!==1/0)throw n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity"),n.name="InvalidStateError",n.code=11,n;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,n=Cc(e);if(/^(video|audio)\/mp2t$/i.test(n.type)){var s=[];n.parameters&&n.parameters.codecs&&(s=n.parameters.codecs.split(","),s=Ec(s),s=s.filter(function(o){return As(o)||Ps(o)})),s.length===0&&(s=["avc1.4d400d","mp4a.40.2"]),t=new wv(this,s),this.sourceBuffers.length!==0&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}},{key:"dispose",value:function(){this.trigger("dispose"),this.off(),this.sourceBuffers.forEach(function(e){e.dispose&&e.dispose()}),this.sourceBuffers.length=0}}]),r}(k.EventTarget),kc=0;k.mediaSources={};var Ac=function(r,i){var e=k.mediaSources[r];if(e)e.trigger({type:"sourceopen",swfId:i});else throw new Error("Media Source not found (Video.js)")},Ds=function(){return!!S.MediaSource&&!!S.MediaSource.isTypeSupported&&S.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},_i=function(){if(this.MediaSource={open:Ac,supportsNativeMediaSources:Ds},Ds())return new Is;throw new Error("Cannot use create a virtual MediaSource for this video")};_i.open=Ac,_i.supportsNativeMediaSources=Ds;var Pc={createObjectURL:function(r){var i="blob:vjs-media-source/",e=void 0;return r instanceof Is?(e=S.URL.createObjectURL(r.nativeMediaSource_),r.url_=e,e):r instanceof Is?(e=i+kc,kc++,k.mediaSources[e]=r,e):(e=S.URL.createObjectURL(r),r.url_=e,e)}};k.MediaSource=_i,k.URL=Pc;var Ov=k.EventTarget,Ic=k.mergeOptions,Dc=function(r,i){for(var e=void 0,t=Ic(r,{duration:i.duration,minimumUpdatePeriod:i.minimumUpdatePeriod}),n=0;n<i.playlists.length;n++){var s=ys(t,i.playlists[n]);s?t=s:e=!0}return dn(i,function(o,u,l,c){if(o.playlists&&o.playlists.length){var f=o.playlists[0].id,d=ys(t,o.playlists[0]);d&&(t=d,t.mediaGroups[u][l][c].playlists[0]=t.playlists[f],e=!1)}}),e?null:t},ws=function(r){var i=r.byterange.offset+r.byterange.length-1;return r.uri+"-"+r.byterange.offset+"-"+i},Lv=function(r,i){var e=!r.map&&!i.map,t=e||!!(r.map&&i.map&&r.map.byterange.offset===i.map.byterange.offset&&r.map.byterange.length===i.map.byterange.length);return t&&r.uri===i.uri&&r.byterange.offset===i.byterange.offset&&r.byterange.length===i.byterange.length},wc=function(r,i){var e={};for(var t in r){var n=r[t],s=n.sidx;if(s){var o=ws(s);if(!i[o])break;var u=i[o].sidxInfo;Lv(u,s)&&(e[o]=i[o])}}return e},Rv=function(r,i,e,t){var n=Ol(r,{manifestUri:i,clientOffset:e}),s=wc(n.playlists,t),o=s;return dn(n,function(u,l,c,f){if(u.playlists&&u.playlists.length){var d=u.playlists;o=Ic(o,wc(d,t))}}),o},Oc=function(r,i,e,t,n){var s={uri:hn(t.handleManifestRedirects,r.resolvedUri),byterange:r.byterange,playlist:i},o=k.mergeOptions(s,{responseType:"arraybuffer",headers:Ss(s)});return e(o,n)},Os=function(a){xt(r,a);function r(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments[3];Ze(this,r);var s=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),o=t.withCredentials,u=o===void 0?!1:o,l=t.handleManifestRedirects,c=l===void 0?!1:l;if(s.hls_=e,s.withCredentials=u,s.handleManifestRedirects=c,!i)throw new Error("A non-empty playlist URL or playlist is required");return s.on("minimumUpdatePeriod",function(){s.refreshXml_()}),s.on("mediaupdatetimeout",function(){s.refreshMedia_(s.media().id)}),s.state="HAVE_NOTHING",s.loadedPlaylists_={},typeof i=="string"?(s.srcUrl=i,s.sidxMapping_={},lt(s)):(s.setupChildLoader(n,i),s)}return it(r,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t}},{key:"dispose",value:function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},S.clearTimeout(this.minimumUpdatePeriodTimeout_),S.clearTimeout(this.mediaRequest_),S.clearTimeout(this.mediaUpdateTimeout),this.off()}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"sidxRequestFinished_",value:function(e,t,n,s){var o=this;return function(u,l){if(o.request){if(o.request=null,u)return o.error={status:l.status,message:"DASH playlist request error at URL: "+e.uri,response:l.response,code:2},n&&(o.state=n),o.trigger("error"),s(t,null);var c=new Uint8Array(l.response),f=se.parseSidx(c.subarray(8));return s(t,f)}}}},{key:"media",value:function(e){var t=this;if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);var n=this.state;if(typeof e=="string"){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}var s=!this.media_||e.id!==this.media_.id;if(s&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,s&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}if(s){if(this.media_&&this.trigger("mediachanging"),!e.sidx){this.mediaRequest_=S.setTimeout(this.haveMetadata.bind(this,{startingState:n,playlist:e}),0);return}var o=void 0,u=void 0;this.masterPlaylistLoader_?(o=this.masterPlaylistLoader_.master,u=this.masterPlaylistLoader_.sidxMapping_):(o=this.master,u=this.sidxMapping_);var l=ws(e.sidx);u[l]={sidxInfo:e.sidx},this.request=Oc(e.sidx,e,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(e,o,n,function(c,f){if(!c||!f)throw new Error("failed to request sidx");u[l].sidx=f,t.haveMetadata({startingState:n,playlist:c.playlists[e.id]})}))}}},{key:"haveMetadata",value:function(e){var t=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.id]=n,this.mediaRequest_=null,this.refreshMedia_(n.id),t==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function(){this.stopRequest(),S.clearTimeout(this.mediaUpdateTimeout),S.clearTimeout(this.minimumUpdatePeriodTimeout_),this.state==="HAVE_NOTHING"&&(this.started=!1)}},{key:"load",value:function(e){var t=this;S.clearTimeout(this.mediaUpdateTimeout),S.clearTimeout(this.minimumUpdatePeriodTimeout_);var n=this.media();if(e){var s=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=S.setTimeout(function(){return t.load()},s);return}if(!this.started){this.start();return}n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}},{key:"parseMasterXml",value:function(){var e=Ol(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});e.uri=this.srcUrl;for(var t=0;t<e.playlists.length;t++){var n="placeholder-uri-"+t;e.playlists[t].uri=n}return dn(e,function(s,o,u,l){if(s.playlists&&s.playlists.length){var c="placeholder-uri-"+o+"-"+u+"-"+l,f=Ts(0,c);s.playlists[0].uri=c,s.playlists[0].id=f,e.playlists[f]=s.playlists[0],e.playlists[c]=s.playlists[0]}}),Ql(e),Jl(e),e}},{key:"start",value:function(){var e=this;if(this.started=!0,this.masterPlaylistLoader_){this.mediaRequest_=S.setTimeout(this.haveMaster_.bind(this),0);return}this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:n.responseText,code:2},e.state==="HAVE_NOTHING"&&(e.started=!1),e.trigger("error");e.masterXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?e.masterLoaded_=Date.parse(n.responseHeaders.date):e.masterLoaded_=Date.now(),e.srcUrl=hn(e.handleManifestRedirects,e.srcUrl,n),e.syncClientServerClock_(e.onClientServerClockSync_.bind(e))}})}},{key:"syncClientServerClock_",value:function(e){var t=this,n=Dp(this.masterXml_);if(n===null)return this.clientOffset_=this.masterLoaded_-Date.now(),e();if(n.method==="DIRECT")return this.clientOffset_=n.value-Date.now(),e();this.request=this.hls_.xhr({uri:Xt(this.srcUrl,n.value),method:n.method,withCredentials:this.withCredentials},function(s,o){if(t.request){if(s)return t.clientOffset_=t.masterLoaded_-Date.now(),e();var u=void 0;n.method==="HEAD"?!o.responseHeaders||!o.responseHeaders.date?u=t.masterLoaded_:u=Date.parse(o.responseHeaders.date):u=Date.parse(o.responseText),t.clientOffset_=u-Date.now(),e()}})}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var e=this;this.haveMaster_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=S.setTimeout(function(){e.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var e=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:n.responseText,code:2},e.state==="HAVE_NOTHING"&&(e.started=!1),e.trigger("error");e.masterXml_=n.responseText,e.sidxMapping_=Rv(e.masterXml_,e.srcUrl,e.clientOffset_,e.sidxMapping_);var s=e.parseMasterXml(),o=Dc(e.master,s),u=e.media().sidx;if(o)if(u){var l=ws(u);if(!e.sidxMapping_[l]){var c=e.media();e.request=Oc(c.sidx,c,e.hls_.xhr,{handleManifestRedirects:e.handleManifestRedirects},e.sidxRequestFinished_(c,s,e.state,function(f,d){if(!f||!d)throw new Error("failed to request sidx on minimumUpdatePeriod");e.sidxMapping_[l].sidx=d,e.minimumUpdatePeriodTimeout_=S.setTimeout(function(){e.trigger("minimumUpdatePeriod")},e.master.minimumUpdatePeriod),e.refreshMedia_(e.media().id)}))}}else e.master=o;e.minimumUpdatePeriodTimeout_=S.setTimeout(function(){e.trigger("minimumUpdatePeriod")},e.master.minimumUpdatePeriod)}})}},{key:"refreshMedia_",value:function(e){var t=this;if(!e)throw new Error("refreshMedia_ must take a media id");var n=void 0,s=void 0;this.masterPlaylistLoader_?(n=this.masterPlaylistLoader_.master,s=this.masterPlaylistLoader_.parseMasterXml()):(n=this.master,s=this.parseMasterXml());var o=Dc(n,s);o?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=o:this.master=o,this.media_=o.playlists[e]):(this.media_=s.playlists[e],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=S.setTimeout(function(){t.trigger("mediaupdatetimeout")},Zl(this.media(),!!o))),this.trigger("loadedplaylist")}}]),r}(Ov),yi=function(r){return k.log.debug?k.log.debug.bind(k,"VHS:",r+" >"):function(){}};function Mr(){}var Nv=function(){function a(r,i,e,t){Ze(this,a),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=r,this.processedAppend_=!1,this.type_=e,this.mimeType_=i,this.logger_=yi("SourceUpdater["+e+"]["+i+"]"),r.readyState==="closed"?r.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,i,t)):this.createSourceBuffer_(i,t)}return it(a,[{key:"createSourceBuffer_",value:function(i,e){var t=this;if(this.sourceBuffer_=this.mediaSource.addSourceBuffer(i),this.logger_("created SourceBuffer"),e&&(e.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)){e.on("sourcebufferadded",function(){t.start_()});return}this.start_()}},{key:"start_",value:function(){var i=this;this.started_=!0,this.onUpdateendCallback_=function(){var e=i.pendingCallback_;i.pendingCallback_=null,i.sourceBuffer_.removing=!1,i.logger_("buffered ["+Es(i.buffered())+"]"),e&&e(),i.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(i){var e=this;this.processedAppend_&&this.queueCallback_(function(){e.sourceBuffer_.abort()},i)}},{key:"appendBuffer",value:function(i,e){var t=this;this.processedAppend_=!0,this.queueCallback_(function(){i.videoSegmentTimingInfoCallback&&t.sourceBuffer_.addEventListener("videoSegmentTimingInfo",i.videoSegmentTimingInfoCallback),t.sourceBuffer_.appendBuffer(i.bytes)},function(){i.videoSegmentTimingInfoCallback&&t.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",i.videoSegmentTimingInfoCallback),e()})}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:k.createTimeRanges()}},{key:"remove",value:function(i,e){var t=this,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mr;this.processedAppend_&&this.queueCallback_(function(){t.logger_("remove ["+i+" => "+e+"]"),t.sourceBuffer_.removing=!0,t.sourceBuffer_.remove(i,e)},n)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==Mr}},{key:"timestampOffset",value:function(i){var e=this;return typeof i<"u"&&(this.queueCallback_(function(){e.sourceBuffer_.timestampOffset=i,e.runCallback_()}),this.timestampOffset_=i),this.timestampOffset_}},{key:"queueCallback_",value:function(i,e){this.callbacks_.push([i.bind(this),e]),this.runCallback_()}},{key:"runCallback_",value:function(){var i=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(i=this.callbacks_.shift(),this.pendingCallback_=i[1],i[0]())}},{key:"dispose",value:function(){var i=this,e=function t(){i.sourceBuffer_&&i.mediaSource.readyState==="open"&&i.sourceBuffer_.abort(),i.sourceBuffer_.removeEventListener("updateend",t)};this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",e):e()}}]),a}(),qe={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Lt={FAILURE:2,TIMEOUT:-101,ABORTED:-102},Lc=function(r){r.forEach(function(i){i.abort()})},Mv=function(r){return{bandwidth:r.bandwidth,bytesReceived:r.bytesReceived||0,roundTripTime:r.roundTripTime||0}},Uv=function(r){var i=r.target,e=Date.now()-i.requestTime,t={bandwidth:1/0,bytesReceived:0,roundTripTime:e||0};return t.bytesReceived=r.loaded,t.bandwidth=Math.floor(t.bytesReceived/t.roundTripTime*8*1e3),t},Ls=function(r,i){return i.timedout?{status:i.status,message:"HLS request timed-out at URL: "+i.uri,code:Lt.TIMEOUT,xhr:i}:i.aborted?{status:i.status,message:"HLS request aborted at URL: "+i.uri,code:Lt.ABORTED,xhr:i}:r?{status:i.status,message:"HLS request errored at URL: "+i.uri,code:Lt.FAILURE,xhr:i}:null},Fv=function(r,i){return function(e,t){var n=t.response,s=Ls(e,t);if(s)return i(s,r);if(n.byteLength!==16)return i({status:t.status,message:"Invalid HLS key at URL: "+t.uri,code:Lt.FAILURE,xhr:t},r);var o=new DataView(n);return r.key.bytes=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]),i(null,r)}},Bv=function(r,i,e){return function(t,n){var s=n.response,o=Ls(t,n);return o?e(o,r):s.byteLength===0?e({status:n.status,message:"Empty HLS segment content at URL: "+n.uri,code:Lt.FAILURE,xhr:n},r):(r.map.bytes=new Uint8Array(n.response),i&&!i.isInitialized()&&i.init(),r.map.timescales=bt.timescale(r.map.bytes),r.map.videoTrackIds=bt.videoTrackIds(r.map.bytes),e(null,r))}},jv=function(r,i,e){return function(t,n){var s=n.response,o=Ls(t,n),u=void 0;return o?e(o,r):s.byteLength===0?e({status:n.status,message:"Empty HLS segment content at URL: "+n.uri,code:Lt.FAILURE,xhr:n},r):(r.stats=Mv(n),r.key?r.encryptedBytes=new Uint8Array(n.response):r.bytes=new Uint8Array(n.response),i&&r.map&&r.map.bytes&&(i.isInitialized()||i.init(),u=i.parse(r.bytes,r.map.videoTrackIds,r.map.timescales),u&&u.captions&&(r.captionStreams=u.captionStreams,r.fmp4Captions=u.captions)),e(null,r))}},Vv=function(r,i,e){var t=function s(o){if(o.data.source===i.requestId){r.removeEventListener("message",s);var u=o.data.decrypted;return i.bytes=new Uint8Array(u.bytes,u.byteOffset,u.byteLength),e(null,i)}};r.addEventListener("message",t);var n=void 0;i.key.bytes.slice?n=i.key.bytes.slice():n=new Uint32Array(Array.prototype.slice.call(i.key.bytes)),r.postMessage(cc({source:i.requestId,encrypted:i.encryptedBytes,key:n,iv:i.key.iv}),[i.encryptedBytes.buffer,n.buffer])},Hv=function(r,i,e){var t=0,n=!1;return function(s,o){if(!n){if(s)return n=!0,Lc(r),e(s,o);if(t+=1,t===r.length)return o.endOfAllRequests=Date.now(),o.encryptedBytes?Vv(i,o,e):e(null,o)}}},Wv=function(r,i){return function(e){return r.stats=k.mergeOptions(r.stats,Uv(e)),!r.stats.firstBytesReceivedAt&&r.stats.bytesReceived&&(r.stats.firstBytesReceivedAt=Date.now()),i(e,r)}},Gv=function(r,i,e,t,n,s,o){var u=[],l=Hv(u,e,o);if(n.key&&!n.key.bytes){var c=k.mergeOptions(i,{uri:n.key.resolvedUri,responseType:"arraybuffer"}),f=Fv(n,l),d=r(c,f);u.push(d)}if(n.map&&!n.map.bytes){var m=k.mergeOptions(i,{uri:n.map.resolvedUri,responseType:"arraybuffer",headers:Ss(n.map)}),_=Bv(n,t,l),b=r(m,_);u.push(b)}var A=k.mergeOptions(i,{uri:n.resolvedUri,responseType:"arraybuffer",headers:Ss(n)}),I=jv(n,t,l),D=r(A,I);return D.addEventListener("progress",Wv(n,s)),u.push(D),function(){return Lc(u)}},Rc=function(r,i){var e=void 0;return!r||(e=S.getComputedStyle(r),!e)?"":e[i]},Ti=function(r,i){var e=r.slice();r.sort(function(t,n){var s=i(t,n);return s===0?e.indexOf(t)-e.indexOf(n):s})},Rs=function(r,i){var e=void 0,t=void 0;return r.attributes.BANDWIDTH&&(e=r.attributes.BANDWIDTH),e=e||S.Number.MAX_VALUE,i.attributes.BANDWIDTH&&(t=i.attributes.BANDWIDTH),t=t||S.Number.MAX_VALUE,e-t},qv=function(r,i){var e=void 0,t=void 0;return r.attributes.RESOLUTION&&r.attributes.RESOLUTION.width&&(e=r.attributes.RESOLUTION.width),e=e||S.Number.MAX_VALUE,i.attributes.RESOLUTION&&i.attributes.RESOLUTION.width&&(t=i.attributes.RESOLUTION.width),t=t||S.Number.MAX_VALUE,e===t&&r.attributes.BANDWIDTH&&i.attributes.BANDWIDTH?r.attributes.BANDWIDTH-i.attributes.BANDWIDTH:e-t},zv=function(r,i,e,t,n){var s=r.playlists.map(function(O){var M=void 0,U=void 0,R=void 0;return M=O.attributes.RESOLUTION&&O.attributes.RESOLUTION.width,U=O.attributes.RESOLUTION&&O.attributes.RESOLUTION.height,R=O.attributes.BANDWIDTH,R=R||S.Number.MAX_VALUE,{bandwidth:R,width:M,height:U,playlist:O}});Ti(s,function(O,M){return O.bandwidth-M.bandwidth}),s=s.filter(function(O){return!Be.isIncompatible(O.playlist)});var o=s.filter(function(O){return Be.isEnabled(O.playlist)});o.length||(o=s.filter(function(O){return!Be.isDisabled(O.playlist)}));var u=o.filter(function(O){return O.bandwidth*qe.BANDWIDTH_VARIANCE<i}),l=u[u.length-1],c=u.filter(function(O){return O.bandwidth===l.bandwidth})[0];if(n===!1){var f=c||o[0]||s[0];return f?f.playlist:null}var d=u.filter(function(O){return O.width&&O.height});Ti(d,function(O,M){return O.width-M.width});var m=d.filter(function(O){return O.width===e&&O.height===t});l=m[m.length-1];var _=m.filter(function(O){return O.bandwidth===l.bandwidth})[0],b=void 0,A=void 0,I=void 0;_||(b=d.filter(function(O){return O.width>e||O.height>t}),A=b.filter(function(O){return O.width===b[0].width&&O.height===b[0].height}),l=A[A.length-1],I=A.filter(function(O){return O.bandwidth===l.bandwidth})[0]);var D=I||_||c||o[0]||s[0];return D?D.playlist:null},Kv=function(){var r=this.useDevicePixelRatio&&S.devicePixelRatio||1;return zv(this.playlists.master,this.systemBandwidth,parseInt(Rc(this.tech_.el(),"width"),10)*r,parseInt(Rc(this.tech_.el(),"height"),10)*r,this.limitRenditionByPlayerDimensions)},Xv=function(r){var i=r.master,e=r.currentTime,t=r.bandwidth,n=r.duration,s=r.segmentDuration,o=r.timeUntilRebuffer,u=r.currentTimeline,l=r.syncController,c=i.playlists.filter(function(b){return!Be.isIncompatible(b)}),f=c.filter(Be.isEnabled);f.length||(f=c.filter(function(b){return!Be.isDisabled(b)}));var d=f.filter(Be.hasAttribute.bind(null,"BANDWIDTH")),m=d.map(function(b){var A=l.getSyncPoint(b,n,u,e),I=A?1:2,D=Be.estimateSegmentRequestTime(s,t,b),O=D*I-o;return{playlist:b,rebufferingImpact:O}}),_=m.filter(function(b){return b.rebufferingImpact<=0});return Ti(_,function(b,A){return Rs(A.playlist,b.playlist)}),_.length?_[0]:(Ti(m,function(b,A){return b.rebufferingImpact-A.rebufferingImpact}),m[0]||null)},$v=function(){var r=this.playlists.master.playlists.filter(Be.isEnabled);Ti(r,function(e,t){return Rs(e,t)});var i=r.filter(function(e){return gi(e.attributes.CODECS).videoCodec});return i[0]||null},Yv=function(r,i,e){for(var t in e)if(!r[t]){i.trigger({type:"usage",name:"hls-608"});var n=i.textTracks().getTrackById(t);n?r[t]=n:r[t]=i.addRemoteTextTrack({kind:"captions",id:t,label:t},!1).track}},Qv=function(r){var i=r.inbandTextTracks,e=r.captionArray,t=r.timestampOffset;if(e){var n=window.WebKitDataCue||window.VTTCue;e.forEach(function(s){var o=s.stream,u=s.startTime,l=s.endTime;i[o]&&(u+=t,l+=t,i[o].addCue(new n(u,l,s.text)))})}},Jv=500,Zv=function(r,i,e){if(!r||!i)return!1;var t=r.segments,n=e===t.length;return r.endList&&i.readyState==="open"&&n},Nc=function(r){return typeof r=="number"&&isFinite(r)},eg=function(r,i,e){return r!=="main"||!i||!e?null:!e.containsAudio&&!e.containsVideo?"Neither audio nor video found in segment.":i.containsVideo&&!e.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!i.containsVideo&&e.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null},tg=function(r,i,e){var t=i-30;r.length&&(t=Math.max(t,r.start(0)));var n=i-e;return Math.min(n,t)},rg=function(r){var i=r.segment,e=i.start,t=i.end,n=r.playlist,s=n.mediaSequence,o=n.id,u=n.segments,l=u===void 0?[]:u,c=r.mediaIndex,f=r.timeline;return["appending ["+c+"] of ["+s+", "+(s+l.length)+"] from playlist ["+o+"]","["+e+" => "+t+"] in timeline ["+f+"]"].join(" ")},Ns=function(a){xt(r,a);function r(i){Ze(this,r);var e=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));if(!i)throw new TypeError("Initialization settings are required");if(typeof i.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!i.mediaSource)throw new TypeError("No MediaSource specified");return e.bandwidth=i.bandwidth,e.throughput={rate:0,count:0},e.roundTrip=NaN,e.resetStats_(),e.mediaIndex=null,e.hasPlayed_=i.hasPlayed,e.currentTime_=i.currentTime,e.seekable_=i.seekable,e.seeking_=i.seeking,e.duration_=i.duration,e.mediaSource_=i.mediaSource,e.hls_=i.hls,e.loaderType_=i.loaderType,e.startingMedia_=void 0,e.segmentMetadataTrack_=i.segmentMetadataTrack,e.goalBufferLength_=i.goalBufferLength,e.sourceType_=i.sourceType,e.inbandTextTracks_=i.inbandTextTracks,e.state_="INIT",e.checkBufferTimeout_=null,e.error_=void 0,e.currentTimeline_=-1,e.pendingSegment_=null,e.mimeType_=null,e.sourceUpdater_=null,e.xhrOptions_=null,e.activeInitSegmentId_=null,e.initSegments_={},e.cacheEncryptionKeys_=i.cacheEncryptionKeys,e.keyCache_={},e.loaderType_==="main"?e.captionParser_=new Qp:e.captionParser_=null,e.decrypter_=i.decrypter,e.syncController_=i.syncController,e.syncPoint_={segmentIndex:0,time:0},e.triggerSyncInfoUpdate_=function(){return e.trigger("syncinfoupdate")},e.syncController_.on("syncinfoupdate",e.triggerSyncInfoUpdate_),e.mediaSource_.addEventListener("sourceopen",function(){return e.ended_=!1}),e.fetchAtBuffer_=!1,e.logger_=yi("SegmentLoader["+e.loaderType_+"]"),Object.defineProperty(e,"state",{get:function(){return this.state_},set:function(n){n!==this.state_&&(this.logger_(this.state_+" -> "+n),this.state_=n)}}),e}return it(r,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset(),this.checkBufferTimeout_&&S.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}},{key:"abort",value:function(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return typeof e<"u"&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():k.createTimeRanges()}},{key:"initSegment",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e)return null;var n=vn(e),s=this.initSegments_[n];return t&&!s&&e.bytes&&(this.initSegments_[n]=s={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}),s||e}},{key:"segmentKey",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e)return null;var n=fc(e),s=this.keyCache_[n];this.cacheEncryptionKeys_&&t&&!s&&e.bytes&&(this.keyCache_[n]=s={resolvedUri:e.resolvedUri,bytes:e.bytes});var o={resolvedUri:(s||e).resolvedUri};return s&&(o.bytes=s.bytes),o}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&this.state==="INIT")&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),!!this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new Nv(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e){var n=this.playlist_,s=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var o=null;if(n&&(n.id?o=n.id:n.uri&&(o=n.uri)),this.logger_("playlist update ["+o+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!n||n.uri!==e.uri){this.mediaIndex!==null&&this.resyncLoader();return}var u=e.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+u+"]"),this.mediaIndex!==null&&(this.mediaIndex-=u),s&&(s.mediaIndex-=u,s.mediaIndex>=0&&(s.segment=e.segments[s.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,e)}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(S.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return this.checkBufferTimeout_===null}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(e){this.ended_=!1,this.resetLoader(),this.remove(0,1/0,e),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t,n){if(t===1/0&&(t=this.duration_()),this.sourceUpdater_&&this.sourceUpdater_.remove(e,t,n),Or(e,t,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var s in this.inbandTextTracks_)Or(e,t,this.inbandTextTracks_[s])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&S.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=S.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&S.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=S.setTimeout(this.monitorBufferTick_.bind(this),Jv)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(e){if(this.isEndOfStream_(e.mediaIndex)){this.endOfStream();return}e.mediaIndex===this.playlist_.segments.length-1&&this.mediaSource_.readyState==="ended"&&!this.seeking_()||(e.timeline!==this.currentTimeline_&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(e))}}}},{key:"isEndOfStream_",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.playlist_;return Zv(t,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,n,s,o,u){var l=0,c=void 0;e.length&&(l=e.end(e.length-1));var f=Math.max(0,l-o);if(!t.segments.length||f>=this.goalBufferLength_()||!s&&f>=1)return null;if(u===null)return n=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,n,null,!0);if(n!==null){var d=t.segments[n];return c=l,this.generateSegmentInfo_(t,n+1,c,!1)}if(this.fetchAtBuffer_){var m=Be.getMediaInfoForTime(t,l,u.segmentIndex,u.time);n=m.mediaIndex,c=m.startTime}else{var _=Be.getMediaInfoForTime(t,o,u.segmentIndex,u.time);n=_.mediaIndex,c=_.startTime}return this.generateSegmentInfo_(t,n,c,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(this.currentTimeline_===-1)return 0;var n=e.segments.map(function(s,o){return{timeline:s.timeline,segmentIndex:o}}).filter(function(s){return s.timeline===t.currentTimeline_});return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,n,s){if(t<0||t>=e.segments.length)return null;var o=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:o.resolvedUri,mediaIndex:t,isSyncRequest:s,startOfSegment:n,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:o.timeline,duration:o.duration,segment:o}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),n=e.bandwidth,s=this.pendingSegment_.duration,o=Be.estimateSegmentRequestTime(s,n,this.playlist_,e.bytesReceived),u=dv(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(o<=u)return!1;var l=Xv({master:this.hls_.playlists.master,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:s,timeUntilRebuffer:u,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(l){var c=o-u,f=c-l.rebufferingImpact,d=.5;return u<=gn&&(d=1),!l.playlist||l.playlist.uri===this.playlist_.uri||f<d?!1:(this.bandwidth=l.playlist.attributes.BANDWIDTH*qe.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(e,t){!this.pendingSegment_||t.requestId!==this.pendingSegment_.requestId||this.abortRequestEarly_(t.stats)||this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=Gv(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t=tg(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,n={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var s=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);n.key=this.segmentKey(t.key),n.key.iv=s}return t.map&&(n.map=this.initSegment(t.map)),n}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),!this.pendingSegment_){this.mediaRequestsAborted+=1;return}if(t.requestId===this.pendingSegment_.requestId){if(e){if(this.pendingSegment_=null,this.state="READY",e.code===Lt.ABORTED){this.mediaRequestsAborted+=1;return}if(this.pause(),e.code===Lt.TIMEOUT){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate");return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),t.key&&this.segmentKey(t.key,!0),this.processSegmentResponse_(t)}}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,e.fmp4Captions&&(Yv(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams),Qv({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(!this.pendingSegment_){this.state="READY";return}var t=this.pendingSegment_,n=t.segment,s=this.syncController_.probeSegmentInfo(t);typeof this.startingMedia_>"u"&&s&&(s.containsAudio||s.containsVideo)&&(this.startingMedia_={containsAudio:s.containsAudio,containsVideo:s.containsVideo});var o=eg(this.loaderType_,this.startingMedia_,s);if(o){this.error({message:o,blacklistDuration:1/0}),this.trigger("error");return}if(t.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}if(t.timestampOffset!==null&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()){if(s&&s.segmentTimestampInfo){var u=s.segmentTimestampInfo[0].ptsTime,l=s.segmentTimestampInfo[0].dtsTime;t.timestampOffset-=u-l}this.sourceUpdater_.timestampOffset(t.timestampOffset),this.trigger("timestampoffset")}var c=this.syncController_.mappingForTimeline(t.timeline);if(c!==null&&this.trigger({type:"segmenttimemapping",mapping:c}),this.state="APPENDING",n.map){var f=vn(n.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==f){var d=this.initSegment(n.map);this.sourceUpdater_.appendBuffer({bytes:d.bytes},function(){e.activeInitSegmentId_=f})}}t.byteLength=t.bytes.byteLength,typeof n.start=="number"&&typeof n.end=="number"?this.mediaSecondsLoaded+=n.end-n.start:this.mediaSecondsLoaded+=n.duration,this.logger_(rg(t)),this.sourceUpdater_.appendBuffer({bytes:t.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,t.requestId)},this.handleUpdateEnd_.bind(this))}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(!(!this.pendingSegment_||e!==this.pendingSegment_.requestId)){var n=this.pendingSegment_.segment;n.videoTimingInfo||(n.videoTimingInfo={}),n.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0,n.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation,n.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation,n.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}var e=this.pendingSegment_,t=e.segment,n=this.mediaIndex!==null;if(this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>e.playlist.targetDuration*3){this.resetEverything();return}n&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(e.mediaIndex+1,e.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_()}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,s=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(s-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(e){if(this.segmentMetadataTrack_){var t=e.segment,n=t.start,s=t.end;if(!(!Nc(n)||!Nc(s))){Or(n,s,this.segmentMetadataTrack_);var o=S.WebKitDataCue||S.VTTCue,u={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:n,end:s},l=JSON.stringify(u),c=new o(n,s,l);c.value=u,this.segmentMetadataTrack_.addCue(c)}}}}]),r}(k.EventTarget),Mc=function(r){return decodeURIComponent(escape(String.fromCharCode.apply(null,r)))},Uc=new Uint8Array(`

`.split("").map(function(a){return a.charCodeAt(0)})),ig=function(a){xt(r,a);function r(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ze(this,r);var t=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i,e));return t.mediaSource_=null,t.subtitlesTrack_=null,t.featuresNativeTextTracks_=i.featuresNativeTextTracks,t}return it(r,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return k.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,n=e[e.length-1].startTime;return k.createTimeRanges([[t,n]])}},{key:"initSegment",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e)return null;var n=vn(e),s=this.initSegments_[n];if(t&&!s&&e.bytes){var o=Uc.byteLength+e.bytes.byteLength,u=new Uint8Array(o);u.set(e.bytes),u.set(Uc,e.bytes.byteLength),this.initSegments_[n]=s={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:u}}return s||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return typeof e>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}},{key:"remove",value:function(e,t){Or(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t),!!t){if(this.syncController_.timestampOffsetForTimeline(t.timeline)===null){var n=function(){e.state="READY",e.paused()||e.monitorBuffer_()};this.syncController_.one("timestampoffset",n),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var e=this;if(!this.pendingSegment_||!this.subtitlesTrack_){this.state="READY";return}this.state="APPENDING";var t=this.pendingSegment_,n=t.segment;if(typeof S.WebVTT!="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var s=void 0,o=function(){e.subtitlesTrack_.tech_.off("vttjsloaded",s),e.error({message:"Error loading vtt.js"}),e.state="READY",e.pause(),e.trigger("error")};s=function(){e.subtitlesTrack_.tech_.off("vttjserror",o),e.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",s),this.subtitlesTrack_.tech_.one("vttjserror",o);return}n.requested=!0;try{this.parseVTTCues_(t)}catch(u){return this.error({message:u.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(t,this.syncController_.timelines[t.timeline],this.playlist_),t.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}t.byteLength=t.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,t.cues.length&&this.remove(t.cues[0].endTime,t.cues[t.cues.length-1].endTime),t.cues.forEach(function(u){e.subtitlesTrack_.addCue(e.featuresNativeTextTracks_?new S.VTTCue(u.startTime,u.endTime,u.text):u)}),this.handleUpdateEnd_()}},{key:"parseVTTCues_",value:function(e){var t=void 0,n=!1;typeof S.TextDecoder=="function"?t=new S.TextDecoder("utf8"):(t=S.WebVTT.StringDecoder(),n=!0);var s=new S.WebVTT.Parser(S,S.vttjs,t);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},s.oncue=e.cues.push.bind(e.cues),s.ontimestampmap=function(l){return e.timestampmap=l},s.onparsingerror=function(l){k.log.warn("Error encountered when parsing cues: "+l.message)},e.segment.map){var o=e.segment.map.bytes;n&&(o=Mc(o)),s.parse(o)}var u=e.bytes;n&&(u=Mc(u)),s.parse(u),s.flush()}},{key:"updateTimeMapping_",value:function(e,t,n){var s=e.segment;if(t){if(!e.cues.length){s.empty=!0;return}var o=e.timestampmap,u=o.MPEGTS/9e4-o.LOCAL+t.mapping;if(e.cues.forEach(function(f){f.startTime+=u,f.endTime+=u}),!n.syncInfo){var l=e.cues[0].startTime,c=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(l,c-s.duration)}}}}}]),r}(Ns),ng=function(r,i){for(var e=r.cues,t=0;t<e.length;t++){var n=e[t];if(i>=n.adStartTime&&i<=n.adEndTime)return n}return null},ag=function(r,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(r.segments)for(var t=e,n=void 0,s=0;s<r.segments.length;s++){var o=r.segments[s];if(n||(n=ng(i,t+o.duration/2)),n){if("cueIn"in o){n.endTime=t,n.adEndTime=t,t+=o.duration,n=null;continue}if(t<n.endTime){t+=o.duration;continue}n.endTime+=o.duration}else if("cueOut"in o&&(n=new S.VTTCue(t,t+o.duration,o.cueOut),n.adStartTime=t,n.adEndTime=t+parseFloat(o.cueOut),i.addCue(n)),"cueOutCont"in o){var u=void 0,l=void 0,c=o.cueOutCont.split("/").map(parseFloat),f=Rm(c,2);u=f[0],l=f[1],n=new S.VTTCue(t,t+o.duration,""),n.adStartTime=t-u,n.adEndTime=n.adStartTime+l,i.addCue(n)}t+=o.duration}},sg=Cm.inspect,Fc=[{name:"VOD",run:function(r,i,e,t,n){if(e!==1/0){var s={time:0,segmentIndex:0};return s}return null}},{name:"ProgramDateTime",run:function(r,i,e,t,n){if(!r.datetimeToDisplayTime)return null;var s=i.segments||[],o=null,u=null;n=n||0;for(var l=0;l<s.length;l++){var c=s[l];if(c.dateTimeObject){var f=c.dateTimeObject.getTime()/1e3,d=f+r.datetimeToDisplayTime,m=Math.abs(n-d);if(u!==null&&(m===0||u<m))break;u=m,o={time:d,segmentIndex:l}}}return o}},{name:"Segment",run:function(r,i,e,t,n){var s=i.segments||[],o=null,u=null;n=n||0;for(var l=0;l<s.length;l++){var c=s[l];if(c.timeline===t&&typeof c.start<"u"){var f=Math.abs(n-c.start);if(u!==null&&u<f)break;(!o||u===null||u>=f)&&(u=f,o={time:c.start,segmentIndex:l})}}return o}},{name:"Discontinuity",run:function(r,i,e,t,n){var s=null;if(n=n||0,i.discontinuityStarts&&i.discontinuityStarts.length)for(var o=null,u=0;u<i.discontinuityStarts.length;u++){var l=i.discontinuityStarts[u],c=i.discontinuitySequence+u+1,f=r.discontinuities[c];if(f){var d=Math.abs(n-f.time);if(o!==null&&o<d)break;(!s||o===null||o>=d)&&(o=d,s={time:f.time,segmentIndex:l})}}return s}},{name:"Playlist",run:function(r,i,e,t,n){if(i.syncInfo){var s={time:i.syncInfo.time,segmentIndex:i.syncInfo.mediaSequence-i.mediaSequence};return s}return null}}],og=function(a){xt(r,a);function r(){Ze(this,r);var i=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return i.inspectCache_=void 0,i.timelines=[],i.discontinuities=[],i.datetimeToDisplayTime=null,i.logger_=yi("SyncController"),i}return it(r,[{key:"getSyncPoint",value:function(e,t,n,s){var o=this.runStrategies_(e,t,n,s);return o.length?this.selectSyncPoint_(o,{key:"time",value:s}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;var s=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return s.segmentIndex>0&&(s.time*=-1),Math.abs(s.time+vi(e,s.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,n,s){for(var o=[],u=0;u<Fc.length;u++){var l=Fc[u],c=l.run(this,e,t,n,s);c&&(c.strategy=l.name,o.push({strategy:l.name,syncPoint:c}))}return o}},{key:"selectSyncPoint_",value:function(e,t){for(var n=e[0].syncPoint,s=Math.abs(e[0].syncPoint[t.key]-t.value),o=e[0].strategy,u=1;u<e.length;u++){var l=Math.abs(e[u].syncPoint[t.key]-t.value);l<s&&(s=l,n=e[u].syncPoint,o=e[u].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy"+(" ["+o+"]: [time:"+n.time+",")+(" segmentIndex:"+n.segmentIndex+"]")),n}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var n=t.mediaSequence-e.mediaSequence,s=n-1;s>=0;s--){var o=e.segments[s];if(o&&typeof o.start<"u"){t.syncInfo={mediaSequence:e.mediaSequence+s,time:o.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+","+(" mediaSequence: "+t.syncInfo.mediaSequence+"]")),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,n=e.playlist,s=void 0;return t.map?s=this.probeMp4Segment_(e):s=this.probeTsSegment_(e),s&&this.calculateSegmentTimeMapping_(e,s)&&(this.saveDiscontinuitySyncInfo_(e),n.syncInfo||(n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:t.start})),s}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,n=bt.timescale(t.map.bytes),s=bt.compositionStartTime(n,e.bytes);return e.timestampOffset!==null&&(e.timestampOffset-=s),{start:s,end:s+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=sg(e.bytes,this.inspectCache_),n=void 0,s=void 0,o=void 0;if(!t)return null;t.video&&t.video.length===2?(this.inspectCache_=t.video[1].dts,n=t.video[0].dtsTime,s=t.video[1].dtsTime,o=t.video):t.audio&&t.audio.length===2&&(this.inspectCache_=t.audio[1].dts,n=t.audio[0].dtsTime,s=t.audio[1].dtsTime,o=t.audio);var u={segmentTimestampInfo:o,start:n,end:s,containsVideo:t.video&&t.video.length===2,containsAudio:t.audio&&t.audio.length===2};return u}},{key:"timestampOffsetForTimeline",value:function(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var n=e.segment,s=this.timelines[e.timeline];if(e.timestampOffset!==null)s={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.timelines[e.timeline]=s,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": "+("[time: "+s.time+"] [mapping: "+s.mapping+"]")),n.start=e.startOfSegment,n.end=t.end+s.mapping;else if(s)n.start=t.start+s.mapping,n.end=t.end+s.mapping;else return!1;return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var s=0;s<t.discontinuityStarts.length;s++){var o=t.discontinuityStarts[s],u=t.discontinuitySequence+s+1,l=o-e.mediaIndex,c=Math.abs(l);if(!this.discontinuities[u]||this.discontinuities[u].accuracy>c){var f=void 0;l<0?f=n.start-vi(t,e.mediaIndex,o):f=n.end+vi(t,e.mediaIndex+1,o),this.discontinuities[u]={time:f,accuracy:c}}}}},{key:"dispose",value:function(){this.trigger("dispose"),this.off()}}]),r}(k.EventTarget),ug=new yc("./decrypter-worker.worker.js",function(a,r){var i=this,e=function(){function t(M){return M.subarray(0,M.byteLength-M[M.byteLength-1])}var n=function(U,R){if(!(U instanceof R))throw new TypeError("Cannot call a class as a function")},s=function(){function M(U,R){for(var j=0;j<R.length;j++){var G=R[j];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(U,G.key,G)}}return function(U,R,j){return R&&M(U.prototype,R),j&&M(U,j),U}}(),o=function(U,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);U.prototype=Object.create(R&&R.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(U,R):U.__proto__=R)},u=function(U,R){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:U},l=function(){var U=[[[],[],[],[],[]],[[],[],[],[],[]]],R=U[0],j=U[1],G=R[4],Q=j[4],$=void 0,z=void 0,K=void 0,V=[],oe=[],ve=void 0,ee=void 0,ue=void 0,_e=void 0,Ve=void 0,ce=void 0;for($=0;$<256;$++)oe[(V[$]=$<<1^($>>7)*283)^$]=$;for(z=K=0;!G[z];z^=ve||1,K=oe[K]||1)for(_e=K^K<<1^K<<2^K<<3^K<<4,_e=_e>>8^_e&255^99,G[z]=_e,Q[_e]=z,ue=V[ee=V[ve=V[z]]],ce=ue*16843009^ee*65537^ve*257^z*16843008,Ve=V[_e]*257^_e*16843008,$=0;$<4;$++)R[$][z]=Ve=Ve<<24^Ve>>>8,j[$][_e]=ce=ce<<24^ce>>>8;for($=0;$<5;$++)R[$]=R[$].slice(0),j[$]=j[$].slice(0);return U},c=null,f=function(){function M(U){n(this,M),c||(c=l()),this._tables=[[c[0][0].slice(),c[0][1].slice(),c[0][2].slice(),c[0][3].slice(),c[0][4].slice()],[c[1][0].slice(),c[1][1].slice(),c[1][2].slice(),c[1][3].slice(),c[1][4].slice()]];var R=void 0,j=void 0,G=void 0,Q=void 0,$=void 0,z=this._tables[0][4],K=this._tables[1],V=U.length,oe=1;if(V!==4&&V!==6&&V!==8)throw new Error("Invalid aes key size");for(Q=U.slice(0),$=[],this._key=[Q,$],R=V;R<4*V+28;R++)G=Q[R-1],(R%V===0||V===8&&R%V===4)&&(G=z[G>>>24]<<24^z[G>>16&255]<<16^z[G>>8&255]<<8^z[G&255],R%V===0&&(G=G<<8^G>>>24^oe<<24,oe=oe<<1^(oe>>7)*283)),Q[R]=Q[R-V]^G;for(j=0;R;j++,R--)G=Q[j&3?R:R-4],R<=4||j<4?$[j]=G:$[j]=K[0][z[G>>>24]]^K[1][z[G>>16&255]]^K[2][z[G>>8&255]]^K[3][z[G&255]]}return M.prototype.decrypt=function(R,j,G,Q,$,z){var K=this._key[1],V=R^K[0],oe=Q^K[1],ve=G^K[2],ee=j^K[3],ue=void 0,_e=void 0,Ve=void 0,ce=K.length/4-2,ct=void 0,Et=4,ft=this._tables[1],Yt=ft[0],Qt=ft[1],Jt=ft[2],ht=ft[3],Ur=ft[4];for(ct=0;ct<ce;ct++)ue=Yt[V>>>24]^Qt[oe>>16&255]^Jt[ve>>8&255]^ht[ee&255]^K[Et],_e=Yt[oe>>>24]^Qt[ve>>16&255]^Jt[ee>>8&255]^ht[V&255]^K[Et+1],Ve=Yt[ve>>>24]^Qt[ee>>16&255]^Jt[V>>8&255]^ht[oe&255]^K[Et+2],ee=Yt[ee>>>24]^Qt[V>>16&255]^Jt[oe>>8&255]^ht[ve&255]^K[Et+3],Et+=4,V=ue,oe=_e,ve=Ve;for(ct=0;ct<4;ct++)$[(3&-ct)+z]=Ur[V>>>24]<<24^Ur[oe>>16&255]<<16^Ur[ve>>8&255]<<8^Ur[ee&255]^K[Et++],ue=V,V=oe,oe=ve,ve=ee,ee=ue},M}(),d=function(){function M(){n(this,M),this.listeners={}}return M.prototype.on=function(R,j){this.listeners[R]||(this.listeners[R]=[]),this.listeners[R].push(j)},M.prototype.off=function(R,j){if(!this.listeners[R])return!1;var G=this.listeners[R].indexOf(j);return this.listeners[R].splice(G,1),G>-1},M.prototype.trigger=function(R){var j=this.listeners[R];if(j)if(arguments.length===2)for(var G=j.length,Q=0;Q<G;++Q)j[Q].call(this,arguments[1]);else for(var $=Array.prototype.slice.call(arguments,1),z=j.length,K=0;K<z;++K)j[K].apply(this,$)},M.prototype.dispose=function(){this.listeners={}},M.prototype.pipe=function(R){this.on("data",function(j){R.push(j)})},M}(),m=function(M){o(U,M);function U(){n(this,U);var R=u(this,M.call(this,d));return R.jobs=[],R.delay=1,R.timeout_=null,R}return U.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},U.prototype.push=function(j){this.jobs.push(j),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},U}(d),_=function(U){return U<<24|(U&65280)<<8|(U&16711680)>>8|U>>>24},b=function(U,R,j){var G=new Int32Array(U.buffer,U.byteOffset,U.byteLength>>2),Q=new f(Array.prototype.slice.call(R)),$=new Uint8Array(U.byteLength),z=new Int32Array($.buffer),K=void 0,V=void 0,oe=void 0,ve=void 0,ee=void 0,ue=void 0,_e=void 0,Ve=void 0,ce=void 0;for(K=j[0],V=j[1],oe=j[2],ve=j[3],ce=0;ce<G.length;ce+=4)ee=_(G[ce]),ue=_(G[ce+1]),_e=_(G[ce+2]),Ve=_(G[ce+3]),Q.decrypt(ee,ue,_e,Ve,z,ce),z[ce]=_(z[ce]^K),z[ce+1]=_(z[ce+1]^V),z[ce+2]=_(z[ce+2]^oe),z[ce+3]=_(z[ce+3]^ve),K=ee,V=ue,oe=_e,ve=Ve;return $},A=function(){function M(U,R,j,G){n(this,M);var Q=M.STEP,$=new Int32Array(U.buffer),z=new Uint8Array(U.byteLength),K=0;for(this.asyncStream_=new m,this.asyncStream_.push(this.decryptChunk_($.subarray(K,K+Q),R,j,z)),K=Q;K<$.length;K+=Q)j=new Uint32Array([_($[K-4]),_($[K-3]),_($[K-2]),_($[K-1])]),this.asyncStream_.push(this.decryptChunk_($.subarray(K,K+Q),R,j,z));this.asyncStream_.push(function(){G(null,t(z))})}return M.prototype.decryptChunk_=function(R,j,G,Q){return function(){var $=b(R,j,G);Q.set($,R.byteOffset)}},s(M,null,[{key:"STEP",get:function(){return 32e3}}]),M}(),I=function(U){var R={};return Object.keys(U).forEach(function(j){var G=U[j];ArrayBuffer.isView(G)?R[j]={bytes:G.buffer,byteOffset:G.byteOffset,byteLength:G.byteLength}:R[j]=G}),R},D=function(U){U.onmessage=function(R){var j=R.data,G=new Uint8Array(j.encrypted.bytes,j.encrypted.byteOffset,j.encrypted.byteLength),Q=new Uint32Array(j.key.bytes,j.key.byteOffset,j.key.byteLength/4),$=new Uint32Array(j.iv.bytes,j.iv.byteOffset,j.iv.byteLength/4);new A(G,Q,$,function(z,K){U.postMessage(I({source:j.source,decrypted:K}),[K.buffer])})}},O=new D(i);return O}()}),lg=function(r){var i=r.default?"main":"alternative";return r.characteristics&&r.characteristics.indexOf("public.accessibility.describes-video")>=0&&(i="main-desc"),i},yn=function(r,i){r.abort(),r.pause(),i&&i.activePlaylistLoader&&(i.activePlaylistLoader.pause(),i.activePlaylistLoader=null)},Ms=function(r,i){i.activePlaylistLoader=r,r.load()},cg=function(r,i){return function(){var e=i.segmentLoaders,t=e[r],n=e.main,s=i.mediaTypes[r],o=s.activeTrack(),u=s.activeGroup(o),l=s.activePlaylistLoader;if(yn(t,s),!!u){if(!u.playlistLoader){l&&n.resetEverything();return}t.resyncLoader(),Ms(u.playlistLoader,s)}}},fg=function(r,i){return function(){var e=i.segmentLoaders,t=e[r],n=e.main,s=i.mediaTypes[r],o=s.activeTrack(),u=s.activeGroup(o),l=s.activePlaylistLoader;if(yn(t,s),!!u){if(!u.playlistLoader){n.resetEverything();return}if(l===u.playlistLoader){Ms(u.playlistLoader,s);return}t.track&&t.track(o),t.resetEverything(),Ms(u.playlistLoader,s)}}},Tn={AUDIO:function(r,i){return function(){var e=i.segmentLoaders[r],t=i.mediaTypes[r],n=i.blacklistCurrentPlaylist;yn(e,t);var s=t.activeTrack(),o=t.activeGroup(),u=(o.filter(function(f){return f.default})[0]||o[0]).id,l=t.tracks[u];if(s===l){n({message:"Problem encountered loading the default audio track."});return}k.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(var c in t.tracks)t.tracks[c].enabled=t.tracks[c]===l;t.onTrackChanged()}},SUBTITLES:function(r,i){return function(){var e=i.segmentLoaders[r],t=i.mediaTypes[r];k.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),yn(e,t);var n=t.activeTrack();n&&(n.mode="disabled"),t.onTrackChanged()}}},Bc={AUDIO:function(r,i,e){if(i){var t=e.tech,n=e.requestOptions,s=e.segmentLoaders[r];i.on("loadedmetadata",function(){var o=i.media();s.playlist(o,n),(!t.paused()||o.endList&&t.preload()!=="none")&&s.load()}),i.on("loadedplaylist",function(){s.playlist(i.media(),n),t.paused()||s.load()}),i.on("error",Tn[r](r,e))}},SUBTITLES:function(r,i,e){var t=e.tech,n=e.requestOptions,s=e.segmentLoaders[r],o=e.mediaTypes[r];i.on("loadedmetadata",function(){var u=i.media();s.playlist(u,n),s.track(o.activeTrack()),(!t.paused()||u.endList&&t.preload()!=="none")&&s.load()}),i.on("loadedplaylist",function(){s.playlist(i.media(),n),t.paused()||s.load()}),i.on("error",Tn[r](r,e))}},hg={AUDIO:function(r,i){var e=i.hls,t=i.sourceType,n=i.segmentLoaders[r],s=i.requestOptions,o=i.master.mediaGroups,u=i.mediaTypes[r],l=u.groups,c=u.tracks,f=i.masterPlaylistLoader;(!o[r]||Object.keys(o[r]).length===0)&&(o[r]={main:{default:{default:!0}}});for(var d in o[r]){l[d]||(l[d]=[]);for(var m in o[r][d]){var _=o[r][d][m],b=void 0;if(_.resolvedUri?b=new pn(_.resolvedUri,e,s):_.playlists&&t==="dash"?b=new Os(_.playlists[0],e,s,f):b=null,_=k.mergeOptions({id:m,playlistLoader:b},_),Bc[r](r,_.playlistLoader,i),l[d].push(_),typeof c[m]>"u"){var A=new k.AudioTrack({id:m,kind:lg(_),enabled:!1,language:_.language,default:_.default,label:m});c[m]=A}}}n.on("error",Tn[r](r,i))},SUBTITLES:function(r,i){var e=i.tech,t=i.hls,n=i.sourceType,s=i.segmentLoaders[r],o=i.requestOptions,u=i.master.mediaGroups,l=i.mediaTypes[r],c=l.groups,f=l.tracks,d=i.masterPlaylistLoader;for(var m in u[r]){c[m]||(c[m]=[]);for(var _ in u[r][m])if(!u[r][m][_].forced){var b=u[r][m][_],A=void 0;if(n==="hls"?A=new pn(b.resolvedUri,t,o):n==="dash"&&(A=new Os(b.playlists[0],t,o,d)),b=k.mergeOptions({id:_,playlistLoader:A},b),Bc[r](r,b.playlistLoader,i),c[m].push(b),typeof f[_]>"u"){var I=e.addRemoteTextTrack({id:_,kind:"subtitles",default:b.default&&b.autoselect,language:b.language,label:_},!1).track;f[_]=I}}}s.on("error",Tn[r](r,i))},"CLOSED-CAPTIONS":function(r,i){var e=i.tech,t=i.master.mediaGroups,n=i.mediaTypes[r],s=n.groups,o=n.tracks;for(var u in t[r]){s[u]||(s[u]=[]);for(var l in t[r][u]){var c=t[r][u][l];if(c.instreamId.match(/CC\d/)&&(s[u].push(k.mergeOptions({id:l},c)),typeof o[l]>"u")){var f=e.addRemoteTextTrack({id:c.instreamId,kind:"captions",default:c.default&&c.autoselect,language:c.language,label:l},!1).track;o[l]=f}}}}},dg=function(r,i){return function(e){var t=i.masterPlaylistLoader,n=i.mediaTypes[r].groups,s=t.media();if(!s)return null;var o=null;return s.attributes[r]&&(o=n[s.attributes[r]]),o=o||n.main,typeof e>"u"?o:e===null?null:o.filter(function(u){return u.id===e.id})[0]||null}},pg={AUDIO:function(r,i){return function(){var e=i.mediaTypes[r].tracks;for(var t in e)if(e[t].enabled)return e[t];return null}},SUBTITLES:function(r,i){return function(){var e=i.mediaTypes[r].tracks;for(var t in e)if(e[t].mode==="showing"||e[t].mode==="hidden")return e[t];return null}}},mg=function(r){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(c){hg[c](c,r)});var i=r.mediaTypes,e=r.masterPlaylistLoader,t=r.tech,n=r.hls;["AUDIO","SUBTITLES"].forEach(function(c){i[c].activeGroup=dg(c,r),i[c].activeTrack=pg[c](c,r),i[c].onGroupChanged=cg(c,r),i[c].onTrackChanged=fg(c,r)});var s=i.AUDIO.activeGroup(),o=(s.filter(function(c){return c.default})[0]||s[0]).id;i.AUDIO.tracks[o].enabled=!0,i.AUDIO.onTrackChanged(),e.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(c){return i[c].onGroupChanged()})});var u=function(){i.AUDIO.onTrackChanged(),t.trigger({type:"usage",name:"hls-audio-change"})};t.audioTracks().addEventListener("change",u),t.remoteTextTracks().addEventListener("change",i.SUBTITLES.onTrackChanged),n.on("dispose",function(){t.audioTracks().removeEventListener("change",u),t.remoteTextTracks().removeEventListener("change",i.SUBTITLES.onTrackChanged)}),t.clearTracks("audio");for(var l in i.AUDIO.tracks)t.audioTracks().addTrack(i.AUDIO.tracks[l])},vg=function(){var r={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(i){r[i]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Mr,activeTrack:Mr,onGroupChanged:Mr,onTrackChanged:Mr}}),r},gg=60*2,Rt=void 0,_g=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],yg=function(r){return this.audioSegmentLoader_[r]+this.mainSegmentLoader_[r]},Tg=function(r){var i=r.currentPlaylist,e=r.nextPlaylist,t=r.forwardBuffer,n=r.bufferLowWaterLine,s=r.duration,o=r.log;return e?!i.endList||s<qe.MAX_BUFFER_LOW_WATER_LINE||e.attributes.BANDWIDTH<i.attributes.BANDWIDTH||t>=n:(k.log.warn("We received no playlist to switch to. Please check your stream."),!1)},bg=function(a){xt(r,a);function r(i){Ze(this,r);var e=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),t=i.url,n=i.handleManifestRedirects,s=i.withCredentials,o=i.tech,u=i.bandwidth,l=i.externHls,c=i.useCueTags,f=i.blacklistDuration,d=i.enableLowInitialPlaylist,m=i.cacheEncryptionKeys,_=i.sourceType;if(!t)throw new Error("A non-empty playlist URL is required");Rt=l,e.withCredentials=s,e.tech_=o,e.hls_=o.hls,e.sourceType_=_,e.useCueTags_=c,e.blacklistDuration=f,e.enableLowInitialPlaylist=d,e.useCueTags_&&(e.cueTagsTrack_=e.tech_.addTextTrack("metadata","ad-cues"),e.cueTagsTrack_.inBandMetadataTrackDispatchType=""),e.requestOptions_={withCredentials:s,handleManifestRedirects:n,timeout:null},e.mediaTypes_=vg(),e.mediaSource=new k.MediaSource,e.mediaSource.addEventListener("sourceopen",e.handleSourceOpen_.bind(e)),e.seekable_=k.createTimeRanges(),e.hasPlayed_=!1,e.syncController_=new og(i),e.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,e.decrypter_=new ug,e.inbandTextTracks_={};var b={hls:e.hls_,mediaSource:e.mediaSource,currentTime:e.tech_.currentTime.bind(e.tech_),seekable:function(){return e.seekable()},seeking:function(){return e.tech_.seeking()},duration:function(){return e.mediaSource.duration},hasPlayed:function(){return e.hasPlayed_},goalBufferLength:function(){return e.goalBufferLength()},bandwidth:u,syncController:e.syncController_,decrypter:e.decrypter_,sourceType:e.sourceType_,inbandTextTracks:e.inbandTextTracks_,cacheEncryptionKeys:m};return e.masterPlaylistLoader_=e.sourceType_==="dash"?new Os(t,e.hls_,e.requestOptions_):new pn(t,e.hls_,e.requestOptions_),e.setupMasterPlaylistLoaderListeners_(),e.mainSegmentLoader_=new Ns(k.mergeOptions(b,{segmentMetadataTrack:e.segmentMetadataTrack_,loaderType:"main"}),i),e.audioSegmentLoader_=new Ns(k.mergeOptions(b,{loaderType:"audio"}),i),e.subtitleSegmentLoader_=new ig(k.mergeOptions(b,{loaderType:"vtt",featuresNativeTextTracks:e.tech_.featuresNativeTextTracks}),i),e.setupSegmentLoaderListeners_(),_g.forEach(function(A){e[A+"_"]=yg.bind(e,A)}),e.logger_=yi("MPC"),e.masterPlaylistLoader_.load(),e}return it(r,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var t=e.masterPlaylistLoader_.media(),n=t.targetDuration*1.5*1e3;xs(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,t.endList&&e.tech_.preload()!=="none"&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),mg({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,hls:e.hls_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t);try{e.setupSourceBuffers_()}catch(s){return k.log.warn("Failed to create SourceBuffers",s),e.mediaSource.endOfStream("decode")}e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){e.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var t=e.masterPlaylistLoader_.media();if(!t){e.excludeUnsupportedVariants_();var n=void 0;e.enableLowInitialPlaylist&&(n=e.selectInitialPlaylist()),n||(n=e.selectPlaylist()),e.initialMedia_=n,e.masterPlaylistLoader_.media(e.initialMedia_);return}if(e.useCueTags_&&e.updateAdCues_(t),e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.updateDuration(),e.tech_.paused()||(e.mainSegmentLoader_.load(),e.audioSegmentLoader_&&e.audioSegmentLoader_.load()),!t.endList){var s=function(){var l=e.seekable();l.length!==0&&e.mediaSource.addSeekableRange_(l.start(0),l.end(0))};if(e.duration()!==1/0){var o=function u(){e.duration()===1/0?s():e.tech_.one("durationchange",u)};e.tech_.one("durationchange",o)}else s()}}),this.masterPlaylistLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var t=e.masterPlaylistLoader_.media(),n=t.targetDuration*1.5*1e3;xs(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var t=e.masterPlaylistLoader_.media(),n=e.stuckAtPlaylistEnd_(t);n&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var n=e.mediaGroups||{},s=!0,o=Object.keys(n.AUDIO);for(var u in n.AUDIO)for(var l in n.AUDIO[u]){var c=n.AUDIO[u][l];c.uri||(s=!1)}s&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),Rt.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),Rt.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),o.length&&Object.keys(n.AUDIO[o[0]]).length>1&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var t=e.selectPlaylist(),n=e.masterPlaylistLoader_.media(),s=e.tech_.buffered(),o=s.length?s.end(s.length-1)-e.tech_.currentTime():0,u=e.bufferLowWaterLine();Tg({currentPlaylist:n,nextPlaylist:t,forwardBuffer:o,bufferLowWaterLine:u,duration:e.duration(),log:e.logger_})&&e.masterPlaylistLoader_.media(t),e.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){e.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){e.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},gg)}),this.mainSegmentLoader_.on("reseteverything",function(){e.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})}),this.audioSegmentLoader_.on("ended",function(){e.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything(function(){k.browser.IE_VERSION||k.browser.IS_EDGE?e.tech_.setCurrentTime(e.tech_.currentTime()+.04):e.tech_.setCurrentTime(e.tech_.currentTime())}))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var e=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return!1;if(!t.endList){var n=this.seekable();if(!n.length)return!1;if(k.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",function(){e.trigger("firstplay"),e.tech_.setCurrentTime(n.end(0)),e.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(n.end(0))}return this.hasPlayed_=!0,this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(t){return k.log.warn("Failed to create Source Buffers",t),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();typeof e<"u"&&typeof e.then=="function"&&e.then(null,function(t){})}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_),!!e){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(t){k.log.warn("Failed to call media source endOfStream",t)}}}},{key:"stuckAtPlaylistEnd_",value:function(e){var t=this.seekable();if(!t.length)return!1;var n=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(n===null)return!1;var s=Rt.Playlist.playlistEnd(e,n),o=this.tech_.currentTime(),u=this.tech_.buffered();if(!u.length)return s-o<=St;var l=u.end(u.length-1);return l-o<=St&&s-l<=St}},{key:"blacklistCurrentPlaylist",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments[1],n=void 0,s=void 0;if(n=e.playlist||this.masterPlaylistLoader_.media(),t=t||e.blacklistDuration||this.blacklistDuration,!n){this.error=e;try{return this.mediaSource.endOfStream("network")}catch{return this.trigger("error")}}var o=this.masterPlaylistLoader_.master.playlists.filter(mn).length===1,u=this.masterPlaylistLoader_.master.playlists;return u.length===1?(k.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(o)):(o&&(k.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),u.forEach(function(l){l.excludeUntil!==1/0&&delete l.excludeUntil}),this.tech_.trigger("retryplaylist")),n.excludeUntil=Date.now()+t*1e3,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),s=this.selectPlaylist(),k.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(s,o))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=mc(this.tech_.buffered(),e);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())||!this.masterPlaylistLoader_.media().segments)return 0;if(t&&t.length)return e;this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),this.load()}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:Rt.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0;if(this.masterPlaylistLoader_){var t=this.masterPlaylistLoader_.media();if(t){var n=this.syncController_.getExpiredTime(t,this.mediaSource.duration);if(n!==null){var s=this.masterPlaylistLoader_.master.suggestedPresentationDelay,o=Rt.Playlist.seekable(t,n,s);if(o.length!==0&&!(this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),n=this.syncController_.getExpiredTime(t,this.mediaSource.duration),n===null||(e=Rt.Playlist.seekable(t,n,s),e.length===0)))){var u=void 0,l=void 0;this.seekable_&&this.seekable_.length&&(u=this.seekable_.end(0),l=this.seekable_.start(0)),e?e.start(0)>o.end(0)||o.start(0)>e.end(0)?this.seekable_=o:this.seekable_=k.createTimeRanges([[e.start(0)>o.start(0)?e.start(0):o.start(0),e.end(0)<o.end(0)?e.end(0):o.end(0)]]):this.seekable_=o,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===u&&this.seekable_.start(0)===l)&&(this.logger_("seekable updated ["+Es(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}}},{key:"updateDuration",value:function(){var e=this,t=this.mediaSource.duration,n=Rt.Playlist.duration(this.masterPlaylistLoader_.media()),s=this.tech_.buffered(),o=function u(){e.logger_("Setting duration from "+e.mediaSource.duration+" => "+n);try{e.mediaSource.duration=n}catch(l){k.log.warn("Failed to set media source duration",l)}e.tech_.trigger("durationchange"),e.mediaSource.removeEventListener("sourceopen",u)};s.length>0&&(n=Math.max(n,s.end(s.length-1))),t!==n&&(this.mediaSource.readyState!=="open"?this.mediaSource.addEventListener("sourceopen",o):o())}},{key:"dispose",value:function(){var e=this;this.trigger("dispose"),this.decrypter_&&this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(t){var n=e.mediaTypes_[t].groups;for(var s in n)n[s].forEach(function(o){o.playlistLoader&&o.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.off(),this.mediaSource.dispose&&this.mediaSource.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e=this.masterPlaylistLoader_.media(),t=void 0;if(!(!e||this.mediaSource.readyState!=="open")){if(t=Cv(this.masterPlaylistLoader_.master,e),t.length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+e.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(t),this.excludeIncompatibleVariants_(e)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=e.length>1&&e[0].indexOf(",")===-1&&e[0]!==e[1]?new k.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(e){e.attributes.CODECS&&S.MediaSource&&S.MediaSource.isTypeSupported&&!S.MediaSource.isTypeSupported('video/mp4; codecs="'+bv(e.attributes.CODECS)+'"')&&(e.excludeUntil=1/0)})}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,n=null,s=void 0;e.attributes.CODECS&&(s=gi(e.attributes.CODECS),n=s.videoCodec,t=s.codecCount),this.master().playlists.forEach(function(o){var u={codecCount:2,videoCodec:null};o.attributes.CODECS&&(u=gi(o.attributes.CODECS)),u.codecCount!==t&&(o.excludeUntil=1/0),u.videoCodec!==n&&(o.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(e){var t=0,n=this.seekable();n.length&&(t=n.start(0)),ag(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=qe.GOAL_BUFFER_LENGTH,n=qe.GOAL_BUFFER_LENGTH_RATE,s=Math.max(t,qe.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,s)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=qe.BUFFER_LOW_WATER_LINE,n=qe.BUFFER_LOW_WATER_LINE_RATE,s=Math.max(t,qe.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,s)}}]),r}(k.EventTarget),xg=function(r,i,e){return function(t){var n=r.master.playlists[i],s=bs(n),o=mn(n);return typeof t>"u"?o:(t?delete n.disabled:n.disabled=!0,t!==o&&!s&&(e(),t?r.trigger("renditionenabled"):r.trigger("renditiondisabled")),t)}},Sg=function a(r,i,e){Ze(this,a);var t=r.masterPlaylistController_,n=r.options_.smoothQualityChange,s=n?"smooth":"fast",o=t[s+"QualityChange_"].bind(t);if(i.attributes.RESOLUTION){var u=i.attributes.RESOLUTION;this.width=u.width,this.height=u.height}this.bandwidth=i.attributes.BANDWIDTH,this.id=e,this.enabled=xg(r.playlists,i.id,o)},Eg=function(r){var i=r.playlists;r.representations=function(){return!i||!i.master||!i.master.playlists?[]:i.master.playlists.filter(function(e){return!bs(e)}).map(function(e,t){return new Sg(r,e,e.id)})}},jc=["seeking","seeked","pause","playing","error"],Cg=function(){function a(r){var i=this;Ze(this,a),this.tech_=r.tech,this.seekable=r.seekable,this.allowSeeksWithinUnsafeLiveWindow=r.allowSeeksWithinUnsafeLiveWindow,this.media=r.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=yi("PlaybackWatcher"),this.logger_("initialize");var e=function(){return i.monitorCurrentTime_()},t=function(){return i.techWaiting_()},n=function(){return i.cancelTimer_()},s=function(){return i.fixesBadSeeks_()};this.tech_.on("seekablechanged",s),this.tech_.on("waiting",t),this.tech_.on(jc,n),this.tech_.on("canplay",e),this.dispose=function(){i.logger_("dispose"),i.tech_.off("seekablechanged",s),i.tech_.off("waiting",t),i.tech_.off(jc,n),i.tech_.off("canplay",e),i.checkCurrentTimeTimeout_&&S.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}return it(a,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&S.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=S.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_()){this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime();return}if(!(this.tech_.paused()||this.tech_.seeking())){var i=this.tech_.currentTime(),e=this.tech_.buffered();if(this.lastRecordedTime===i&&(!e.length||i+St>=e.end(e.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&i===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):i===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=i)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){var i=this.tech_.seeking();if(!i)return!1;var e=this.seekable(),t=this.tech_.currentTime(),n=this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow),s=void 0;if(n){var o=e.end(e.length-1);s=o}if(this.beforeSeekableWindow_(e,t)){var u=e.start(0);s=u+St}return typeof s<"u"?(this.logger_("Trying to seek outside of seekable at time "+t+" with "+("seekable range "+Es(e)+". Seeking to ")+(s+".")),this.tech_.setCurrentTime(s),!0):!1}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var i=this.tech_.currentTime(),e=this.tech_.buffered(),t=mc(e,i);if(t.length&&i+3<=t.end(0)){this.cancelTimer_(),this.tech_.setCurrentTime(i),this.logger_("Stopped at "+i+" while inside a buffered region "+("["+t.start(0)+" -> "+t.end(0)+"]. Attempting to resume ")+"playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}}}},{key:"techWaiting_",value:function(){var i=this.seekable(),e=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_()||this.tech_.seeking()||this.timer_!==null)return!0;if(this.beforeSeekableWindow_(i,e)){var t=i.end(i.length-1);return this.logger_("Fell out of live window at time "+e+". Seeking to "+("live point (seekable end) "+t)),this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var n=this.tech_.buffered(),s=vc(n,e);if(this.videoUnderflow_(s,n,e))return this.cancelTimer_(),this.tech_.setCurrentTime(e),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(s.length>0){var o=s.start(0)-e;return this.logger_("Stopped at "+e+", setting timer for "+o+", seeking "+("to "+s.start(0))),this.timer_=setTimeout(this.skipTheGap_.bind(this),o*1e3,e),!0}return!1}},{key:"afterSeekableWindow_",value:function(i,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!i.length)return!1;var s=i.end(i.length-1)+St,o=!t.endList;return o&&n&&(s=i.end(i.length-1)+t.targetDuration*3),e>s}},{key:"beforeSeekableWindow_",value:function(i,e){return!!(i.length&&i.start(0)>0&&e<i.start(0)-St)}},{key:"videoUnderflow_",value:function(i,e,t){if(i.length===0){var n=this.gapFromVideoUnderflow_(e,t);if(n)return this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". "+("Seeking to current time "+t)),!0}return!1}},{key:"skipTheGap_",value:function(i){var e=this.tech_.buffered(),t=this.tech_.currentTime(),n=vc(e,t);this.cancelTimer_(),!(n.length===0||t!==i)&&(this.logger_("skipTheGap_:","currentTime:",t,"scheduled currentTime:",i,"nextRange start:",n.start(0)),this.tech_.setCurrentTime(n.start(0)+gn),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(i,e){for(var t=hv(i),n=0;n<t.length;n++){var s=t.start(n),o=t.end(n);if(e-s<4&&e-s>2)return{start:s,end:o}}return null}}]),a}(),kg={errorInterval:30,getSource:function(r){var i=this.tech({IWillNotUseThisInPlugins:!0}),e=i.currentSource_;return r(e)}},Ag=function a(r,i){var e=0,t=0,n=k.mergeOptions(kg,i);r.ready(function(){r.trigger({type:"usage",name:"hls-error-reload-initialized"})});var s=function(){t&&r.currentTime(t)},o=function(d){d!=null&&(t=r.duration()!==1/0&&r.currentTime()||0,r.one("loadedmetadata",s),r.src(d),r.trigger({type:"usage",name:"hls-error-reload"}),r.play())},u=function(){if(Date.now()-e<n.errorInterval*1e3){r.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!n.getSource||typeof n.getSource!="function"){k.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return e=Date.now(),n.getSource.call(r,o)},l=function f(){r.off("loadedmetadata",s),r.off("error",u),r.off("dispose",f)},c=function(d){l(),a(r,d)};r.on("error",u),r.on("dispose",l),r.reloadSourceOnError=c},Vc=function(r){Ag(this,r)},Pg="1.13.2",je={PlaylistLoader:pn,Playlist:Be,Decrypter:Om,AsyncStream:$l,decrypt:Yl,utils:iv,STANDARD_PLAYLIST_SELECTOR:Kv,INITIAL_PLAYLIST_SELECTOR:$v,comparePlaylistBandwidth:Rs,comparePlaylistResolution:qv,xhr:lc()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(a){Object.defineProperty(je,a,{get:function(){return k.log.warn("using Hls."+a+" is UNSAFE be sure you know what you are doing"),qe[a]},set:function(i){if(k.log.warn("using Hls."+a+" is UNSAFE be sure you know what you are doing"),typeof i!="number"||i<0){k.log.warn("value of Hls."+a+" must be greater than or equal to 0");return}qe[a]=i}})});var Hc="videojs-vhs",Wc=function(r){var i=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;if(i.test(r))return"hls";var e=/^application\/dash\+xml/i;return e.test(r)?"dash":null},Gc=function(r,i){for(var e=i.media(),t=-1,n=0;n<r.length;n++)if(r[n].id===e.id){t=n;break}r.selectedIndex_=t,r.trigger({selectedIndex:t,type:"change"})},Ig=function(r,i){i.representations().forEach(function(e){r.addQualityLevel(e)}),Gc(r,i.playlists)};je.canPlaySource=function(){return k.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Dg=function(r,i,e){if(!r)return r;var t=void 0,n=void 0;if(e.mimeType_)t=i.mimeType_,n=e.mimeType_;else{var s=Cc(i.mimeType_),o=s.parameters.codecs.split(","),u=void 0,l=void 0;o.forEach(function(m){m=m.trim(),As(m)?u=m:Ps(m)&&(l=m)}),t=s.type+'; codecs="'+l+'"',n=s.type.replace("video","audio")+'; codecs="'+u+'"'}var c={},f=i.playlist_;for(var d in r)c[d]={audioContentType:n,videoContentType:t},f.contentProtection&&f.contentProtection[d]&&f.contentProtection[d].pssh&&(c[d].pssh=f.contentProtection[d].pssh),typeof r[d]=="string"&&(c[d].url=r[d]);return k.mergeOptions(r,c)},wg=function(r){var i=r.masterPlaylistController_.mainSegmentLoader_,e=r.masterPlaylistController_.audioSegmentLoader_,t=k.players[r.tech_.options_.playerId];if(t.eme){var n=Dg(r.source_.keySystems,i,e);n&&(t.currentSource().keySystems=n,k.browser.IE_VERSION!==11&&t.eme.initializeMediaKeys&&t.eme.initializeMediaKeys())}},qc=function(){if(!window.localStorage)return null;var r=window.localStorage.getItem(Hc);if(!r)return null;try{return JSON.parse(r)}catch{return null}},Og=function(r){if(!window.localStorage)return!1;var i=qc();i=i?k.mergeOptions(i,r):r;try{window.localStorage.setItem(Hc,JSON.stringify(i))}catch{return!1}return i};je.supportsNativeHls=function(){var a=N.createElement("video");if(!k.getTech("Html5").isSupported())return!1;var r=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return r.some(function(i){return/maybe|probably/i.test(a.canPlayType(i))})}(),je.supportsNativeDash=function(){return k.getTech("Html5").isSupported()?/maybe|probably/i.test(N.createElement("video").canPlayType("application/dash+xml")):!1}(),je.supportsTypeNatively=function(a){return a==="hls"?je.supportsNativeHls:a==="dash"?je.supportsNativeDash:!1},je.isSupported=function(){return k.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Lg=k.getComponent("Component"),zc=function(a){xt(r,a);function r(i,e,t){Ze(this,r);var n=lt(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t.hls));if(e.options_&&e.options_.playerId){var s=k(e.options_.playerId);s.hasOwnProperty("hls")||Object.defineProperty(s,"hls",{get:function(){return k.log.warn("player.hls is deprecated. Use player.tech().hls instead."),e.trigger({type:"usage",name:"hls-player-access"}),n},configurable:!0}),s.vhs=n,s.dash=n,n.player_=s}if(n.tech_=e,n.source_=i,n.stats={},n.ignoreNextSeekingEvent_=!1,n.setOptions_(),n.options_.overrideNative&&e.overrideNativeAudioTracks&&e.overrideNativeVideoTracks)e.overrideNativeAudioTracks(!0),e.overrideNativeVideoTracks(!0);else if(n.options_.overrideNative&&(e.featuresNativeVideoTracks||e.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return n.on(N,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(o){var u=N.fullscreenElement||N.webkitFullscreenElement||N.mozFullScreenElement||N.msFullscreenElement;u&&u.contains(n.tech_.el())&&n.masterPlaylistController_.smoothQualityChange_()}),n.on(n.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),n.on(n.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),n.on(n.tech_,"play",n.play),n}return it(r,[{key:"setOptions_",value:function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,typeof this.options_.blacklistDuration!="number"&&(this.options_.blacklistDuration=5*60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){var t=qc();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=qe.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===qe.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach(function(n){typeof e.source_[n]<"u"&&(e.options_[n]=e.source_[n])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}},{key:"src",value:function(e,t){var n=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=je,this.options_.sourceType=Wc(t),this.options_.seekTo=function(s){n.tech_.setCurrentTime(s)},this.masterPlaylistController_=new bg(this.options_),this.playbackWatcher_=new Cg(k.mergeOptions(this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",function(){var s=k.players[n.tech_.options_.playerId];s.error(n.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):je.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=je.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(o){this.masterPlaylistController_.selectPlaylist=o.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(o){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=o,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(o){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=o,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var o=1/(this.bandwidth||1),u=void 0;this.throughput>0?u=1/this.throughput:u=0;var l=Math.floor(1/(o+u));return l},set:function(){k.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return gc(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return gc(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){n.options_.useBandwidthFromLocalStorage&&Og({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){Eg(n),wg(n)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&this.tech_.src(k.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=k.players[this.tech_.options_.playerId];!t||!t.qualityLevels||this.qualityLevels_||(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){Ig(e.qualityLevels_,e)}),this.playlists.on("mediachange",function(){Gc(e.qualityLevels_,e.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,Lm(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return cv({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:2;return fv({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:s,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]),r}(Lg),Us={name:"videojs-http-streaming",VERSION:Pg,canHandleSource:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=k.mergeOptions(k.options,i);return Us.canPlayType(r.type,e)},handleSource:function(r,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=k.mergeOptions(k.options,e);return i.hls=new zc(r,i,t),i.hls.xhr=lc(),i.hls.src(r.src,r.type),i.hls},canPlayType:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=k.mergeOptions(k.options,i),t=e.hls.overrideNative,n=Wc(r),s=n&&(!je.supportsTypeNatively(n)||t);return s?"maybe":""}};return(typeof k.MediaSource>"u"||typeof k.URL>"u")&&(k.MediaSource=_i,k.URL=Pc),_i.supportsNativeMediaSources()&&k.getTech("Html5").registerSourceHandler(Us,0),k.HlsHandler=zc,k.HlsSourceHandler=Us,k.Hls=je,k.use||k.registerComponent("Hls",je),k.options.hls=k.options.hls||{},k.registerPlugin?k.registerPlugin("reloadSourceOnError",Vc):k.plugin("reloadSourceOnError",Vc),k});
//# sourceMappingURL=videojs.7.8.4.26a390cff45ca901d0bc2567843d762d.js.map
